import{r,cr as y,b as i,j as e,D as S}from"./vendor-C042fTmz.js";const c="https://www.rubertogo.com",P=()=>{const[o,n]=r.useState([]),[g,d]=r.useState(!1),[j,h]=r.useState(!1),[a,p]=r.useState(null),b=y("(max-width: 768px)");r.useEffect(()=>{v()},[]);const v=async()=>{d(!0);try{const s=await i.get(`${c}/api/partner`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});n(s.data||[])}catch(s){console.error("Error fetching partner requests:",s)}finally{d(!1)}},u=async s=>{try{await i.put(`${c}/api/partner/approve/${s}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),n(t=>t.map(l=>l._id===s?{...l,approvalStatus:"approved"}:l)),alert("Partner approved successfully!")}catch(t){console.error("Error approving partner:",t),alert("Failed to approve partner.")}},m=async s=>{try{await i.put(`${c}/api/partner/reject/${s}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),n(t=>t.map(l=>l._id===s?{...l,approvalStatus:"rejected"}:l)),alert("Partner rejected successfully!")}catch(t){console.error("Error rejecting partner:",t),alert("Failed to reject partner.")}},x=s=>{p(s),h(!0)},N=()=>{p(null),h(!1)},w=[{field:"name",headerName:"Name",width:200},{field:"email",headerName:"Email",width:200},{field:"phone",headerName:"Phone",width:150},{field:"vat",headerName:"Registration #",width:150},{field:"approvalStatus",headerName:"Status",width:150,renderCell:s=>e.jsx("span",{className:`px-3 py-1 rounded-full ${s.value==="approved"?"bg-green-100 text-green-800":s.value==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.value})},{field:"actions",headerName:"Actions",width:250,renderCell:s=>e.jsxs("div",{className:"space-x-2",children:[s.row.approvalStatus!=="approved"&&s.row.approvalStatus!=="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(s.row.id),className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:"Approve"}),e.jsx("button",{onClick:()=>m(s.row.id),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",children:"Reject"})]}),e.jsx("button",{onClick:()=>x(s.row),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"View"})]})}],f=o.map(s=>({id:s._id,name:s?.user?`${s.user.firstName||"N/A"} ${s.user.lastName||"N/A"}`:"N/A",email:s?.user?.email||"N/A",phone:s?.user?.phone||"N/A",vat:s.vat||"N/A",approvalStatus:s.approvalStatus||"pending"}));return e.jsxs("div",{className:"p-6 bg-gray-100 min-h-screen max-w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Partner Requests"}),g?e.jsx("p",{className:"text-center",children:"Loading..."}):o.length===0?e.jsx("p",{className:"text-center",children:"No partner requests found."}):b?e.jsx("div",{className:"grid gap-4",children:o.map(s=>e.jsxs("div",{className:"bg-white shadow p-4 rounded-lg",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Name:"})," ",`${s.user.firstName} ${s.user.lastName}`]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",s.user.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Phone:"})," ",s.user.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Registration #:"})," ",s.vat]}),e.jsxs("p",{className:"text-green-500",children:[e.jsx("span",{className:"font-semibold",children:"Status #:"})," ",s?.approvalStatus]}),e.jsxs("div",{className:"mt-4 space-x-2",children:[s.approvalStatus!=="approved"&&s.approvalStatus!=="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(s._id),className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:"Approve"}),e.jsx("button",{onClick:()=>m(s._id),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",children:"Reject"})]}),e.jsx("button",{onClick:()=>x(s),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"View"})]})]},s._id))}):e.jsx("div",{className:"w-full h-[500px]",children:e.jsx(S,{rows:f,columns:w,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0})}),j&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-4xl w-full p-6 relative",children:[e.jsx("button",{onClick:N,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",children:"âœ–"}),e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Partner Details - ",a.companyName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Owner Name:"})," ",a?.user?`${a.user.firstName||"N/A"} ${a.user.lastName||"N/A"}`:"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",a?.user?.email||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Phone:"})," ",a?.user?.phone||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Registration #:"})," ",a?.vat||"N/A"]}),e.jsxs("p",{className:"text-green-500",children:[e.jsx("span",{className:"font-semibold",children:"Status #:"})," ",a?.approvalStatus||"N/A"]}),e.jsx("button",{onClick:N,className:"bg-blue-500 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-600 mt-4",children:"Close"})]})})]})};export{P as default};
