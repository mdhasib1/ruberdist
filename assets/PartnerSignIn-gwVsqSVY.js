import{u as B,b as R,r as a,a as M,j as e,d as g,B as b}from"./index-B_XR-bXS.js";import{O as V}from"./index-DpxsO8Tb.js";import{T as x}from"./Typography-CuI5uYqX.js";import{T as y}from"./TextField-8lldrJnn.js";import{I as W}from"./InputAdornment-BL0rk6jw.js";import{B as j}from"./Button-gI_ekC-0.js";import{G as v}from"./Grid-EGPPBo8K.js";import{S as $}from"./Snackbar-CZUjwDXl.js";import{A as F}from"./Alert-Cfa11-q5.js";import"./iconBase-BOVTrjLU.js";import"./index-xHaaV7qh.js";import"./createSimplePaletteValueFilter-BqFbd0Em.js";import"./useTheme-CokdzniT.js";import"./useSlot-CiWiNTR6.js";import"./CircularProgress-CnUP9nIX.js";import"./Select-CzenUNWX.js";import"./Menu-B2ZH_G3y.js";import"./Portal-DeAW2irb.js";import"./Grow-Diug3Yir.js";import"./useTheme-B7QzK74H.js";import"./List-DlYRtUZN.js";import"./Paper-Dn5NJgTn.js";import"./Modal-Cde_47yd.js";import"./useControlled-C95e4nO2.js";import"./createSvgIcon-c53c8Spr.js";import"./isMuiElement-BsuoJcZr.js";import"./ClickAwayListener-CAfaVHQX.js";import"./Close-DVHmFJ28.js";import"./IconButton-CRfIEONe.js";const S="https://rubertogo.com",bt=()=>{const{lang:O}=B(),{login:P}=R(),[p,w]=a.useState(""),[n,u]=a.useState(["","","",""]),[d,T]=a.useState(1),[N,i]=a.useState(""),[C,h]=a.useState(!1),[l,c]=a.useState(!1),E=M(),m=a.useRef([]),A=s=>{w(s.target.value)},I=(s,t)=>{const{value:r}=s.target;if(r.length===1){const o=[...n];o[t]=r,u(o),t<n.length-1&&m.current[t+1].focus()}else if(r===""){const o=[...n];o[t]="",u(o),t>0&&m.current[t-1].focus()}},D=s=>{const t=s.clipboardData.getData("Text").slice(0,4);if(t.length===4){const r=t.split("");u(r),m.current[3].focus()}},L=async s=>{s.preventDefault(),i(""),c(!0);try{const t=await g.post(`${S}/api/login`,{email:p});console.log(t),b.success("OTP sent to your email."),T(2)}catch(t){console.log(t),i("User not found with the given email."),h(!0)}finally{c(!1)}},k=async s=>{s.preventDefault();const t=n.join("");i(""),c(!0);try{const r=await g.post(`${S}/api/verify-otp`,{email:p,otp:t}),{accessToken:o}=r.data;P(o),b.success("Login successful!"),E(`/${O}/partner/dashboard`)}catch{i("Invalid or expired OTP."),h(!0)}finally{c(!1)}},f=()=>{h(!1)};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),e.jsx(x,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:d===1?"Partner Sign In":"Verify OTP"}),d===1&&e.jsxs("form",{onSubmit:L,children:[e.jsx("div",{className:"mb-4",children:e.jsx(y,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:p,onChange:A,InputProps:{startAdornment:e.jsx(W,{position:"start",children:e.jsx(V,{className:"text-gray-400"})})}})}),e.jsx(j,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Sending OTP...":"Send OTP"})]}),d===2&&e.jsxs("form",{onSubmit:k,children:[e.jsx(x,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),e.jsx(v,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",children:n.map((s,t)=>e.jsx(v,{item:!0,children:e.jsx(y,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:s,onChange:r=>I(r,t),onPaste:t===0?D:void 0,inputRef:r=>m.current[t]=r,required:!0})},t))}),e.jsx(j,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Verifying...":"Verify OTP"})]}),e.jsx($,{open:C,autoHideDuration:6e3,onClose:f,children:e.jsx(F,{onClose:f,severity:"error",children:N})})]})})};export{bt as default};
