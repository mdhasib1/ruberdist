import{r as e,j as t,bf as a,f as n,I as o,bv as s,g as i,aA as r,a2 as l,a4 as d,m as c,ba as m,D as x,cJ as u,cK as g,cL as h,cq as p,cs as f,bD as b,_ as v,b as j,c3 as y,a$ as k,a as w,cM as N,cN as S,al as C,t as B,cO as T,as as D,cP as z,cQ as I,cH as A,cj as $,bZ as Y,aQ as P,cR as M,aR as L,b9 as R,bb as H,cS as F,bd as O,be as E,bc as W,cT as U,ci as _,cU as V,cV as Z,cW as K,b$ as q,c1 as G,c2 as J,aV as X,u as Q,c as ee,ab as te,cX as ae,cY as ne,cZ as oe,c_ as se,c$ as ie,aj as re,bw as le}from"./vendor-Zgq9WbFI.js";import{u as de}from"./useDeviceType-HFtv1OAZ.js";import{a as ce,u as me}from"./index-D29cp_SG.js";import{O as xe}from"./OTPModal-B3tYgRCI.js";const ue=({isOpen:c,onClose:m,booking:x,onSubmit:u})=>{var g,h;const[p,f]=e.useState(0),[b,v]=e.useState("");return t.jsx(a,{open:c,onClose:m,children:t.jsxs(n,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:400},bgcolor:"background.paper",borderRadius:"16px",boxShadow:24,p:4,textAlign:"center",overflow:"hidden"},children:[t.jsx(o,{onClick:m,sx:{position:"absolute",top:"8px",right:"8px",color:"#ff4e50",zIndex:10,"&:hover":{color:"#f9d423"}},children:t.jsx(s,{})}),t.jsx(n,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"50px",background:"linear-gradient(to right, #ff4e50, #f9d423)",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"}}),t.jsx(i,{variant:"h5",sx:{fontWeight:"bold",color:"#333",mt:6,mb:1},children:"Com'Ã© stata la tua esperienza?"}),t.jsxs(i,{variant:"body1",sx:{color:"text.secondary",mb:2},children:["Modello: ",t.jsx("b",{children:(null==(h=null==(g=null==x?void 0:x.vanId)?void 0:g.name)?void 0:h.en)||"Van"})]}),t.jsx(r,{name:"rating",value:p,onChange:(e,t)=>f(t),size:"large",sx:{mb:4,"& .MuiRating-iconFilled":{color:"#ff4e50"}}}),t.jsx(l,{label:"Scrivi qui la tua recensione...",value:b,onChange:e=>v(e.target.value),fullWidth:!0,multiline:!0,rows:3,variant:"outlined",sx:{mb:3,"& .MuiOutlinedInput-root":{borderRadius:"12px"}}}),t.jsx(d,{variant:"contained",onClick:()=>{p<1||p>5?alert("Please provide a rating between 1 and 5."):(u({bookingId:x._id,vanId:x.vanId._id,rating:p,comment:b}),f(0),v(""),m())},sx:{width:"100%",py:1.5,fontSize:"1rem",fontWeight:"bold",color:"#fff",background:"linear-gradient(to right, #ff4e50, #f9d423)",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)",borderRadius:"8px","&:hover":{background:"linear-gradient(to right, #f9d423, #ff4e50)"}},children:"Invia recensione"})]})})},ge=({initialUserData:a})=>{const[s,r]=e.useState({firstName:"",lastName:"",email:"",phone:"",address:"",preferredLanguage:"",idDocumentFront:"",idDocumentBack:"",licenseFront:"",licenseBack:""}),[p,f]=e.useState(!1);e.useEffect((()=>{a&&r({firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",phone:a.phone||"",address:a.address||"",preferredLanguage:a.preferredLanguage||"",idDocumentFront:a.idDocumentFront||"",idDocumentBack:a.idDocumentBack||"",licenseFront:a.licenseFront||"",licenseBack:a.licenseBack||""})}),[a]);const b=e=>{const{name:t,value:a}=e.target;r((e=>({...e,[t]:a})))},v=()=>{f(!p)};return t.jsx(n,{component:c.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"sm:max-w-full max-w-lg mx-auto sm:py-0 py-5",children:t.jsxs(m,{elevation:4,className:"p-8 rounded-xl shadow-md bg-white",children:[t.jsx(i,{variant:"h4",className:"text-[#ff0707] font-bold mb-4",children:"Account Settings"}),t.jsx(i,{variant:"body1",className:"text-gray-600 mb-6",children:"Update your account information here."}),t.jsx(x,{className:"mb-6"}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),console.log("Updated user data:",s),f(!1)},className:"space-y-6",children:[t.jsx(l,{label:"First Name",name:"firstName",value:s.firstName,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(l,{label:"Last Name",name:"lastName",value:s.lastName,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(l,{label:"Email",name:"email",type:"email",value:s.email,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(l,{label:"Phone Number",name:"phone",value:s.phone,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(l,{label:"Address",name:"address",value:s.address,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(l,{label:"Preferred Language",name:"preferredLanguage",value:s.preferredLanguage,onChange:b,fullWidth:!0,disabled:!p,variant:"outlined",color:"secondary",className:"mb-4",InputProps:{style:{backgroundColor:p?"#f9f9f9":"transparent"}}}),t.jsx(x,{className:"mb-6"}),p?t.jsxs(n,{className:"flex justify-end gap-4",children:[t.jsx(d,{variant:"contained",color:"success",type:"submit",startIcon:t.jsx(u,{}),children:"Save Changes"}),t.jsx(d,{variant:"outlined",color:"error",startIcon:t.jsx(g,{}),onClick:v,children:"Cancel"})]}):t.jsx(n,{className:"flex justify-end",children:t.jsx(o,{onClick:v,color:"primary",children:t.jsx(h,{})})})]})]})})},he=(()=>{const e=[];for(let t=0;t<=23;t++)e.push(`${t<10?"0":""}${t}:00`);return e})(),pe=({van:a,isOpen:n,onClose:o,booking:s})=>{const[i,r]=e.useState([]),[l,m]=e.useState([]),[x,u]=e.useState(0),g=e.useMemo((()=>((e,t)=>{const a=[],n=new Date(e);for(let o=0;o<t;o++){const e=new Date(n);a.push({date:v(e).format("YYYY-MM-DD"),displayDate:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"}),slots:he}),n.setDate(n.getDate()+1)}return a})(new Date,7)),[]);e.useEffect((()=>{n&&s&&(async()=>{try{const e=await j.get(`https://rubertogo.com/api/${s._id}`);console.log(e);const t=e.data.selectedSlots||[];m(t),r(t)}catch(e){console.error(e)}})()}),[n,s]),e.useEffect((()=>{n||(r(l),u(0))}),[n,l]);const h=e=>{if(!i.some((t=>t.date===e.date&&t.time===e.time))){const t=(e=>{const t=e.sort(((e,t)=>e.date===t.date?e.time.localeCompare(t.time):e.date.localeCompare(t.date))),a=[];let n=null;return t.forEach(((e,t)=>{if(n){const t=v(`${e.date} ${e.time}`).diff(v(`${n.date} ${n.time}`),"hour");if(t>1)for(let e=1;e<t;e++){const t=v(n.time).add(e,"hour").format("HH:mm");a.push({...n,time:t})}}a.push(e),n=e})),a})([...i,e]);r(t)}},y=()=>i.length*a.pricePerHour;return n?p.createPortal(t.jsx(c.div,{className:"relative",children:t.jsx(c.div,{className:"fixed inset-0 bg-gray-800 bg-opacity-70 flex items-center justify-center z-50 px-2 sm:px-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t.jsxs(c.div,{className:"bg-white p-8 rounded-2xl shadow-2xl w-full container h-[90vh] overflow-y-auto relative",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.5},children:[t.jsx("button",{onClick:o,className:"absolute z-40 top-4 right-4 text-red-500 text-2xl rounded-full shadow-md hover:bg-gray-100 p-2",children:t.jsx(f,{})}),t.jsx("h2",{className:"text-2xl font-bold text-center text-green-700 mb-6",children:"Extend Booking Time"}),t.jsx("p",{className:"text-center mb-4",children:"Select additional slots to extend your booking time."}),t.jsx("div",{className:"grid grid-cols-1 gap-4",children:g.slice(x,x+7).map(((e,a)=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 bg-gray-200 p-2 rounded-md",children:e.displayDate}),t.jsx("div",{className:"grid sm:grid-cols-4 grid-cols-2 gap-2 mt-2",children:he.map(((a,n)=>{const o=i.some((t=>t.date===e.date&&t.time===a)),s=l.some((t=>t.date===e.date&&t.time===a));return t.jsxs(c.button,{onClick:()=>h({date:e.date,time:a}),className:"p-2 rounded-lg text-center transition-all "+(o?"bg-green-500 text-white":s?"bg-gray-400 text-white":"bg-gray-300 text-gray-700"),children:[a,o&&t.jsx(b,{className:"text-white"}),s&&t.jsx(f,{className:"text-white"})]},n)}))})]},a)))}),t.jsxs("div",{className:"mt-6 flex justify-between",children:[t.jsx(d,{variant:"contained",color:"secondary",onClick:o,children:"Cancel"}),t.jsxs(d,{variant:"contained",color:"primary",onClick:()=>alert(`Total Price: $${y()}`),children:["Proceed - $",y()]})]})]})})}),document.body):null},fe=({isBookingActive:n,bookingId:r,onClose:c,currentContractImages:m,vanId:x})=>{const[u,g]=e.useState(!1),[h,p]=e.useState([]),[f,b]=e.useState(!1),{translations:v}=ce(),w="https://rubertogo.com",N=localStorage.getItem("accessToken"),S=(e,t,a)=>{const n=[...h];n[e][t]=a,p(n)};return t.jsx(a,{open:n,onClose:c,children:t.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50 px-4 sm:px-0",children:t.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-xl shadow-2xl sm:p-8 p-6 relative min-h-[70vh] max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-center mb-8",children:[t.jsx(i,{variant:"h5",className:"text-2xl font-bold text-green-900 tracking-wide border-b-2 border-gray-200 pb-2",children:"Danni presenti: ne vedi altri?"}),t.jsx(o,{onClick:c,className:"absolute top-0 right-4 bg-gray-200 hover:bg-gray-300 rounded-full",children:t.jsx(s,{size:20})})]}),u?t.jsxs("div",{children:[t.jsx("div",{className:"overflow-y-auto max-h-72 space-y-4",children:h.map(((e,a)=>t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center bg-gray-100 p-4 rounded-lg shadow-md",children:[t.jsx(l,{label:"Posizione danno",variant:"outlined",value:e.damageType,onChange:e=>S(a,"damageType",e.target.value),className:"w-full"}),t.jsx(l,{label:"Descrizione del danno",variant:"outlined",value:e.description,onChange:e=>S(a,"description",e.target.value),className:"w-full"}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs(d,{variant:"outlined",className:"text-blue-500 border-blue-500 hover:bg-blue-100 hover:border-blue-700",component:"label",children:["Carica immagine",t.jsx("input",{type:"file",hidden:!0,onChange:e=>{e.target.files[0]&&(async(e,t)=>{try{const a=new FormData;a.append("file",e),b(!0);const n=(await j.post(`${w}/api/upload`,a,{headers:{"Content-Type":"multipart/form-data"}})).data.imageURL;S(t,"imageUrl",n)}catch(a){console.error("Error uploading image:",a)}finally{b(!1)}})(e.target.files[0],a)}})]}),e.imageUrl&&t.jsx("img",{src:e.imageUrl,alt:"Damage",className:"w-16 h-16 object-cover rounded-md mt-2 shadow-md"})]}),t.jsx(o,{onClick:()=>(e=>{p(h.filter(((t,a)=>a!==e)))})(a),className:"text-red-500 hover:bg-red-100",children:t.jsx(y,{size:20})})]},a)))}),t.jsxs("div",{className:"flex justify-between mt-8",children:[t.jsx(d,{variant:"outlined",className:"border-gray-500 text-gray-600 hover:bg-gray-100 px-6 py-2 rounded-lg font-medium transition-all duration-300",onClick:()=>g(!1),children:"Indietro"}),t.jsx(d,{variant:"contained",className:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-2 rounded-lg shadow-lg hover:shadow-xl font-medium transition-all duration-300",onClick:()=>{p([...h,{damageType:"",description:"",imageUrl:""}])},children:"Aggiungi danno"}),t.jsx(d,{variant:"contained",className:"bg-gradient-to-r from-green-500 to-green-700 text-white px-6 py-2 rounded-lg shadow-lg hover:shadow-xl font-medium transition-all duration-300",onClick:async()=>{try{const e=h.map((e=>({damageType:e.damageType,description:e.description,image:e.imageUrl})));await j.post(`${w}/api/vans/${x}/contracts`,e,{headers:{Authorization:`Bearer ${N}`}});p([]),g(!1),window.location.reload()}catch(e){console.error("Error saving damages:",e)}},disabled:f,children:f?t.jsx(k,{size:20,color:"inherit"}):"Salva"})]})]}):t.jsxs(t.Fragment,{children:[m&&m.length>0&&t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex gap-4 flex-wrap",children:m.map(((e,a)=>t.jsx("div",{className:"w-24 h-24 overflow-hidden rounded-lg shadow-md transform hover:scale-105 transition-transform duration-300",children:t.jsx("img",{src:e.image,alt:`Damage ${a+1}`,className:"w-full h-full object-cover"})},a)))})}),t.jsxs("div",{className:"flex justify-between mt-8",children:[t.jsx(d,{variant:"outlined",className:"border-green-500 text-green-600 hover:bg-green-100 font-medium px-6 py-2 rounded-lg transition-all duration-300",onClick:async()=>{try{await j.post(`${w}/api/booking/${r}/accept-all-damage-images`,{},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`}}),c(),window.location.reload()}catch(e){console.error("Error saving acknowledgment:",e)}},children:"Confermo i danni presenti"}),t.jsx(d,{variant:"contained",className:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-2 rounded-lg shadow-lg hover:shadow-xl font-medium transition-all duration-300",onClick:()=>g(!0),children:"Aggiungi danno"})]})]})]})})})};v.extend(M);const be=S(n)((({theme:e})=>({padding:"3rem",background:"linear-gradient(135deg, #ffffff, #f9fafc)",borderRadius:"1rem",boxShadow:"0px 10px 15px rgba(0, 0, 0, 0.1)",[e.breakpoints.down("sm")]:{padding:"1rem"}}))),ve=S(n)((({theme:e})=>({display:"flex",alignItems:"center",padding:"0.4rem 0",borderBottom:"1px solid #e5e7eb",":last-child":{borderBottom:"none"}}))),je=S(n)((({theme:e})=>({color:"#ff4b2b",fontSize:"1.5rem",marginRight:"0.75rem"}))),ye=S(i)((({theme:e})=>({fontWeight:500,color:"#333"}))),ke=S("span")((({theme:e})=>({color:"#555",fontWeight:400,marginLeft:"0.5rem"}))),we=S(P)((({theme:e})=>({borderRadius:"1.5rem",boxShadow:"0 10px 30px rgba(0,0,0,0.1)",overflow:"hidden",maxWidth:"100%",margin:"auto",[e.breakpoints.down("sm")]:{margin:"0.5rem",borderRadius:"1rem"}}))),Ne=S(n)((({theme:e})=>({display:"flex",alignItems:"center",background:"linear-gradient(90deg, #ff4b2b, #ff416c)"}))),Se=S(n)((({theme:e})=>({padding:"0.5rem",backgroundColor:"#f9fafb",textAlign:"center"})));S(n)((({theme:e})=>({padding:"1rem",display:"flex",justifyContent:"center",[e.breakpoints.down("sm")]:{padding:"0.75rem"}})));const Ce=({bookingData:a})=>{var o,s,r,l,m,x,u,g,h,p,f,b,v,j,y,k,S,P;const[M,L]=e.useState(null),[R,H]=e.useState(null),[F,O]=e.useState(!1),[E,W]=e.useState(!1),[U,_]=e.useState(!1),{translations:V}=ce(),{lang:Z}=w(),[K,q]=e.useState(null),[G,J]=e.useState(0),[X,Q]=e.useState(!1);e.useEffect((()=>{if(a){const e=setInterval((()=>{var e,t,n,o,s,i;const r=N(),l=null==(e=null==a?void 0:a.currentBooking)?void 0:e.timeZone,d=N.tz(null==(t=null==a?void 0:a.currentBooking)?void 0:t.startTime,"YYYY-MM-DDTHH:mm:ss",l),c=N.tz(null==(n=null==a?void 0:a.currentBooking)?void 0:n.endTime,"YYYY-MM-DDTHH:mm:ss",l),m=d.diff(r,"milliseconds"),x=c.diff(r,"milliseconds");if(L(m),H(x),m<=0&&x>0?(W(!0),!1===(null==(o=null==a?void 0:a.currentBooking)?void 0:o.damageImagesAccepted)&&Q(!0)):W(!1),null==(s=null==a?void 0:a.upcomingBooking)?void 0:s.startTime){const e=N.tz(null==(i=null==a?void 0:a.upcomingBooking)?void 0:i.startTime,"YYYY-MM-DDTHH:mm:ss",l);J(e.diff(r,"milliseconds"))}}),1e3);return()=>clearInterval(e)}}),[a]);const ee=e=>{const t=Math.floor(e/1e3);if(t<=0)return"Time's up";const a=Math.floor(t/3600),n=Math.floor(t%3600/60),o=t%60;return`${String(a).padStart(2,"0")}h ${String(n).padStart(2,"0")}m ${String(o).padStart(2,"0")}s`},te=(e,t)=>{"clickaway"!==t&&O(!1)},ae=Array.isArray(null==a?void 0:a.upcomingBooking)?a.upcomingBooking.map((e=>({id:e._id,vanName:e.vanId.name.en,plateNumber:e.vanId.plateNumber,startTime:e.startTime,amount:`${e.totalPrice} CHF`,status:e.status}))):[],ne=[{field:"vanName",headerName:"Van Name",width:200},{field:"plateNumber",headerName:"Plate Number",width:150},{field:"startTime",headerName:"Booking Start Time",width:200,renderCell:e=>N(e.value).utc().format("DD-MM-YYYY HH:mm")},{field:"status",headerName:"Booking Status",width:150,renderCell:e=>t.jsx("span",{className:"font-semibold "+("accepted"===e.value?"text-green-500":"pending"===e.value?"text-yellow-500":"text-red-500"),children:e.value})},{field:"amount",headerName:"Amount",width:150,align:"right"}];return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-center items-center w-full ",children:[t.jsx(c.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full",children:t.jsxs(we,{children:[t.jsxs(Ne,{children:[t.jsx(C,{size:40,className:"text-white mr-4 ml-5 p-2"}),t.jsx(i,{variant:"h5",className:"font-bold text-white p-2",children:V.myAccount.currentbooking})]}),t.jsx(Se,{children:a?t.jsx(t.Fragment,{children:E?t.jsxs(t.Fragment,{children:[t.jsx(i,{variant:"h4",className:"font-bold text-gray-800 mb-2",children:V.booking.timeRemaining}),t.jsx(i,{variant:"h2",className:"font-extrabold text-red-600",children:ee(R)}),t.jsx(i,{variant:"body2",className:"text-gray-500",children:V.booking.enjoyBooking})]}):M>0?t.jsxs("div",{className:"p-4",children:[t.jsx(i,{variant:"h4",className:"font-bold text-gray-800 mb-2",children:"Starts In"}),t.jsx(i,{variant:"h3",className:"font-extrabold text-red-600",children:ee(M)}),t.jsx(i,{variant:"body2",className:"text-gray-500",children:V.booking.getReady})]}):t.jsxs(n,{className:"text-center p-6 ",children:[t.jsx(i,{variant:"h4",className:"font-bold text-gray-800 mb-2",children:V.booking.noActiveBooking}),t.jsx(i,{variant:"body2",className:"text-gray-500 mb-4",children:V.booking.noActiveBookingDescription}),t.jsx(B,{to:`/${Z}/vans`,className:"text-white rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition-shadow",children:t.jsx(d,{variant:"contained",color:"primary",children:V.booking.exploreVans})})]})}):t.jsxs(n,{className:"text-center",children:[t.jsx(i,{variant:"h4",className:"font-bold text-gray-800 mb-2",children:V.booking.noBookingData}),t.jsx(i,{variant:"body2",className:"text-gray-500 mb-4",children:V.booking.noBookingDataDescription}),t.jsx(B,{to:`/${Z}/vans`,className:"text-white rounded-lg text-lg font-semibold shadow-md hover:shadow-lg transition-shadow",children:t.jsx(d,{variant:"contained",color:"primary",children:V.booking.exploreVans})})]})}),K&&(null==K?void 0:K.startTime)&&t.jsx(be,{children:t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(T,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.upcomingBookingStartTime,":"," ",t.jsx(ke,{children:K.startTime})]})]})}),a&&(null==a?void 0:a.currentBooking)&&t.jsxs(be,{children:[t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(C,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.vanName,":"," ",t.jsx(ke,{children:null==(s=null==(o=null==a?void 0:a.currentBooking)?void 0:o.vanId)?void 0:s.name.en})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(D,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.pickupLocation,":"," ",t.jsx(ke,{children:null==(m=null==(l=null==(r=null==a?void 0:a.currentBooking)?void 0:r.vanId)?void 0:l.location)?void 0:m.address})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(D,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.dropLocation,":"," ",t.jsx(ke,{children:null==(g=null==(u=null==(x=null==a?void 0:a.currentBooking)?void 0:x.vanId)?void 0:u.location)?void 0:g.address})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(T,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.startDateTime,":",t.jsx(ke,{children:N(null==(h=null==a?void 0:a.currentBooking)?void 0:h.startTime).utc().format("DD-MM-YYYY HH:mm")})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(T,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.endDateTime,":",t.jsx(ke,{children:N(null==(p=null==a?void 0:a.currentBooking)?void 0:p.endTime).utc().format("DD-MM-YYYY HH:mm")})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(z,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.totalPrice,":",t.jsxs(ke,{children:[null==(f=null==a?void 0:a.currentBooking)?void 0:f.totalPrice," CHF"]})]})]}),t.jsxs(ve,{children:[t.jsx(je,{children:t.jsx(I,{})}),t.jsxs(ye,{variant:"body1",children:[V.booking.status,":"," ",t.jsx(ke,{children:null==(b=null==a?void 0:a.currentBooking)?void 0:b.status})]})]})]})]})}),t.jsx(A,{open:F,autoHideDuration:6e3,onClose:te,children:t.jsx($,{onClose:te,severity:"success",sx:{width:"100%"},children:V.booking.bookingExtendedSuccess})})]}),t.jsxs("div",{className:"w-full border-2 p-5 rounded-md border-red-200 mt-5 ",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:V.booking.upcomingBookings}),t.jsx("div",{className:"block md:hidden",children:ae.map((e=>t.jsxs("div",{className:"mb-4 p-4 bg-white shadow-md rounded-lg border border-red-200",children:[t.jsxs("h3",{className:"text-lg font-bold text-gray-700 mb-2",children:[V.booking.van,": ",e.vanName]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[t.jsxs("span",{className:"font-bold",children:[V.booking.plateNumber,":"]})," ",e.plateNumber]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[t.jsxs("span",{className:"font-bold",children:[V.booking.bookingStartTime,":"]})," ",N(e.startTime).utc().format("DD-MM-YYYY HH:mm")]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[t.jsxs("span",{className:"font-bold",children:[V.booking.bookingStartTime,":"]})," ",e.amount," CHF"]}),t.jsxs("p",{className:"text-sm font-bold "+("accepted"===e.status?"text-green-500":"pending"===e.status?"text-yellow-500":"text-red-500"),children:["Status: ",e.status]})]},e.id)))}),t.jsx("div",{className:"hidden md:block",children:t.jsx("div",{className:"h-[calc(80vh-200px)]  w-full bg-white shadow-md rounded-lg border border-gray-200",children:t.jsx(Y,{rows:ae,columns:ne,pageSize:5,rowsPerPageOptions:[5],checkboxSelection:!0,disableSelectionOnClick:!0,sx:{height:"100%",width:"100%",padding:"1rem"}})})})]}),t.jsx(pe,{booking:null==a?void 0:a.currentBooking,van:null==(v=null==a?void 0:a.currentBooking)?void 0:v.vanId,isOpen:U,onClose:()=>{_(!1)}}),t.jsx(fe,{isBookingActive:X,bookingId:null==(j=null==a?void 0:a.currentBooking)?void 0:j._id,onClose:()=>{Q(!1)},currentContractImages:null==(k=null==(y=null==a?void 0:a.currentBooking)?void 0:y.vanId)?void 0:k.contractImages,vanId:null==(P=null==(S=null==a?void 0:a.currentBooking)?void 0:S.vanId)?void 0:P._id})]})},Be=({bookingHistory:e})=>{const a=de();return e&&0!==e.length?t.jsxs("div",{className:"p-6 bg-gradient-to-br from-red-600 to-red-600 rounded-lg shadow-lg",children:[t.jsx(i,{variant:"h4",className:"text-2xl font-bold text-white mb-4",children:"Booking History"}),t.jsx(i,{variant:"body2",style:{marginBottom:"1rem"},className:"text-white mb-4",children:"Your previous bookings will be displayed here."}),["mobile","tablet","small-desktop"].includes(a.deviceType)?t.jsx("div",{className:"space-y-4",children:e.map((e=>{var a,n;return t.jsx(P,{className:"bg-white text-gray-800 shadow-md rounded-lg overflow-hidden",variant:"outlined",children:t.jsxs(L,{children:[t.jsxs(i,{variant:"h6",className:"font-semibold text-red-500 mb-2",children:["Van Name: ",(null==(n=null==(a=e.vanId)?void 0:a.name)?void 0:n.en)||"N/A"]}),t.jsxs(i,{variant:"body2",className:"text-gray-700",children:[t.jsx("strong",{children:"Booking Date:"})," ",e.startDate]}),t.jsxs(i,{variant:"body2",className:"text-gray-700",children:[t.jsx("strong",{children:"Return Date:"})," ",e.endDate]}),t.jsxs(i,{variant:"body2",className:"text-gray-700",children:[t.jsx("strong",{children:"Status:"})," ",e.status]}),t.jsxs(i,{variant:"body2",className:"text-gray-700",children:[t.jsx("strong",{children:"Amount:"})," $",e.totalPrice]})]})},e._id)}))}):t.jsx(R,{component:m,className:"mt-4 rounded-lg overflow-hidden",children:t.jsxs(H,{children:[t.jsx(F,{children:t.jsxs(O,{children:[t.jsx(E,{sx:{color:"#000",textAlign:"left"},className:" text-white font-semibold",children:"Van Name"}),t.jsx(E,{sx:{color:"#000",textAlign:"center"},className:" text-white font-semibold",children:"Booking Date"}),t.jsx(E,{sx:{color:"#000",textAlign:"center"},className:" text-white font-semibold",children:"Return Date"}),t.jsx(E,{sx:{color:"#000",textAlign:"center"},className:" text-white font-semibold",children:"Status"}),t.jsx(E,{sx:{color:"#000",textAlign:"center"},className:" text-white font-semibold",children:"Amount"})]})}),t.jsx(W,{children:e.map((e=>{var a,n;return t.jsxs(O,{className:"hover:bg-red-200 transition duration-300",children:[t.jsx(E,{sx:{color:"#000",textAlign:"left"},children:(null==(n=null==(a=e.vanId)?void 0:a.name)?void 0:n.en)||"N/A"}),t.jsx(E,{sx:{color:"#000",textAlign:"center"},children:e.startDate}),t.jsx(E,{children:e.endDate}),t.jsx(E,{sx:{color:"#fff",textAlign:"center"},className:"text-center text-white "+("completed"===e.status?"bg-green-500":"bg-red-500"),children:e.status}),t.jsxs(E,{sx:{color:"#000",textAlign:"center"},children:["$",e.totalPrice]})]},e._id)}))})]})})]}):t.jsxs("div",{className:"p-6 bg-gradient-to-br from-red-600 to-red-600 rounded-lg shadow-lg",children:[t.jsx(i,{variant:"h3",className:"text-2xl font-bold text-white mb-4",children:"Booking History"}),t.jsx(i,{variant:"body2",style:{marginBottom:"1rem"},className:"text-white mb-4",children:"No booking history available."})]})},Te=({bookings:e,onPay:a})=>{const o=U(),s=_(o.breakpoints.down("sm"));if(!e.length)return t.jsx(n,{textAlign:"center",mt:4,px:2,children:t.jsx(i,{variant:"h6",color:"textSecondary",children:"No pending bookings found."})});return t.jsx("div",{className:"overflow-y-auto "+(s?"h-[50vh]":"h-[60vh]"),children:t.jsxs(n,{py:2,px:s?1:3,children:[t.jsx(i,{variant:s?"h6":"h4",gutterBottom:!0,color:"warning",textAlign:"center",sx:{borderBottom:"2px solid #ff0707",display:"inline-block",padding:"0 1rem",marginBottom:"1rem",fontWeight:"bold",fontSize:s?"1.25rem":"1.5rem",color:"#ff0707"},children:"Pending Bookings"}),t.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,ease:"easeOut"},children:e.map((e=>{const o=new Date(e.startTime),r=new Date(e.endTime),l=`${String(o.getUTCDate()).padStart(2,"0")}-${String(o.getUTCMonth()+1).padStart(2,"0")}-${o.getUTCFullYear()}`,m=`${String(r.getUTCDate()).padStart(2,"0")}-${String(r.getUTCMonth()+1).padStart(2,"0")}-${r.getUTCFullYear()}`,x=o.toISOString().split("T")[1].split(".")[0],u=r.toISOString().split("T")[1].split(".")[0];return t.jsx(c.div,{whileHover:{scale:1.02},whileTap:{scale:.98},transition:{type:"spring",stiffness:300,damping:20},className:"mb-4",children:t.jsx(P,{elevation:s?2:3,sx:{background:"linear-gradient(145deg, #ffffff, #f0f0f0)",borderRadius:"16px",overflow:"hidden",boxShadow:s?"0px 2px 6px rgba(0, 0, 0, 0.15)":"0px 4px 12px rgba(0, 0, 0, 0.2)"},children:t.jsx(L,{children:t.jsxs(n,{display:"flex",flexDirection:s?"column":"row",justifyContent:"space-between",alignItems:s?"flex-start":"center",children:[t.jsxs(n,{children:[t.jsx(i,{variant:"h6",color:"textPrimary",sx:{fontWeight:"bold",fontSize:s?"1rem":"1.25rem"},children:`Van: ${e.vanId.name.en}`}),t.jsxs(i,{variant:"body2",color:"textSecondary",sx:{fontSize:s?"0.85rem":"1rem",marginBottom:s?"0.5rem":"0"},children:["Start:"," ",t.jsxs("span",{style:{color:"#ff0707"},children:[l," ",x]})]}),t.jsxs(i,{variant:"body2",color:"textSecondary",sx:{fontSize:s?"0.85rem":"1rem",marginBottom:s?"0.5rem":"0"},children:["End:"," ",t.jsxs("span",{style:{color:"#ff0707"},children:[m," ",u]})]})]}),t.jsx(d,{variant:"contained",size:s?"small":"large",onClick:()=>{return t=e._id,void(a&&a(t));var t},sx:{background:"linear-gradient(90deg, #ff0707, #e60000)",color:"white",fontWeight:"bold",boxShadow:"0px 4px 12px rgba(255, 7, 7, 0.5)","&:hover":{background:"linear-gradient(90deg, #e60000, #990000)",boxShadow:"0px 6px 16px rgba(230, 0, 0, 0.6)"},borderRadius:"8px",paddingX:s?2:3,marginTop:s?"1rem":"0",alignSelf:s?"center":"flex-start"},children:"Pay Now"})]})})})},e._id)}))})]})})},De="https://rubertogo.com";function ze({bookingData:a}){const[s,r]=e.useState(!0),[l,u]=e.useState(!1),[g,h]=e.useState(!1),[p,f]=e.useState(!1),[b,v]=e.useState(!1),[y,k]=e.useState(null),[w,S]=e.useState(!1),[C,B]=e.useState(""),[T,D]=e.useState(!1),z=localStorage.getItem("accessToken");e.useEffect((()=>{if(a&&a.currentBooking){const e=a.currentBooking.timeZone||"UTC",t=N().tz(e);if(a.currentBooking.startTime){const n=N.tz(a.currentBooking.startTime,"YYYY-MM-DDTHH:mm:ss",e).clone().subtract(20,"minutes");S(t.isSameOrAfter(n))}else S(!1)}else S(!1)}),[a]),e.useEffect((()=>{var e,t,n,o;null!==(null==(t=null==(e=null==a?void 0:a.currentBooking)?void 0:e.vanLock)?void 0:t.isLocked)&&r(null==(o=null==(n=null==a?void 0:a.currentBooking)?void 0:n.vanLock)?void 0:o.isLocked)}),[a]);const I=async()=>{var e,t,n,o,i,r,l;if(w){v(!0);try{const r=await j.post(`${De}/api/fleet2track/lock-unlock`,{vanId:null==(t=null==(e=null==a?void 0:a.currentBooking)?void 0:e.vanId)?void 0:t._id,plate:null==(o=null==(n=null==a?void 0:a.currentBooking)?void 0:n.vanId)?void 0:o.plateNumber,enableLock:!s,bookingId:null==(i=null==a?void 0:a.currentBooking)?void 0:i._id},{headers:{Authorization:`Bearer ${z}`}});"OTP sent to your email."===r.data.message?(f(!0),u(!0)):(k(r.data.isLocked),h(!0),D(!0),setTimeout((()=>D(!1)),3e4),setTimeout((()=>confirmLockUnlock(!1)),6e4))}catch(d){X.error((null==(l=null==(r=d.response)?void 0:r.data)?void 0:l.error)||"Failed to process lock/unlock request.")}finally{v(!1)}}else X.error("Booking has not started yet.")};e.useEffect((()=>{setTimeout((()=>{h(!1)}),1e5)}),[g]);const A=async e=>{h(!1),e?I():(r(y),X.success(`Furgone ${s?"sbloccato":"bloccato"} con successo.`))};return console.log("isLocked",s),t.jsxs(n,{component:c.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"max-w-md sm:max-w-full mx-auto",children:[t.jsxs(m,{elevation:4,className:"p-8 rounded-xl shadow-lg bg-white",children:[t.jsx(i,{variant:"h5",className:"text-[#ff0707] font-bold mb-4",children:"Blocco/Sblocco furgone"}),t.jsx(i,{variant:"body1",className:"text-gray-600 mb-6",style:{marginBottom:"1rem"},children:"Utilizza questa schermata per gestire il blocco e sblocca del furgone prenotato."}),t.jsx(x,{className:"mb-6"}),t.jsxs(n,{className:"flex flex-col sm:flex-row items-center sm:items-start sm:justify-between justify-center p-6 mb-4 rounded-2xl shadow-xl ",sx:{background:s?"rgba(255, 230, 230, 0.7)":"rgba(230, 255, 237, 0.7)",backdropFilter:"blur(10px)",border:"2px solid "+(s?"#ff7070":"#70ffb3"),borderRadius:"20px",boxShadow:"0 10px 20px "+(s?"rgba(255, 0, 0, 0.3)":"rgba(0, 191, 165, 0.3)"),transition:"background 0.3s ease, border 0.3s ease, box-shadow 0.3s ease",maxWidth:"900px",margin:"0 auto"},children:[t.jsxs(i,{variant:"h4",className:"text-center sm:text-left",sx:{fontWeight:"bold",fontSize:{xs:"1rem",sm:"1.5rem",md:"2rem"},background:s?"linear-gradient(90deg, #ff4d4d, #c70000)":"linear-gradient(90deg, #70ffb3, #009f8b)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:{xs:"1rem",sm:0},transition:"background 0.3s ease",marginTop:"1rem"},children:["Stato corrente: ",s?"Bloccato":"Sbloccato"]}),t.jsx(c.div,{initial:{scale:1},animate:{scale:1.1},whileHover:{scale:1.2,rotate:s?-5:5},transition:{type:"spring",stiffness:300,damping:10},style:{marginTop:"10px",display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(o,{"aria-label":s?"Van is Locked":"Van is Unlocked",size:"large",sx:{backgroundColor:s?"#ff7070":"#70ffb3",color:"#fff",boxShadow:"0 5px 15px "+(s?"rgba(255, 0, 0, 0.5)":"rgba(0, 191, 165, 0.5)"),transition:"transform 0.3s ease, background-color 0.3s ease","&:hover":{backgroundColor:s?"#c70000":"#009f8b",transform:"scale(1.15)"}},children:s?t.jsx(V,{fontSize:"inherit"}):t.jsx(Z,{fontSize:"inherit"})})})]}),b&&t.jsx(c.div,{initial:{rotate:0},animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},style:{width:"50px",height:"50px",margin:"auto",border:"4px solid #ccc",borderTop:"4px solid #ff0707",borderRadius:"50%"}}),t.jsx(d,{onClick:I,variant:"contained",color:s?"primary":"secondary",startIcon:s?t.jsx(K,{}):t.jsx(Z,{}),fullWidth:!0,disabled:!w||b,sx:{marginTop:"1rem",paddingY:1.5,backgroundColor:s?"#ff0707":"#00bfa5","&:hover":{backgroundColor:s?"#c70000":"#009f8b"}},children:s?"Sblocca furgone":"Blocca furgone"})]}),t.jsx(xe,{open:l,handleClose:()=>u(!1),onVerify:async e=>{var t,n,o,i,l,d,c;v(!0);try{const d=await j.post(`${De}/api/fleet2track/lock-unlock`,{vanId:null==(n=null==(t=null==a?void 0:a.currentBooking)?void 0:t.vanId)?void 0:n._id,plate:null==(i=null==(o=null==a?void 0:a.currentBooking)?void 0:o.vanId)?void 0:i.plateNumber,enableLock:!s,bookingId:null==(l=null==a?void 0:a.currentBooking)?void 0:l._id,otp:e},{headers:{Authorization:`Bearer ${z}`}});void 0!==d.data.isLocked?(r(d.data.isLocked),k(d.data.isLocked),X.success(d.data.message),u(!1),h(!0)):X.error("OTP verification failed. Please try again.")}catch(m){X.error((null==(c=null==(d=m.response)?void 0:d.data)?void 0:c.error)||"Failed to verify OTP. Try again.")}finally{v(!1)}},onResendOtp:I}),t.jsxs(q,{open:g,onClose:()=>h(!1),children:[t.jsxs(G,{sx:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"2rem"},children:[t.jsx(c.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:100},className:"flex items-center justify-center",style:{width:"100px",height:"100px",borderRadius:"50%",background:y?"#ff0707":"#00bfa5"},children:y?t.jsx(V,{fontSize:"large",style:{color:"#fff"}}):t.jsx(Z,{fontSize:"large",style:{color:"#fff"}})}),t.jsxs(i,{variant:"h6",sx:{marginTop:2,color:y?"#ff0707":"#00bfa5"},children:["Il furgone dovrebbe essere ",y?"Bloccato":"Sbloccato","!"]}),t.jsx(i,{variant:"body2",sx:{marginTop:1},children:"Vuoi riprovare?"})]}),t.jsxs(J,{sx:{display:"flex",justifyContent:"center",gap:"1rem",paddingBottom:"1rem"},children:[t.jsx(d,{onClick:()=>A(!1),color:"secondary",variant:"outlined",children:"No"}),t.jsxs(d,{onClick:()=>A(!0),variant:"outlined",children:["Riprova (",T?"30s":"",")"]})]})]})]})}const Ie="https://rubertogo.com",Ae=le("pk_live_51PwWTGDCK8rR2FJAZlmM7KPakXDO09KCBJRjUT5QRFNRRTvlctb9KG8D9bxZ38RRsG6np5RYrJmVG2AeP22KXq7P00rQKtFDnq"),$e=()=>{var a,o,s,r;const l=de(),m=Q(),x=ee(),{lang:u}=w(),[g,h]=e.useState(!0),p=localStorage.getItem("accessToken"),[f,b]=e.useState(null),[v,y]=e.useState([]),[k,S]=e.useState(null),[B,T]=e.useState([]),{logout:D}=me(),[z,I]=e.useState(null),[A,$]=e.useState(!1),{translations:Y}=ce(),M=()=>{var e,t;if(!(null==f?void 0:f.currentBooking))return!0;const a=null==(t=null==(e=null==f?void 0:f.currentBooking)?void 0:e.vanId)?void 0:t.trackingDevice,n=f.currentBooking.startTime,o=f.currentBooking.endTime,s=f.currentBooking.vanLock;if(console.log(a),!a||"fleet2track"!==(null==a?void 0:a.type))return!0;if(!s)return!0;const i=f.currentBooking.timeZone||"UTC",r=N().tz(i),l=N.tz(n,"YYYY-MM-DDTHH:mm:ss",i),d=N.tz(o,"YYYY-MM-DDTHH:mm:ss",i),c=l.clone().subtract(20,"minutes"),m=d.clone().subtract(20,"minutes");return!!r.isBefore(c)||!!r.isSameOrAfter(m)},L=()=>{if(!(null==f?void 0:f.currentBooking))return Y.vanlockMessages.noBooking;const{trackingDevice:e,startTime:t,endTime:a}=f.currentBooking,n=f.currentBooking.timeZone||"UTC",o=N().tz(n),s=N.tz(t,"YYYY-MM-DDTHH:mm:ss",n),i=N.tz(a,n),r=s.clone().subtract(20,"minutes");return o.isSameOrAfter(r)?Y.vanlockMessages.unlockAtStart:e&&"fleet2track"===(null==e?void 0:e.type)?o.isAfter(i.clone().subtract(20,"minutes"))?Y.vanlockMessages.lockAndEnd:Y.vanlockMessages.ready:Y.vanlockMessages.notAvailable};e.useEffect((()=>{const e=()=>{if(window.innerWidth<768){const e=window.scrollY;h(e<100)}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]);const R=new URLSearchParams(x.search).get("page");e.useEffect((()=>{const e=()=>{window.innerWidth>=768&&!R&&m(`/${u}/account?page=currentbooking`)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[R,u,m]);const H=e=>{m(`/${u}/account?page=${e}`)};e.useEffect((()=>{p&&(async()=>{try{const e=await fetch(`${Ie}/api/user-profile`,{headers:{Authorization:`Bearer ${p}`}});if(e.ok){const t=await e.json();S(t.user)}else console.error("Failed to fetch account data")}catch(e){console.error("Error fetching account data:",e)}})()}),[p]),e.useEffect((()=>{(async()=>{try{const e=await fetch(`${Ie}/api/current`,{headers:{Authorization:`Bearer ${p}`}});if(e.ok){const t=await e.json();b(t)}else await e.json()}catch(e){b(null)}})(),(async()=>{try{const e=(await j.get(`${Ie}/api/reviews/pending`,{headers:{Authorization:`Bearer ${p}`}})).data;e.length>0&&(I(e[0]),$(!0))}catch(e){console.warn("Error fetching pending reviews:",e)}})()}),[R,p]),e.useEffect((()=>{"bookinghistory"===R&&(async()=>{try{const e=await fetch(`${Ie}/api/history`,{headers:{Authorization:`Bearer ${p}`}});if(e.ok){const t=await e.json();y(t)}else console.error("Failed to fetch booking history")}catch(e){console.error("Error fetching booking history:",e)}})()}),[R,p]),e.useEffect((()=>{"pendingbookings"===R&&(async()=>{try{const e=await fetch(`${Ie}/api/pending`,{headers:{Authorization:`Bearer ${p}`}});if(console.log(e),e.ok){const t=await e.json();T(t)}else console.error("Failed to fetch pending bookings")}catch(e){console.error("Error fetching pending bookings:",e)}})()}),[R,p]);const F=async e=>{try{const t=await fetch(`${Ie}/api/complete-payment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({bookingId:e})});if(!t.ok){const e=await t.json();return void X.error(e.error||"Failed to initiate payment.")}const{sessionId:a}=await t.json(),n=await Ae,{error:o}=await n.redirectToCheckout({sessionId:a});o&&(console.error("Stripe Redirect Error:",o),X.error("Failed to redirect to payment. Please try again."))}catch(t){console.warn("Error completing payment:",t)}},O=()=>{switch(R){case"currentbooking":default:return t.jsx(Ce,{bookingData:f});case"bookinghistory":return t.jsx(Be,{bookingHistory:v});case"accountsettings":return t.jsx(ge,{initialUserData:k});case"pendingbookings":return t.jsx(Te,{bookings:B,onPay:F});case"vanlockunlock":return t.jsx(ze,{bookingData:f})}};return t.jsxs("div",{className:"bg-gradient-to-b from-white to-white relative sm:h-[85vh] h-[75vh] sm:py-10 py-6 overflow-y-scroll",children:[t.jsxs("div",{className:"shadow-sm rounded-b-3xl relative",children:[t.jsxs(c.svg,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 225",initial:{y:0},animate:{y:[0,-100,0]},transition:{repeat:1/0,duration:8},children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"grad1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",style:{stopColor:"#ff0707",stopOpacity:1}}),t.jsx("stop",{offset:"100%",style:{stopColor:"#660000",stopOpacity:1}})]})}),t.jsx("path",{fill:"url(#grad1)",d:"M0,64L30,85.3C60,107,120,149,180,144C240,139,300,85,360,85.3C420,85,480,139,540,160C600,181,660,171,720,149.3C780,128,840,96,900,85.3C960,75,1020,85,1080,101.3C1140,117,1200,139,1260,160C1320,181,1380,203,1410,213.3L1440,224L1440,0L1410,0C1380,0,1320,0,1260,0C1200,0,1140,0,1080,0C1020,0,960,0,900,0C840,0,780,0,720,0C660,0,600,0,540,0C480,0,420,0,360,0C300,0,240,0,180,0C120,0,60,0,30,0L0,0Z"})]}),t.jsx(n,{className:"flex flex-col items-center text-center "+(g?"sm:absolute sm:top-20 w-full z-20  border-b border-gray-200":"absolute sm:top-20 w-full z-20 bg-white  border-b border-gray-200"),style:{transition:"all 0.3s ease"},children:t.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},className:""+(g?"flex flex-col items-center rounded-full  p-2":"flex items-center space-x-2"),children:[t.jsx(te,{alt:"User Profile",sx:{width:g?80:60,height:g?80:60,color:"white",backgroundColor:"#ff0707",border:"3px solid white",boxShadow:g?"0px 4px 12px rgba(0, 0, 0, 0.15)":"0px 6px 20px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease"},className:"mb-4 sm:shadow-2xl"}),t.jsxs("div",{className:""+(g?"text-center":"text-left -mt-4 "),children:[t.jsxs(i,{variant:"h6",className:"text-xl "+(g?"text-[#ff0707] font-bold":"text-gray-800 font-semibold"),children:[null==k?void 0:k.firstName," ",null==k?void 0:k.lastName]}),t.jsx(i,{variant:"body2",className:"text-gray-600",children:null==k?void 0:k.email})]})]})})]}),t.jsxs("div",{className:""+(["large-desktop","extra-large-desktop"].includes(l.deviceType)?"hidden":"max-w-full "+(g?"relative max-w-full z-40 bg-white  flex justify-center overflow-x-auto":"relative max-w-full z-40 bg-white shadow-md flex md:justify-center overflow-x-auto")),style:{transition:"all 0.3s ease",padding:g?"0.5rem":"0.3rem"},children:[t.jsx("div",{className:"absolute left-0 top-0 h-full w-16 bg-gradient-to-r from-white to-transparent pointer-events-none"}),t.jsx("div",{className:"absolute right-0 top-0 h-full w-16 bg-gradient-to-l from-white to-transparent pointer-events-none"}),t.jsx("div",{style:{display:"flex",whiteSpace:"nowrap",gap:"8px",maxWidth:"100%",justifyContent:"start",overflowX:"auto"},children:R?t.jsx("div",{style:{display:"flex",gap:"8px",padding:"0.3rem"},children:[{key:"currentbooking",icon:t.jsx(C,{size:20})},{key:"bookinghistory",icon:t.jsx(ae,{size:20})},{key:"pendingbookings",icon:t.jsx(ne,{size:20})},{key:"accountsettings",icon:t.jsx(oe,{size:20})},{key:"vanlockunlock",icon:t.jsx(se,{size:20})}].map((e=>t.jsxs(d,{onClick:()=>H(e.key),variant:R===e.key?"contained":"text",style:{fontSize:"10px",minWidth:"80px",whiteSpace:"nowrap",background:R===e.key?"linear-gradient(to right, #ff0707, #660000)":"transparent",color:R===e.key?"white":"#ff0707",transition:"background 0.3s ease",border:R===e.key?"none":"1px solid #ff0707",display:"flex",justifyContent:"center",alignItems:"center",gap:"4px"},children:[e.icon,t.jsx("span",{children:Y.myAccount[e.key]})]},e.key)))}):t.jsxs("div",{className:"grid grid-cols-2 xs:grid-cols-1 gap-4 ",children:[[{name:Y.myAccount.currentbooking,icon:t.jsx(C,{size:40,className:"text-red-500 mb-2"}),page:"currentbooking"},{name:L(),icon:t.jsx(se,{size:40,className:M()?"text-gray-500 mb-2":"text-red-500 mb-2"}),page:"vanlockunlock",disabled:M()},{name:Y.myAccount.bookinghistory,icon:t.jsx(ae,{size:40,className:"text-red-500 mb-2"}),page:"bookinghistory"},{name:Y.myAccount.pendingbookings,icon:t.jsx(ne,{size:40,className:"text-red-500 mb-2"}),page:"pendingbookings"},{name:Y.myAccount.accountsettings,icon:t.jsx(oe,{size:40,className:"text-red-500 mb-2"}),page:"accountsettings"}].map((e=>t.jsxs(P,{onClick:()=>{e.disabled||H(e.page)},className:"flex flex-col items-center justify-center p-4 cursor-pointer rounded-xl \n                    "+(e.disabled?"bg-gray-300 cursor-not-allowed opacity-50":"bg-gradient-to-br from-gray-400 to-gray-600 hover:scale-105 transform transition-all duration-300"),children:[e.icon,t.jsx(i,{variant:"body1",className:"text-xs font-semibold text-center "+(e.disabled?"text-gray-500":"text-red-500"),sx:{whiteSpace:"wrap",textAlign:"center",fontSize:"18px"},children:e.name})]},e.page))),t.jsxs(P,{onClick:()=>D(),className:"flex flex-col items-center justify-center p-6 cursor-pointer rounded-xl bg-gradient-to-br from-blue-900 to-blue-900 hover:scale-105 transform transition-all duration-300",children:[t.jsx(ie,{size:40,className:"text-blue-950 mb-2"}),t.jsx(i,{variant:"h6",className:"text-xs font-semibold text-blue-950 text-center",children:Y.myAccount.logout})]})]})})]}),["large-desktop","extra-large-desktop"].includes(l.deviceType)&&t.jsxs("div",{className:"flex container mx-auto py-5",children:[t.jsx(n,{className:"w-1/3 bg-white p-8 rounded-lg shadow-lg space-y-4",children:[{name:null==(a=null==Y?void 0:Y.myAccount)?void 0:a.currentbooking,page:"currentbooking",icon:t.jsx(C,{size:20})},{name:L(),icon:t.jsx(se,{size:20}),page:"vanlockunlock",disabled:M()},{name:null==(o=null==Y?void 0:Y.myAccount)?void 0:o.bookinghistory,page:"bookinghistory",icon:t.jsx(ae,{size:20})},{name:null==(s=null==Y?void 0:Y.myAccount)?void 0:s.pendingbookings,page:"pendingbookings",icon:t.jsx(ne,{size:20})},{name:null==(r=null==Y?void 0:Y.myAccount)?void 0:r.accountsettings,page:"accountsettings",icon:t.jsx(oe,{size:20})}].map((e=>t.jsxs(d,{variant:R===e.page?"contained":"text",color:"secondary",disabled:e.disabled,className:"w-full text-left text-sm flex items-center "+(e.disabled?"text-white":"text-red-500"),onClick:()=>H(e.page),sx:{borderRadius:"8px","&:hover":{backgroundColor:"#ff0707",color:"white"},fontSize:"10px",minWidth:"90px",whiteSpace:"nowrap",background:R===e.page?"linear-gradient(to right, #ff0707, #660000)":"transparent",color:R===e.page?"white":"#ff0707",transition:"background 0.3s ease",border:R===e.page?"none":"1px solid #ff0707",display:"flex",alignItems:"center",gap:"4px"},children:[e.icon,t.jsx("span",{className:"ml-2",children:e.name})," "]},e.page)))}),t.jsx(n,{className:"flex-grow w-2/3 bg-white p-5 rounded-lg shadow-lg ml-6",children:t.jsx(re,{mode:"wait",children:t.jsx(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeInOut"},children:O()},R)})})]}),["large-desktop","extra-large-desktop"].includes(l.deviceType)||["mobile","tablet","small-desktop"].includes(l.deviceType)&&R&&t.jsx("div",{className:"mx-4 mt-4",children:t.jsx(re,{mode:"wait",children:t.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeInOut"},children:O()},R)})}),A&&z&&t.jsx(ue,{isOpen:A,onClose:()=>$(!1),booking:z,onSubmit:async e=>{try{!e.vanId&&(null==z?void 0:z.vanId)&&(e.vanId=z.vanId);const t=await fetch(`${Ie}/api/reviews/create`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(e)});if(t.ok)X.success("Review submitted successfully!"),I(null),$(!1);else{const e=await t.json();X.error(e.error||"Failed to submit review.")}}catch(t){console.warn("Failed to submit review. Please try again.")}}})]})};export{$e as default};
