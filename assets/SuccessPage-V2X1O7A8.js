import{r as e,a as t,c as a,u as s,j as i,m as n,b7 as r,g as o,f as l,b8 as c,b9 as d,ba as h,bb as m,bc as x,bd as p,be as u,b as f}from"./vendor-Zgq9WbFI.js";const g="https://rubertogo.com",j=()=>{const[j,y]=e.useState(null),[b,v]=e.useState(!0),[N,w]=e.useState(null),{lang:z}=t(),S=a(),k=s(),_=new URLSearchParams(S.search),$=_.get("session_id"),C=_.get("booking_id");return e.useEffect((()=>{$&&(async()=>{v(!0);try{const e=await f.get(`${g}/api/payment-session/${$}`);y(e.data);const t=await f.post(`${g}/api/create-pre-authorization`,{sessionId:$,bookingId:C},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});200===t.status&&toast.success("Pre-authorization successful."),t.data.error&&(w(t.data.error),k(`/${z}/payment-failed`))}catch(e){toast.error("Failed to create pre-authorization."),k(`/${z}/payment-failed`)}finally{v(!1)}})()}),[$,C,k]),b?i.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#f9fafb"},children:[i.jsx("div",{style:{width:"300px",height:"150px",position:"relative"},children:i.jsxs("svg",{width:"100%",height:"100%",children:[i.jsx("defs",{children:i.jsxs("linearGradient",{id:"vanBodyGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{offset:"0%",stopColor:"#ff5252",stopOpacity:"1"}),i.jsx("stop",{offset:"100%",stopColor:"#e63946",stopOpacity:"1"})]})}),i.jsx("rect",{width:"100%",height:"30",y:"100",fill:"#333"}),i.jsx("line",{x1:"0",y1:"115",x2:"100%",y2:"115",stroke:"#fff",strokeWidth:"2",strokeDasharray:"10 8"}),i.jsx(n.g,{initial:{x:"-20%"},animate:{x:"120%"},transition:{repeat:1/0,duration:5,ease:"linear"},children:i.jsx("image",{href:"/runvan.png",x:"40",y:"20",height:"80",width:"120",style:{filter:"drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2))"},alt:"Van"})})]})}),i.jsx("p",{style:{marginTop:"1.5rem",fontSize:"1rem",fontWeight:"600",color:"#4b5563"},children:"Attendere prego, la tua prenotazione Ã¨ in elaborazione..."})]}):N?i.jsxs(n.div,{className:"flex flex-col items-center justify-center h-screen",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:[i.jsx(r,{size:100,className:"text-red-600"}),i.jsx(o,{variant:"h4",className:"text-center mt-4",children:N})]}):i.jsxs(n.div,{className:"container mx-auto sm:py-32 py-10 px-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:[i.jsxs(n.div,{className:"py-12 bg-gradient-to-r from-[#ff0707] to-orange-500 text-white text-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:[i.jsx(o,{variant:"h4",className:"font-bold",children:"La tua ricevuta di pagamento"}),i.jsx(o,{variant:"body1",className:"mt-2",children:"Grazie per il tuo acquisto! Di seguito i dettagli del pagamento."})]}),i.jsx("div",{className:"grid grid-cols-1 gap-4",children:i.jsxs(l,{className:"bg-white shadow-lg rounded-lg border border-gray-300 p-6 text-gray-700",children:[i.jsx(n.div,{className:"flex items-center justify-center",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:150,damping:20},children:i.jsx("div",{className:"bg-green-500 p-3 rounded-full",children:i.jsx(c,{size:32,className:"text-white"})})}),i.jsx(o,{variant:"h4",className:"text-center font-bold mt-4",children:"Pagamento Avvenuto con Successo!"}),i.jsxs(o,{variant:"h6",className:"text-center font-semibold mt-2",children:[(j.amount_total/100).toFixed(2),i.jsx("span",{className:"uppercase ml-2",children:j.currency})]}),i.jsx(d,{component:h,className:"mt-6 shadow-md",children:i.jsx(m,{children:i.jsxs(x,{children:[i.jsxs(p,{children:[i.jsx(u,{className:"font-semibold",children:"Nome:"}),i.jsx(u,{children:j.customer_details.name})]}),i.jsxs(p,{children:[i.jsx(u,{className:"font-semibold",children:"Email:"}),i.jsx(u,{children:j.customer_details.email})]}),i.jsxs(p,{children:[i.jsx(u,{className:"font-semibold",children:"Numero di Telefono:"}),i.jsx(u,{children:j.customer_details.phone})]}),i.jsxs(p,{children:[i.jsx(u,{className:"font-semibold",children:"Importo Pagato:"}),i.jsxs(u,{children:[(j.amount_total/100).toFixed(2)," CHF"]})]})]})})}),i.jsx(o,{variant:"body2",className:"text-center mt-6 p-4 text-gray-500",children:"Grazie per il tuo pagamento!"})]})})]})};export{j as default};
