import{r as x,e as Pe,h as ye,u as $e,j as e,n as Be,B as Ie,o as Ae}from"./index-B_XR-bXS.js";import{d as j}from"./dayjs.min-DJi5V76p.js";import{o as Q,V as we,a7 as Fe,t as Ee,a9 as Le,d as _e,K as Re}from"./index-DpxsO8Tb.js";import{c as re,A as xe}from"./index-D06Jhu5U.js";import{b as ze}from"./index-DG1V1zS4.js";import{c as Oe,C as Ge,B as Ue,T as Ve,a as We,b as ue,d as he}from"./Carousel-BWLugbGD.js";import{l as Ke}from"./index-Rnf9BJUB.js";import{h as k}from"./proxy-ghLGn7f2.js";import{B as fe}from"./Button-gI_ekC-0.js";import{M as Ze}from"./Modal-Cde_47yd.js";import{G as ge}from"./Grid-EGPPBo8K.js";import{C as qe}from"./CircularProgress-CnUP9nIX.js";import{C as Je}from"./CardMedia-dOw0Sd59.js";import{T as ne}from"./Typography-CuI5uYqX.js";const Qe="https://rubertogo.com",pe=Ke(Qe),oe="https://rubertogo.com",be=(a=[])=>a.flatMap(l=>l.hours.map(d=>({date:new Date(l.date).toISOString().split("T")[0],time:d}))),Xe=()=>{const a=[];for(let l=0;l<=23;l++)a.push(`${l<10?"0":""}${l}:00`);return a},v=Xe(),et=(a,l)=>{const d=[],h=new Date(a);for(let f=0;f<l;f++){const p=new Date(h);d.push({date:j(p).format("YYYY-MM-DD"),displayDate:p.toLocaleDateString("en-GB",{day:"numeric",month:"short"}),slots:v}),h.setDate(h.getDate()+1)}return d},ie=(a,l)=>{var f;const d=j(l).format("dddd"),h=(f=a.dailyPricing)==null?void 0:f.find(p=>p.day===d);return(h==null?void 0:h.pricePerHour)||0},je=(a={})=>{const l=[],d=new Date,h=d.getDay(),f=d.getHours(),p=d.getMinutes(),C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][h],E=d.toISOString().split("T")[0];if(a[C]){const{start:S,end:L}=a[C],M=parseInt(S.split(":")[0],10),B=parseInt(L.split(":")[0],10);if(B<M){for(let N=M;N<24;N++)(N<f-1||N===f-1&&p===0)&&l.push({date:E,time:`${N<10?"0":""}${N}:00`});const y=new Date(d);y.setDate(y.getDate()+1);const P=y.toISOString().split("T")[0];for(let N=0;N<B;N++)l.push({date:P,time:`${N<10?"0":""}${N}:00`})}else for(let y=M;y<B;y++)(y<f-1||y===f-1&&p===0)&&l.push({date:E,time:`${y<10?"0":""}${y}:00`})}return l},tt=({van:a,isOpen:l,onClose:d})=>{const[h,f]=x.useState("21:00"),[p,C]=x.useState({}),[E,S]=x.useState([]),[L,M]=x.useState([]);x.useEffect(()=>{(async()=>{try{const s=await(await fetch(`${oe}/api/packages`)).json();M(s)}catch(r){console.error("Error fetching packages:",r)}})()},[]);const B=(t,r)=>{const s=j(`${t}T${h}`,"YYYY-MM-DDTHH:mm"),o=s.add(p.freeHours,"hour");if(j(`${t}T${r}:00`,"YYYY-MM-DDTHH:mm").isBetween(s,j(t).endOf("day"),null,"[)"))return!0;const n=j(t).add(1,"day").format("YYYY-MM-DD");return j(`${n}T${r}`,"YYYY-MM-DDTHH:mm").isBetween(s.add(1,"day").startOf("day"),o,null,"[)")},W=new Date,y=7,[P,N]=x.useState(0),[D,z]=x.useState(null),[R,K]=x.useState(null),[b,T]=x.useState([]),w=x.useRef(null),[O,I]=x.useState(!1),$=Pe(),{translations:c}=ye(),{lang:H}=$e(),[X,Z]=x.useState(!0),[G,ee]=x.useState(!1),[te,ce]=x.useState(!1);x.useEffect(()=>{if(a)return(async()=>{try{Z(!0);const s=await(await fetch(`${oe}/api/booking-settings/${a._id}`)).json();C({freeHours:s.freeHours??9,minimumPaidHours:s.minimumPaidHours??3}),f(s.freePeriodStart??"21:00");const o=[...be(s.blockedDateHours),...je(a.restrictedBookingHours)];S(o)}catch(r){console.error("Error fetching booking settings:",r)}finally{Z(!1)}})(),pe.on("bookingSettingsUpdated",({vanId:r,settings:s})=>{if(r===a._id){C(s);const o=[...be(s.blockedDateHours),...je(a.restrictedBookingHours)];S(o)}}),()=>{pe.off("bookingSettingsUpdated")}},[a]),x.useEffect(()=>{const t=a==null?void 0:a._id;a&&l&&(async()=>{try{const o=await(await fetch(`${oe}/api/vans/${t}/booked-slots`)).json(),n=(Array.isArray(o)?o:o.bookings||[]).flatMap(m=>m.selectedSlots.map(u=>({date:u.date,time:u.time})));T(n)}catch(s){console.log("Error fetching booked slots:",s)}finally{Z(!1)}})()},[a,l]);const Se=()=>{const t=new URLSearchParams($.search),r=t.get("start_date"),s=t.get("start_time"),o=t.get("end_date"),i=t.get("end_time");return{start_date:r,start_time:s,end_date:o,end_time:i}},ke=[{target:".modal-header",content:"Welcome to the booking modal! Here you can select your desired vehicle and book your time slots.",placement:"bottom"},{target:".time-slot-table",content:"Select your start time by clicking on a time slot.",placement:"top"},{target:".time-slot-table td",content:"Available time slots are highlighted. Click to select an end time.",placement:"top"},{target:".booking-button",content:"Once you have selected your slots, click here to proceed to checkout.",placement:"top"}],g=x.useMemo(()=>et(W,30),[W]);x.useEffect(()=>{if(l&&E.length>0){const{start_date:t,start_time:r,end_date:s,end_time:o}=Se();if(t&&r&&s&&o){const i=De({start_date:t,start_time:r,end_date:s,end_time:o});V(i)}}},[l,E]);const De=({start_date:t,start_time:r,end_date:s,end_time:o})=>{if(t&&r&&s&&o){const i=g.findIndex(u=>j(u.date).isSame(j(t),"day"));if(i===-1)return[];const n=v.findIndex(u=>u===r),m=j(`${s}T${o}:00`,"YYYY-MM-DDTHH:mm").diff(j(`${t}T${r}:00`,"YYYY-MM-DDTHH:mm"),"hour");return Te(i,n,m)}return[]},Te=(t,r,s)=>{let o=s,i=[];for(let n=t;n<g.length;n++){const m=g[n].slots;for(let u=r;u<m.length;u++){const _=m[u];if(q(g[n].date,_)){if(i.push({date:g[n].date,time:_}),o--,o===0)return i}else i=[],o=s,r=0}r=0}return i},A=(t,r)=>b.some(s=>s.date===t&&s.time===r),F=(t,r)=>E.some(s=>s.date===t&&s.time===r),U=(t,r)=>{const s=j();return j(`${t}T${r}`,"YYYY-MM-DDTHH:mm").isBefore(s)},q=(t,r)=>!U(t,r)&&!F(t,r)&&!A(t,r),[Y,V]=x.useState([]),de=t=>{if(!D)z(t),V([t]);else{if(R){z(t),K(null),V([t]);return}const r=g.findIndex(u=>u.date===D.date),s=v.findIndex(u=>u===D.time),o=v.findIndex(u=>u===t.time),i=g.findIndex(u=>u.date===t.date);if(i<r||i===r&&o<s){z(t),V([t]);return}let n=!0,m=[];if(D.date===t.date)for(let u=s;u<=o;u++){const _=v[u];if(F(t.date,_)||A(t.date,_)){n=!1;break}m.push({date:t.date,time:_})}else n=ve(r,s,i,o,m);n?(V(m),K(t)):(z(t),K(null),V([t]))}},ve=(t,r,s,o,i)=>{for(let n=r;n<v.length;n++){const m=v[n];if(U(g[t].date,m)||F(g[t].date,m)||A(g[t].date,m))return!1;i.push({date:g[t].date,time:m})}for(let n=t+1;n<s;n++)for(const m of v){if(U(g[n].date,m)||F(g[n].date,m)||A(g[n].date,m))return!1;i.push({date:g[n].date,time:m})}for(let n=0;n<=o;n++){const m=v[n];if(U(g[s].date,m)||F(g[s].date,m)||A(g[s].date,m))return!1;i.push({date:g[s].date,time:m})}return!0},se=()=>{let t=0,r=0;const s=Y.reduce((o,i)=>(o[i.date]||(o[i.date]=[]),o[i.date].push(i),o),{});if(Object.keys(s).forEach(o=>{const i=ie(a,o);s[o].forEach(n=>{B(n.date,n.time)||(t++,r+=i)})}),t<p.minimumPaidHours){let o=0,i=0;const n=Y.sort((m,u)=>{const _=new Date(m.date+"T"+m.time),Me=new Date(u.date+"T"+u.time);return _-Me});for(const m of n)if(i<p.minimumPaidHours)o+=ie(a,m.date),i++;else break;return o}return r},J=(()=>{const t=Y.length;if(!L||t<24)return null;let r=null,s=1/0;return L.forEach(o=>{const i=o.duration*24,n=Math.abs(i-t);i>=t&&n<s&&(r=o,s=n)}),r})();x.useEffect(()=>{l&&J&&!G&&!te&&(ee(!0),w.current.scrollTop=0)},[l,J,G,te]);const He=()=>{ee(!1),ce(!0)},ae=(t=null)=>{const r=t?L.find(i=>i._id===t):null;if(!Y.length){Ie.error("Please select at least one hour time solt.");return}const s={selectedSlots:Y,totalPrice:r?r.price:se(),vanDetails:a,packageId:r?r._id:null};localStorage.setItem("bookingData",JSON.stringify(s));const o=`/:${H}/create-booking`;window.location.href=o},Ye=()=>{N(t=>Math.max(t-y,0)),w.current&&(w.current.scrollTop=0)},Ce=()=>{N(t=>Math.min(t+y,g.length-y)),w.current&&(w.current.scrollTop=0)},me=t=>{const r=Y.filter(i=>B(i.date,i.time));Y.filter(i=>!B(i.date,i.time));const s=Math.max(0,Y.length-p.minimumPaidHours),o=r.findIndex(i=>i.date===t.date&&i.time===t.time);return o>=0&&o<s};return X?e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:e.jsx(k.div,{initial:{rotate:0},animate:{rotate:360},transition:{repeat:1/0,duration:1.5,ease:"linear"},className:"w-20 h-20 border-4 border-t-blue-500 border-r-transparent border-b-transparent border-l-blue-500 rounded-full"})}):l?Be.createPortal(e.jsxs(k.div,{className:"relative",children:[e.jsx(Oe,{steps:ke,run:O,continuous:!0,showSkipButton:!0,callback:t=>{(t.status==="finished"||t.status==="skipped")&&I(!1)},styles:{options:{zIndex:1e4,backgroundColor:"#fff",color:"#333",arrowColor:"#fff",primaryColor:"#007bff",textColor:"#333",beaconSize:20,spotlightPadding:10,spotlightBorderRadius:8}}}),e.jsxs(k.div,{className:"fixed inset-0 bg-gray-800 bg-opacity-70 flex max-w-full m-auto items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsxs(k.div,{className:"bg-white p-8 sm:p-5 rounded-2xl shadow-2xl w-full sm:max-w-4xl sm:h-[70vh] h-[90vh]  overflow-y-auto relative",ref:w,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.5,ease:"easeInOut"},children:[e.jsx(k.button,{onClick:d,className:"absolute z-40 top-4 right-4 text-red-500 text-2xl rounded-full shadow-md hover:bg-gray-100 p-2",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(ze,{})}),e.jsx(Ge,{images:a.images}),J&&e.jsx(e.Fragment,{children:e.jsx(Ue,{betterPackage:J,isOpen:G,onClose:He,handleBooking:ae})}),e.jsxs(Ve,{children:[e.jsxs(We,{className:"flex text-center items-center gap-5 p-5 justify-center border-0",children:[e.jsx(ue,{className:"py-2 bg-blue-100 sm:py-4 flex-1 cursor-pointer font-semibold text-lg sm:text-xl",children:c.timeTable}),e.jsx(ue,{className:"py-2 sm:py-4 bg-blue-100 flex-1 cursor-pointer font-semibold text-lg sm:text-xl details-tab",children:c.details})]}),e.jsxs(he,{children:[e.jsxs(k.div,{className:"text-center mb-4 sm:mb-6",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.7},children:[e.jsx("h1",{className:"text-xl sm:text-3xl font-bold text-gray-800 mt-5",children:c.modalTitle}),e.jsx("h3",{className:"text-lg sm:text-2xl text-gray-700",children:a.name[H]||a.name.en}),e.jsx("p",{className:"text-gray-500 text-xl",children:c.modalSubtitle}),te&&e.jsx("div",{className:"text-center mt-4",children:e.jsx(fe,{variant:"outlined",color:"warning",onClick:()=>{ee(!0),ce(!1)},children:"View Better Package Offer"})}),e.jsxs("button",{onClick:ae,className:"w-full bg-blue-600 py-3 sm:py-4 text-white text-lg sm:text-xl rounded-lg mt-4 shadow-lg",children:[c.priceLabel,": ",se()," CHF"]})]}),e.jsxs(k.div,{className:"w-full overflow-x-auto sm:overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},children:[e.jsx("div",{className:"hidden sm:block max-w-full overflow-x-auto time-slot-table",children:e.jsxs("table",{className:"max-w-full border-separate border-spacing-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2 sm:p-4 sticky left-0 bg-white text-base sm:text-lg font-semibold text-gray-600",style:{zIndex:10},children:"Date"}),v.map((t,r)=>e.jsx("th",{className:"border p-2 sm:p-4 left-0 bg-white text-base sm:text-lg font-semibold text-gray-600",children:t},r))]})}),e.jsx("tbody",{children:g.slice(P,P+y).map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2 sm:p-4 sticky left-0 bg-white font-semibold text-gray-700",children:t.displayDate}),v.map((s,o)=>{const i=D&&!R&&t.date===D.date?v.findIndex(n=>n===D.time)+1:null;return e.jsxs(k.td,{className:`border text-center cursor-pointer  p-2 sm:p-4 transition-all duration-300 ${Y.some(n=>n.date===t.date&&n.time===s)?"bg-green-500 text-white font-bold":F(t.date,s)?"bg-red-600 text-white":A(t.date,s)?"bg-gray-400 text-center text-white":U(t.date,s)?"bg-gray-300 cursor-not-allowed":"bg-white"}`,whileHover:{scale:q(t.date,s)?1.05:1},whileTap:{scale:.95},onClick:()=>q(t.date,s)&&de({date:t.date,time:s}),children:[D&&!R&&i===o&&e.jsx(k.span,{className:"relative inset-0 flex text-center justify-center items-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.5},children:e.jsx(Q,{className:"text-yellow-400 text-3xl animate-bounce",title:"Select end time"})}),F(t.date,s)?e.jsx(we,{className:"text-red-500 text-4xl font-extrabold"}):A(t.date,s)?e.jsx(re,{className:"text-white text-center"}):Y.some(n=>n.date===t.date&&n.time===s)?me({date:t.date,time:s})?e.jsx("span",{className:"text-white",children:c.freeLabel}):e.jsx(xe,{className:"text-white text-4xl font-extrabold"}):null]},o)})]},r))})]})}),e.jsx("div",{className:"block sm:hidden",children:g.slice(P,P+y).map((t,r)=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"text-white text-center bg-green-800 p-5 font-bold text-lg mb-2",children:["Date ",t.displayDate]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map((s,o)=>{const i=D&&!R&&t.date===D.date?v.findIndex(n=>n===D.time)+1:null;return e.jsxs(k.div,{className:`p-4 text-center flex flex-col items-center justify-center border transition-all duration-300 rounded-lg ${Y.some(n=>n.date===t.date&&n.time===s)?"bg-green-500 text-white font-bold":F(t.date,s)?"bg-red-600 text-white":A(t.date,s)?"bg-gray-500 text-white":U(t.date,s)?"bg-gray-300 cursor-not-allowed":"bg-white"}`,whileHover:{scale:q(t.date,s)?1.05:1},whileTap:{scale:.95},onClick:()=>q(t.date,s)&&de({date:t.date,time:s}),children:[s,D&&!R&&i===o&&e.jsxs(k.div,{className:"relative flex items-center justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.5},children:[e.jsx(Q,{className:"text-yellow-400 text-xl animate-bounce"}),e.jsx("div",{className:"absolute top-full mt-2 bg-blue-600 text-white text-xs font-semibold px-3 py-1 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-lg transform -translate-x-1/2",children:"Select an end time."})]}),F(t.date,s)?e.jsx(re,{className:"text-white"}):A(t.date,s)?e.jsx(re,{className:"text-white"}):Y.some(n=>n.date===t.date&&n.time===s)?me({date:t.date,time:s})?e.jsx("span",{className:"text-white",children:c.freeLabel}):e.jsx(xe,{className:"text-white text-4xl font-extrabold"}):null]},o)})})]},r))})]}),e.jsxs("div",{className:"flex justify-between mt-4 sm:mt-6",children:[e.jsx(k.button,{onClick:Ye,className:"text-orange-500 text-lg p-2",disabled:P===0,whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(Fe,{size:24})}),e.jsx(k.button,{onClick:Ce,className:"text-orange-500 text-lg p-2",disabled:P+y>=g.length,whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(Q,{size:24})})]})]}),e.jsx(he,{children:e.jsxs(k.div,{className:"text-left p-6 bg-white rounded-lg shadow-md",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-gray-800",children:c.vehicleDetails}),e.jsxs("div",{className:"p-4 rounded-lg border-b-2 border-t-2 border-dashed border-red-300 ",children:[e.jsxs("h3",{className:"text-2xl font-semibold mb-2",children:[" ",a.name[H]||a.name.en]}),e.jsxs("p",{className:"text-red-500 font-bold text-xl mt-2",children:[c.priceLabel,":"," ",e.jsxs("span",{className:"text-green-600",children:[ie(a)," CHF ",c.perHour]})]})]}),e.jsxs("div",{className:" flex items-center justify-between p-4 border-b-2 border-dashed border-red-300 rounded-lg  ",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:c.externalDimensions}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600",children:[e.jsxs("li",{children:[c.length,":"," ",e.jsx("span",{className:"font-semibold",children:a.externalDimensions.length})]}),e.jsxs("li",{children:[c.width,":"," ",e.jsx("span",{className:"font-semibold",children:a.externalDimensions.width})]}),e.jsxs("li",{children:[c.Height,":"," ",e.jsx("span",{className:"font-semibold",children:a.externalDimensions.height})]})]})]}),e.jsx("div",{children:e.jsx("img",{src:"/externalsize.png",width:120,alt:"",srcset:""})})]}),e.jsxs("div",{className:" flex items-center justify-between p-4 rounded-lg border-b-2 border-dashed border-red-300 ",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:c.internalDimensions}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600",children:[e.jsxs("li",{children:[c.length,":"," ",e.jsx("span",{className:"font-semibold",children:a.internalDimensions.length})]}),e.jsxs("li",{children:[c.width,":"," ",e.jsx("span",{className:"font-semibold",children:a.internalDimensions.width})]}),e.jsxs("li",{children:[c.Height,":"," ",e.jsx("span",{className:"font-semibold",children:a.internalDimensions.height})]})]})]}),e.jsx("div",{children:e.jsx("img",{src:"/internalsize.png",width:120,alt:"",srcset:""})})]}),e.jsxs("div",{className:" p-4 rounded-lg border-b-2 border-dashed border-red-300",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:c.weight}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600",children:[e.jsxs("li",{children:[c.empty,":"," ",e.jsx("span",{className:"font-semibold",children:a.weight.empty})]}),e.jsxs("li",{children:[c.maxLoad,":"," ",e.jsx("span",{className:"font-semibold",children:a.weight.maxLoad})]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border-b-2 border-dashed border-red-300",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:c.optionalFeatures}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600",children:[e.jsxs("li",{children:[c.roofRack,":"," ",a.optionalFeatures.roofRack?e.jsx("span",{className:"text-green-500",children:"✓ Available"}):e.jsx("span",{className:"text-red-500",children:"✗ Not Available"})]}),e.jsxs("li",{children:[c.airConditioning,":"," ",a.optionalFeatures.airConditioning?e.jsx("span",{className:"text-green-500",children:"✓ Available"}):e.jsx("span",{className:"text-red-500",children:"✗ Not Available"})]}),e.jsxs("li",{children:[c.towingHook,":"," ",a.optionalFeatures.towingHook?e.jsx("span",{className:"text-green-500",children:"✓ Available"}):e.jsx("span",{className:"text-red-500",children:"✗ Not Available"})]}),e.jsxs("li",{children:[c.parkingSensors,":"," ",a.optionalFeatures.parkingSensors?e.jsx("span",{className:"text-green-500",children:"✓ Available"}):e.jsx("span",{className:"text-red-500",children:"✗ Not Available"})]})]})]})]})})]})]}),e.jsx("div",{className:"max-w-full fixed bottom-4 left-0 right-0 px-4",children:e.jsxs(fe,{variant:"contained",color:"warning",fullWidth:!0,className:"booking-button gap-5 rounded-xl bg-blue-600 text-white py-4 shadow-lg hover:bg-blue-700 transition duration-300",onClick:ae,children:[e.jsxs("span",{className:" font-extrabold  text-2xl",children:[" ",se()," CHF"]})," ",c.procedToBooking," ",e.jsx(Q,{})]})})]})]}),document.body):null},le="https://rubertogo.com",st=()=>e.jsxs("svg",{className:"absolute inset-0 w-full h-full z-0",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",viewBox:"0 0 800 600",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"bgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ff2100"}),e.jsx("stop",{offset:"100%",stopColor:"#ff2100"})]}),e.jsxs("linearGradient",{id:"shapeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#8c020b"}),e.jsx("stop",{offset:"100%",stopColor:"#000"})]})]}),e.jsx("rect",{width:"800",height:"600",fill:"url(#bgGradient)"}),e.jsx("circle",{cx:"200",cy:"150",r:"100",fill:"rgba(255, 255, 255, 0.1)"}),e.jsx("circle",{cx:"600",cy:"450",r:"150",fill:"rgba(255, 255, 255, 0.1)"}),e.jsx("path",{d:"M0,200 C400,100 400,500 800,300 L800,600 L0,600 Z",fill:"url(#shapeGradient)",opacity:"0.3"}),e.jsx("path",{d:"M0,400 C400,200 400,600 800,400 L800,600 L0,600 Z",fill:"url(#shapeGradient)",opacity:"0.2"})]}),Ne=a=>{var h;const l=j().format("dddd"),d=(h=a.dailyPricing)==null?void 0:h.find(f=>f.day===l);return d!=null&&d.pricePerHour?`${d.pricePerHour} CHF / hour`:"Not available"},at=({van:a,onSelect:l})=>{const{language:d,translations:h}=ye(),[f,p]=x.useState(!0),C=()=>{p(!1)};return e.jsxs(k.div,{className:"relative flex h-[420px] flex-col  rounded-xl overflow-hidden  transition-transform duration-300 transform  hover:shadow-2xl bg-white",children:[e.jsx("div",{className:"relative z-10 w-full  h-[180px] overflow-hidden flex items-center",children:e.jsxs("div",{className:"relative h-full w-full",children:[f&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsx(qe,{})}),e.jsx(Je,{component:"img",alt:a.name.en,image:a.images[0],title:a.name.en,className:"h-full w-full object-cover transition-transform duration-300 hover:scale-110",style:{padding:"1.2rem",objectFit:"contain"},loading:"lazy",onLoad:C,srcSet:`
    ${a.images[0]}?w=300&h=180&fit=crop 300w,
    ${a.images[0]}?w=600&h=360&fit=crop 600w,
    ${a.images[0]}?w=900&h=540&fit=crop 900w
  `,sizes:`(max-width: 600px) 300px, 
         (max-width: 1200px) 600px, 
         900px`})]})}),e.jsx("div",{className:"absolute inset-0 z-0",children:e.jsx(st,{})}),e.jsxs("div",{className:"flex flex-col  gap-5 justify-between  bg-white bg-opacity-1 backdrop-blur-md border border-gray-200 rounded-lg relative z-10 flex-grow",style:{flex:1,padding:"0.5rem"},children:[e.jsxs("div",{className:"flex-grow p-2",children:[e.jsx(ne,{variant:"h6",className:"font-extrabold text-gray-800 text-center   text-xl md:text-2xl",style:{marginBottom:"0.3rem"},children:a.name[d]||a.name.en}),e.jsx(ne,{variant:"h6",className:" text-3xl text-green-600 font-extrabold text-center  md:text-2xl",style:{marginBottom:"0.3rem"},children:Ne(a)}),e.jsx(ne,{variant:"body2",className:" text-center flex items-center text-sm justify-center text-green-900",sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.3rem",marginTop:"0.3rem",textAlign:"center"},children:a.location.address||"Location not specified."}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("div",{className:"flex gap-4 mt-2 justify-center max-w-full animate-auto-scroll",children:[a.optionalFeatures.roofRack&&e.jsxs("span",{className:"bg-green-500 text-center flex justify-center items-center text-white rounded-full px-6 py-2 min-w-[200px] text-sm font-semibold shadow-md transition-transform duration-200 hover:scale-105",children:[e.jsx(Ee,{className:"mr-2"})," ",h.roofRack]}),a.optionalFeatures.airConditioning&&e.jsxs("span",{className:"bg-green-500 text-center flex justify-center items-center text-white rounded-full px-6 py-2 min-w-[200px] text-sm font-semibold shadow-md transition-transform duration-200 hover:scale-105",children:[e.jsx(Le,{className:"mr-2"})," ",h.airConditioning]}),a.optionalFeatures.towingHook&&e.jsxs("span",{className:"bg-green-500 text-center flex justify-center items-center text-white rounded-full px-6 py-2 min-w-[200px] text-sm font-semibold shadow-md transition-transform duration-200 hover:scale-105",children:[e.jsx(_e,{className:"mr-2"})," ",h.towingHook]}),a.optionalFeatures.parkingSensors&&e.jsxs("span",{className:"bg-green-500 text-center flex justify-center items-center text-white rounded-full px-6 py-2 min-w-[250px] text-sm font-semibold shadow-md transition-transform duration-200 hover:scale-105",children:[e.jsx(Re,{className:"mr-2"})," ",h.parkingSensors]})]})})})]}),e.jsx("button",{onClick:()=>l(a),className:" w-full text-white font-bold bg-blue-600 rounded-lg border-2  py-2 text-lg shadow-md transition-transform duration-200 hover:bg-green-600 hover:text-white hover:shadow-lg transform hover:scale-104",children:h.bookNowButton})]})]})},rt=(a=[])=>a.flatMap(l=>l.hours.map(d=>({date:j(l.date).format("YYYY-MM-DD"),time:d}))),nt=a=>{const l=[];return Object.entries(a).forEach(([d,h])=>{const{start:f,end:p}=h;if(f&&p)if(j(`1970-01-01T${f}`).isAfter(j(`1970-01-01T${p}`))){l.push({day:d,start:f,end:"23:59"});const C=ot(d);l.push({day:C,start:"00:00",end:p})}else l.push({day:d,start:f,end:p})}),l},ot=a=>{const l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],d=l.indexOf(a);return l[(d+1)%l.length]},Nt=({isOpenVanModal:a,onCloseVanModal:l})=>{const[d,h]=x.useState([]),[f,p]=x.useState([]),[C,E]=x.useState([]),[S,L]=x.useState(null),[M]=Ae(),B=M.get("start_date"),W=M.get("start_time"),y=M.get("end_date"),P=M.get("end_time"),N=async()=>{try{const T=await(await fetch(`${le}/api/vans`)).json();h(T)}catch(b){console.error("Error fetching vans:",b)}};x.useEffect(()=>{a&&N()},[a]);const D=async b=>{try{const w=await(await fetch(`${le}/api/booking-settings/${b}`)).json();p(rt(w.blockedDateHours||[]))}catch(T){console.error("Error fetching blocked slots:",T)}},z=async b=>{try{const w=await(await fetch(`${le}/api/vans/${b}/booked-slots`)).json(),I=(Array.isArray(w)?w:w.bookings||[]).flatMap($=>$.selectedSlots.map(c=>({date:c.date,time:c.time})));E(I)}catch(T){console.error("Error fetching booked slots:",T)}},R=(b,T,w)=>{const O=nt(b.restrictedBookingHours),I=[...f,...C,...O],$=j(`${T}T${W}`),c=j(`${w}T${P}`);let H=$;for(;I.some(G=>G.date===H.format("YYYY-MM-DD")&&G.time===H.format("HH:mm"));)H=H.add(1,"hour");const X=c.diff($,"hour"),Z=H.add(X,"hour");return{adjustedStart:H,adjustedEnd:Z}},K=async b=>{await D(b._id),await z(b._id);const T=Ne(b),w=B||j().format("YYYY-MM-DD"),O=y||j(w).add(1,"day").format("YYYY-MM-DD"),{adjustedStart:I,adjustedEnd:$}=R(b,w,O),H=$.diff(I,"hour")*parseFloat(T);L({...b,name:b.name||"Unnamed Van",description:b.description.en||"No description available.",currentDayPrice:T,totalPrice:H,startDate:I.format("YYYY-MM-DD"),endDate:$.format("YYYY-MM-DD"),startTime:I.format("h:mm A"),endTime:$.format("h:mm A")})};return S&&l(),e.jsxs("div",{className:"container m-auto pb-10 p-5",children:[e.jsx(Ze,{open:a,onClose:l,"aria-labelledby":"vans-modal-title","aria-describedby":"vans-modal-description",children:e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg max-w-5xl h-[80vh] overflow-y-scroll w-full relative",children:[e.jsx("button",{className:" absolute right-2 top-2 text-red-500 text-2xl hover:bg-red-500 hover:text-white rounded-full p-2 ",onClick:l,children:e.jsx(we,{})}),e.jsx("div",{className:"container m-auto pb-10 p-5",children:e.jsx(ge,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:d.map(b=>e.jsx(ge,{item:!0,xs:12,sm:6,md:6,lg:6,xl:6,children:e.jsx(at,{van:b,onSelect:K})},b._id))})})]})})}),S&&e.jsx(tt,{isOpen:!!S,onClose:()=>L(null),van:S,currentDayPrice:S.currentDayPrice,totalPrice:S.totalPrice,startDate:S.startDate,endDate:S.endDate,startTime:S.startTime,endTime:S.endTime})]})};export{Nt as V};
