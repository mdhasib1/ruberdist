import{a as e,r as t,u as s,j as a,g as i,a2 as n,bi as r,bj as l,a4 as o,aE as c,cH as u,cj as m,b as d,aV as g}from"./vendor-Zgq9WbFI.js";import{u as h}from"./index-D29cp_SG.js";const f="https://rubertogo.com",x=()=>{const{lang:x}=e(),{login:p}=h(),[j,b]=t.useState(""),[v,y]=t.useState(["","","",""]),[w,S]=t.useState(1),[N,P]=t.useState(""),[T,O]=t.useState(!1),[C,D]=t.useState(!1),A=s(),V=t.useRef([]),E=e=>{const t=e.clipboardData.getData("Text").slice(0,4);if(4===t.length){const e=t.split("");y(e),V.current[3].focus()}},I=()=>{O(!1)};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:a.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),a.jsx(i,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:1===w?"Admin Sign In":"Verify OTP"}),1===w&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),P(""),D(!0);try{await d.post(`${f}/api/login`,{email:j});g.success("OTP sent to your email."),S(2)}catch(t){P("User not found with the given email."),O(!0)}finally{D(!1)}},children:[a.jsx("div",{className:"mb-4",children:a.jsx(n,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:j,onChange:e=>{b(e.target.value)},InputProps:{startAdornment:a.jsx(r,{position:"start",children:a.jsx(l,{className:"text-gray-400"})})}})}),a.jsx(o,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:C,children:C?"Sending OTP...":"Send OTP"})]}),2===w&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=v.join("");P(""),D(!0);try{const e=await d.post(`${f}/api/verify-otp`,{email:j,otp:t}),{accessToken:s}=e.data;p(s),g.success("Login successful!"),A(`/${x}/admin/overview`)}catch(s){P("Invalid or expired OTP."),O(!0)}finally{D(!1)}},children:[a.jsx(i,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),a.jsx(c,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",sx:{textAlign:"center",marginTop:"1rem"},children:v.map(((e,t)=>a.jsx(c,{item:!0,children:a.jsx(n,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:e,onChange:e=>((e,t)=>{const{value:s}=e.target;if(1===s.length){const e=[...v];e[t]=s,y(e),t<v.length-1&&V.current[t+1].focus()}else if(""===s){const e=[...v];e[t]="",y(e),t>0&&V.current[t-1].focus()}})(e,t),onPaste:0===t?E:void 0,inputRef:e=>V.current[t]=e,required:!0})},t)))}),a.jsx(o,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:C,children:C?"Verifying...":"Verify OTP"})]}),a.jsx(u,{open:T,autoHideDuration:6e3,onClose:I,children:a.jsx(m,{onClose:I,severity:"error",children:N})})]})})};export{x as default};
