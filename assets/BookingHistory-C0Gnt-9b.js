import{a as e,r as a,j as t,f as s,a$ as r,g as i,aQ as n,aR as l,ar as d,ce as o,aG as c,cf as m,bZ as x,b as h}from"./vendor-Zgq9WbFI.js";const u=()=>{const{userId:u,lang:g}=e(),[f,N]=a.useState([]),[j,v]=a.useState(null),[p,b]=a.useState(!1),[y,T]=a.useState(null);if(a.useEffect((()=>{(async()=>{var e,a;b(!0);const t=localStorage.getItem("accessToken");if(!t)return T("User is not authenticated. Please log in."),void b(!1);try{const e=await h.get(`https://rubertogo.com/api/bookings/${u}`,{headers:{Authorization:`Bearer ${t}`}});N(e.data.bookings||[]),v(e.data.user||null),T(null)}catch(s){T((null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to fetch booking history.")}finally{b(!1)}})()}),[u]),p)return t.jsx(s,{className:"flex justify-center items-center h-screen",children:t.jsx(r,{})});if(y)return t.jsx(s,{className:"flex justify-center items-center h-screen",children:t.jsx(i,{color:"error",variant:"h6",children:y})});const S=f.map((e=>{var a,t;return{id:e._id,vanName:(null==(t=null==(a=null==e?void 0:e.vanId)?void 0:a.name)?void 0:t[g])||"Van Name",startDate:e.startDate,endDate:e.endDate,startTime:new Date(e.startTime).toLocaleTimeString(),endTime:new Date(e.endTime).toLocaleTimeString(),totalPrice:e.totalPrice,status:e.status.charAt(0).toUpperCase()+e.status.slice(1)}}));return t.jsxs("div",{className:"container mx-auto p-6",children:[j&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs(i,{variant:"h4",className:"text-center font-bold text-gray-700 mb-6",children:["Booking History ",j.firstName," ",j.lastName]}),t.jsx(i,{variant:"body2",sx:{fontSize:"1.2em",marginTop:"1rem"},children:j.email}),t.jsx(i,{variant:"body1",sx:{fontSize:"1.1em",marginTop:"0.3rem"},children:j.phone})]}),t.jsx(s,{sx:{display:{xs:"block",md:"none"}},children:0===f.length?t.jsx(i,{variant:"body1",className:"text-center text-gray-500",children:"No bookings found."}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:f.map((e=>{var a,r;return t.jsx(n,{className:"shadow-lg border border-gray-200 rounded-lg",children:t.jsxs(l,{children:[t.jsxs(s,{className:"flex items-center gap-2 mb-2",children:[t.jsx(d,{className:"text-blue-500"}),t.jsx(i,{variant:"h6",className:"font-bold",children:(null==(r=null==(a=null==e?void 0:e.vanId)?void 0:a.name)?void 0:r[g])||"Van Name"})]}),t.jsxs(s,{className:"flex items-center gap-2 mb-1",children:[t.jsx(o,{className:"text-green-500"}),t.jsxs(i,{variant:"body2",className:"text-gray-600",children:[e.startDate," to ",e.endDate]})]}),t.jsxs(s,{className:"flex items-center gap-2 mb-1",children:[t.jsx(c,{className:"text-yellow-500"}),t.jsxs(i,{variant:"body2",className:"text-gray-600",children:[new Date(e.startTime).toLocaleTimeString()," -"," ",new Date(e.endTime).toLocaleTimeString()]})]}),t.jsxs(s,{className:"flex items-center gap-2 mb-2",children:[t.jsx(m,{className:"text-green-500"}),t.jsxs(i,{variant:"body2",className:"text-gray-600",children:["Total Price: $",e.totalPrice]})]}),t.jsxs(i,{variant:"caption",className:"font-bold "+("completed"===e.status?"text-green-600":"pending"===e.status?"text-yellow-600":"text-red-600"),children:["Status:"," ",e.status.charAt(0).toUpperCase()+e.status.slice(1)]})]})},e._id)}))})}),t.jsx(s,{sx:{display:{xs:"none",md:"block"},height:500,mt:4},children:t.jsx(x,{rows:S,columns:[{field:"vanName",headerName:"Van Name",width:200},{field:"startDate",headerName:"Start Date",width:150},{field:"endDate",headerName:"End Date",width:150},{field:"startTime",headerName:"Start Time",width:150},{field:"endTime",headerName:"End Time",width:150},{field:"totalPrice",headerName:"Total Price (CHF)",width:150},{field:"status",headerName:"Status",width:150}],pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0,sx:{"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.main",color:"#000"},"& .MuiDataGrid-cell":{fontSize:"16px"}}})})]})};export{u as default};
