import{r as l,j as s,bq as B,k as y,m as g,a9 as D,B as O,bj as M,f as $}from"./vendor-C1EOYKAv.js";import{a as E}from"./index-CF2yu6qE.js";const N=({open:f,handleClose:j,otpLength:c=4,onVerify:w,onResendOtp:v})=>{const[a,i]=l.useState(Array(c).fill("")),u=l.useRef([]),[p,d]=l.useState(!1),[C,h]=l.useState(600),o=l.useRef(null),{translations:m}=E(),x=()=>{d(!1),h(600),o.current&&clearInterval(o.current),o.current=setInterval(()=>{h(r=>r<=1?(clearInterval(o.current),d(!0),0):r-1)},1e3)},T=r=>{const e=Math.floor(r/60),t=r%60;return`${e}:${t<10?"0":""}${t}`},b=(r,e)=>{const{value:t}=r.target;if(/^\d$/.test(t)){const n=[...a];n[e]=t,i(n),e<c-1&&u.current[e+1]?.focus()}else if(t===""){const n=[...a];n[e]="",i(n)}},P=(r,e)=>{if(r.key==="Backspace")if(a[e]){const t=[...a];t[e]="",i(t)}else e>0&&u.current[e-1]?.focus()},k=r=>{r.preventDefault();const e=r.clipboardData.getData("Text").slice(0,c);if(/^\d+$/.test(e)){const t=Array.from(e).slice(0,c);i(t);const n=t.length-1;u.current[n]?.focus()}},I=async()=>{const r=a.join("");if(r.length<c||a.some(e=>e==="")){$.error("Please complete all OTP fields.");return}try{await w(r)}catch(e){console.error("Invalid OTP:",e)}},R=()=>{v(),x()};return l.useEffect(()=>(f&&x(),()=>{o.current&&clearInterval(o.current)}),[f]),s.jsx(B,{open:f,onClose:j,"aria-labelledby":"login-modal",children:s.jsxs(y,{className:"flex relative flex-col items-center p-10  bg-white rounded-lg shadow-lg max-w-2xl w-full",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[s.jsxs(g,{align:"center",variant:"h6",gutterBottom:!0,children:["`",m.loginModalTitle,"`"]}),s.jsx(y,{display:"flex",justifyContent:"center",gap:1,mb:2,children:a.map((r,e)=>s.jsx(D,{inputRef:t=>u.current[e]=t,type:"text",variant:"outlined",value:r,onChange:t=>b(t,e),onKeyDown:t=>P(t,e),onPaste:e===0?k:void 0,inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}}},e))}),s.jsx(g,{align:"center",variant:"body2",color:"textSecondary",children:p?"OTP has expired. Please resend.":`Time remaining: ${T(C)}`}),p&&s.jsx(O,{onClick:R,variant:"text",color:"secondary",className:"mt-2",children:m.resentCode}),s.jsx(O,{onClick:I,variant:"contained",color:"primary",className:"w-full mt-4",startIcon:s.jsx(M,{}),children:m.submitOtp})]})})};export{N as O};
