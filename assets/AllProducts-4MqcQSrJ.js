import{r as e,a,ci as r,j as i,P as s,t as l,a4 as t,aQ as d,aR as n,g as o,bZ as c,bf as m,f as u,a2 as h,b as x,I as p,cC as f,c3 as j,aV as g}from"./vendor-Zgq9WbFI.js";const b="https://rubertogo.com",v=()=>{const[v,y]=e.useState([]),[N,w]=e.useState(!1),[C,P]=e.useState(""),[S,k]=e.useState(!1),[W,_]=e.useState(null),{lang:$}=a(),E=r("(max-width: 768px)"),F=async e=>{if(window.confirm("Are you sure you want to delete this product?"))try{await x.delete(`${b}/api/products/${e}`),y(v.filter((a=>a._id!==e)))}catch(a){console.error("Error deleting product:",a),alert("Failed to delete product.")}},A=e=>{_(e),k(!0)},z=()=>{_(null),k(!1)};e.useEffect((()=>{(async()=>{w(!0),P("");try{const e=await x.get(`${b}/api/products`);y(e.data)}catch(e){P("Failed to fetch products. Please try again later.")}finally{w(!1)}})()}),[]);const D=[{field:"name",headerName:"Product Name",flex:1,minWidth:150},{field:"description",headerName:"Description",flex:2,minWidth:200},{field:"price",headerName:"Price",flex:1,minWidth:100,renderCell:e=>`${e.value} CHF`},{field:"actions",headerName:"Actions",flex:1,minWidth:150,sortable:!1,renderCell:e=>i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(p,{color:"primary",onClick:()=>A(e.row),children:i.jsx(f,{})}),i.jsx(p,{color:"error",onClick:()=>F(e.row._id),children:i.jsx(j,{})})]})}];return i.jsxs("div",{className:"p-4 bg-white min-h-screen",children:[C&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:C}),i.jsxs("div",{className:"bg-white rounded-lg ",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-4 flex gap-4 items-center",children:[" ",i.jsx(s,{className:"text-gray-400 text-4xl"})," All Products"]}),i.jsx(l,{to:`/${$}/admin/add-product`,children:i.jsx(t,{variant:"contained",color:"primary",children:"Add Product"})})]}),E?i.jsx("div",{className:"grid grid-cols-1 gap-4",children:v.map((e=>i.jsx(d,{className:"shadow-lg",children:i.jsxs(n,{children:[i.jsx(o,{variant:"h6",className:"font-bold",children:e.name}),i.jsx(o,{variant:"body2",className:"text-gray-600",children:e.description}),i.jsxs(o,{variant:"body1",className:"text-blue-600 mt-2",children:[e.price," CHF"]}),i.jsxs("div",{className:"flex justify-end mt-2 space-x-2",children:[i.jsx(t,{size:"small",variant:"outlined",color:"primary",onClick:()=>A(e),children:"Edit"}),i.jsx(t,{size:"small",variant:"outlined",color:"error",onClick:()=>F(e._id),children:"Delete"})]})]})},e._id)))}):i.jsx("div",{style:{height:500,width:"100%"},children:i.jsx(c,{rows:v,columns:D,getRowId:e=>e._id,loading:N,pageSize:10,rowsPerPageOptions:[5,10,20],checkboxSelection:!1,disableSelectionOnClick:!0})})]}),i.jsx(m,{open:S,onClose:z,children:i.jsxs(u,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:4,width:"90%",maxWidth:400,borderRadius:2},children:[i.jsx(o,{variant:"h6",className:"font-bold mb-4",children:"Edit Product"}),i.jsx(h,{label:"Product Name",fullWidth:!0,margin:"normal",value:(null==W?void 0:W.name)||"",onChange:e=>_({...W,name:e.target.value})}),i.jsx(h,{label:"Description",fullWidth:!0,margin:"normal",multiline:!0,rows:3,value:(null==W?void 0:W.description)||"",onChange:e=>_({...W,description:e.target.value})}),i.jsx(h,{label:"Price",fullWidth:!0,margin:"normal",type:"number",value:(null==W?void 0:W.price)||"",onChange:e=>_({...W,price:e.target.value})}),i.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[i.jsx(t,{onClick:z,variant:"outlined",color:"error",children:"Cancel"}),i.jsx(t,{onClick:async()=>{if(W.name&&W.description&&W.price)try{await x.put(`${b}/api/products/${W._id}`,W),y((e=>e.map((e=>e._id===W._id?W:e)))),g.success("Product Updated Successfully"),z()}catch(e){console.error("Error updating product:",e),alert("Failed to update product.")}else alert("Please fill out all fields.")},variant:"contained",color:"primary",children:"Save Changes"})]})]})})]})};export{v as default};
