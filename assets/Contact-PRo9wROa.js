import{r as e,j as a,f as s,a$ as r,g as t,Q as l,p as i,Z as c,cF as n,L as o,D as d,a2 as m,a4 as h,b as x,aV as y}from"./vendor-Zgq9WbFI.js";const u=()=>{const[u,g]=e.useState([]),[j,p]=e.useState(null),[f,b]=e.useState(""),[v,N]=e.useState(!0),[w,S]=e.useState(null),F=localStorage.getItem("accessToken");e.useEffect((()=>{(async()=>{try{const e=await x.get("http://localhost:3000/api/contact/messages",{headers:{Authorization:`Bearer ${F}`}});Array.isArray(e.data)?(g(e.data),p(e.data[0])):S("Invalid data format from server.")}catch(e){S("Failed to fetch messages. Please try again later.")}finally{N(!1)}})()}),[]);return v?a.jsx(s,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsx(r,{})}):w?a.jsx(s,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsx(t,{variant:"h6",color:"error",children:w})}):a.jsxs(s,{className:"min-h-screen bg-gray-100 p-4",sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2},children:[a.jsx(l,{}),a.jsxs(s,{className:"bg-white shadow-lg rounded-lg p-4",sx:{width:{xs:"100%",md:"25%"},maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:[a.jsx(t,{variant:"h6",className:"mb-4 text-gray-800",children:"Inbox"}),a.jsx(i,{children:u.map((e=>a.jsx(c,{disablePadding:!0,onClick:()=>p(e),selected:(null==j?void 0:j._id)===e._id,children:a.jsx(n,{children:a.jsx(o,{primary:e.subject,secondary:`From: ${e.name}`})})},e._id)))})]}),a.jsx(s,{className:"bg-white shadow-lg rounded-lg p-4 flex flex-col",sx:{flex:1,maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:j?a.jsxs(a.Fragment,{children:[a.jsx(t,{variant:"h5",className:"mb-2",children:j.subject}),a.jsxs(t,{variant:"subtitle1",className:"mb-4 text-gray-600",children:["From: ",j.name," (",j.email,")"]}),a.jsx(d,{className:"mb-4"}),a.jsx(t,{variant:"body1",className:"mb-4",children:j.message}),a.jsx(d,{className:"mb-4"}),j.reply&&a.jsxs(s,{className:"mb-4",children:[a.jsx(t,{variant:"subtitle2",className:"text-gray-800",children:"Your Reply:"}),a.jsx(t,{variant:"body1",children:j.reply})]}),a.jsx(m,{fullWidth:!0,multiline:!0,rows:4,placeholder:"Write your reply...",value:f,onChange:e=>b(e.target.value),className:"mb-4"}),a.jsxs(s,{className:"flex justify-end space-x-4",children:[a.jsx(h,{variant:"outlined",color:"secondary",onClick:()=>b(""),children:"Clear"}),a.jsx(h,{variant:"contained",color:"primary",onClick:async()=>{if(j)try{await x.post(`http://localhost:3000/api/contact/messages/${j._id}/reply`,{reply:f},{headers:{Authorization:`Bearer ${F}`}}),p((e=>({...e,reply:f}))),y.success("Reply sent successfully!"),b("")}catch(e){y.error("Failed to send reply. Please try again.")}},disabled:!f.trim(),children:"Send Reply"})]})]}):a.jsx(t,{variant:"h6",className:"text-gray-500",children:"Select a message to view its details."})})]})};export{u as default};
