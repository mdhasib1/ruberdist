import{r as e,bh as a,u as s,a as t,j as l,aQ as i,g as n,aE as r,a2 as o,af as c,I as d,bk as m,bq as h,br as u,k as x,a4 as g,c4 as j,aV as p,b,c3 as v,bY as y,bm as f,bg as N}from"./vendor-Zgq9WbFI.js";import{P as k}from"./PackageModal-BuemN_fU.js";const P="https://rubertogo.com",w=["places"],C=()=>{const[v,y]=e.useState({name:{en:"",fr:"",it:"",de:""},description:{en:"",fr:"",it:"",de:""},images:[],plateNumber:"",dailyPricing:{Monday:{pricePerHour:"",kilometers:"",extraPerKm:""},Tuesday:{pricePerHour:"",kilometers:"",extraPerKm:""},Wednesday:{pricePerHour:"",kilometers:"",extraPerKm:""},Thursday:{pricePerHour:"",kilometers:"",extraPerKm:""},Friday:{pricePerHour:"",kilometers:"",extraPerKm:""},Saturday:{pricePerHour:"",kilometers:"",extraPerKm:""},Sunday:{pricePerHour:"",kilometers:"",extraPerKm:""}},minimumHours:"",unlimitedKilometersPrice:"",allowPackage:!1,packagePrices:{},externalDimensions:{length:"",width:"",height:""},internalDimensions:{length:"",width:"",height:""},weight:{empty:"",maxLoad:""},location:{address:"",latitude:"",longitude:""},fuelType:"Petrol",transmissionType:"Manual",optionalFeatures:{roofRack:!1,airConditioning:!1,towingHook:!1,parkingSensors:!1},contractImages:[],trackingDevice:{type:"NoDevice",customName:""},restrictedBookingHours:{Monday:{start:"",end:""},Tuesday:{start:"",end:""},Wednesday:{start:"",end:""},Thursday:{start:"",end:""},Friday:{start:"",end:""},Saturday:{start:"",end:""},Sunday:{start:"",end:""}}}),{isLoaded:f}=a({googleMapsApiKey:"AIzaSyCJgOiSJeJlRdoFK_jTK-mNug5b22XPRn4",libraries:w}),[N,C]=e.useState("it"),[z,K]=e.useState("it"),E=s(),[L,M]=e.useState(!1),[q,F]=e.useState(!1),[$,B]=e.useState(!1),[O,R]=e.useState(!1),[U,V]=e.useState(!1),J=localStorage.getItem("accessToken"),[_,G]=e.useState(!1),[Q,X]=e.useState({}),[Y,Z]=e.useState(!1),{lang:ee}=t(),ae=async(e,a,s=null)=>{const t=await Promise.all(e.map((async e=>{const a=await(async e=>{const a=new FormData;a.append("file",e);try{return(await b.post(`${P}/api/upload`,a,{headers:{"Content-Type":"multipart/form-data"}})).data.imageURL}catch(s){return console.error("Error uploading file:",s),null}})(e);return a})));if("contractImages"===a&&null!==s){const e=[...v.contractImages];e[s]={...e[s],image:t[0]},y({...v,contractImages:e})}else y((e=>({...e,images:[...e.images,...t]})))},se=e=>{const{name:a,value:s}=e.target;y({...v,[a]:s})},te=(e,a,s)=>{y((t=>{const l={...t[e],[a]:s};return"it"===a&&(l.en=s,l.fr=s,l.de=s),{...t,[e]:l}}))},le=(e,a,s)=>{y((t=>({...t,[e]:{...t[e],[a]:s}})))},ie=[{value:"en",label:"English"},{value:"fr",label:"French"},{value:"it",label:"Italian"},{value:"de",label:"German"}],ne=(e,a,s)=>{y((t=>{const l={...t.dailyPricing};return l[e][a]=s,!Y||"Monday"!==e||"kilometers"!==a&&"extraPerKm"!==a||Object.keys(l).forEach((e=>{"Monday"!==e&&(l[e][a]=s)})),{...t,dailyPricing:l}}))},re=(e,a)=>{y((s=>({...s,trackingDevice:{...s.trackingDevice,[e]:a}})))},oe=(e,a,s)=>{y((t=>({...t,restrictedBookingHours:{...t.restrictedBookingHours,[e]:{...t.restrictedBookingHours[e],[a]:s}}})))};return l.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-r from-gray-100 to-gray-200",children:l.jsxs(i,{className:"shadow-2xl rounded-lg container",children:[l.jsx(n,{variant:"h4",style:{marginBottom:"1rem"},className:"p-3 text-white text-center bg-blue-600 font-bold rounded",children:"Add New Van"}),l.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),v.plateNumber)try{201===(await b.post(`${P}/api/vans`,v,{headers:{Authorization:`Bearer ${J}`}})).status&&(E(`/:${ee}/admin/vans`),p.success("Van added successfully!"))}catch(a){a.response&&400===a.response.status&&a.response.data.message?p.error(a.response.data.message):p.error("An error occurred while adding the van."),console.error("Error submitting form:",a)}else p.error("Plate Number are required.")},className:"space-y-4 sm:p-12 p-4 border bg-white mt-4",children:l.jsxs(r,{container:!0,spacing:3,children:[l.jsx(S,{label:"Van Name",field:"name",selectedLang:N,setSelectedLang:C,value:v.name[N],onChange:te,languageOptions:ie}),l.jsx(S,{label:"Description",field:"description",selectedLang:z,setSelectedLang:K,value:v.description[z],onChange:te,languageOptions:ie,multiline:!0,rows:3}),l.jsx(r,{item:!0,xs:12,children:l.jsx(o,{fullWidth:!0,label:"Plate Number",name:"plateNumber",value:v.plateNumber,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),l.jsxs(r,{item:!0,xs:12,children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Daily Pricing"}),l.jsx(c,{title:"Set daily pricing details for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),l.jsx(h,{control:l.jsx(u,{checked:Y,onChange:e=>(e=>{if(Z(e),e){const e=v.dailyPricing.Monday;y((a=>({...a,dailyPricing:Object.keys(a.dailyPricing).reduce(((s,t)=>(s[t]={...a.dailyPricing[t],kilometers:e.kilometers,extraPerKm:e.extraPerKm},s)),{})})))}})(e.target.checked)}),label:l.jsxs("div",{className:"flex items-center",children:["Apply Kilometers and Extra Per Km to All Days",l.jsx(c,{title:"Enable this to apply Monday's values to all other days.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})}),Object.keys(v.dailyPricing).map((e=>l.jsxs(r,{container:!0,spacing:2,className:"mb-4",children:[l.jsx(r,{item:!0,xs:12,sm:4,children:l.jsx(o,{fullWidth:!0,label:`${e} Price Per Hour`,type:"number",value:v.dailyPricing[e].pricePerHour,onChange:a=>ne(e,"pricePerHour",a.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:12,sm:4,children:l.jsx(o,{fullWidth:!0,label:`${e} Kilometers`,type:"number",value:v.dailyPricing[e].kilometers,onChange:a=>ne(e,"kilometers",a.target.value),variant:"outlined",className:"bg-white rounded-lg",disabled:Y&&"Monday"!==e})}),l.jsx(r,{item:!0,xs:12,sm:4,children:l.jsx(o,{fullWidth:!0,label:`${e} Extra Per Km`,type:"number",value:v.dailyPricing[e].extraPerKm,onChange:a=>ne(e,"extraPerKm",a.target.value),variant:"outlined",className:"bg-white rounded-lg",disabled:Y&&"Monday"!==e})})]},e)))]}),l.jsx(r,{item:!0,xs:6,sm:4,children:l.jsx(h,{control:l.jsx(u,{checked:U,onChange:e=>V(e.target.checked)}),label:l.jsxs("div",{className:"flex items-center",children:["Set Pre Authorization Amount",l.jsx(c,{title:"Enable this to set a pre authorization amount for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})})}),U&&l.jsx(r,{item:!0,xs:6,sm:6,children:l.jsx(o,{fullWidth:!0,label:"Pre Authorization Amount",name:"preAuthorizationAmount",value:v.preAuthorizationAmount,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:6,sm:4,children:l.jsx(h,{control:l.jsx(u,{checked:O,onChange:e=>R(e.target.checked)}),label:l.jsxs("div",{className:"flex items-center",children:["Set Minimum Hours",l.jsx(c,{title:"Enable this to set a minimum number of hours for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})})}),O&&l.jsx(r,{item:!0,xs:6,sm:6,children:l.jsx(o,{fullWidth:!0,label:"Minimum Hours",name:"minimumHours",value:v.minimumHours,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:6,sm:4,children:l.jsx(h,{control:l.jsx(u,{checked:q,onChange:e=>F(e.target.checked)}),label:l.jsxs("div",{className:"flex items-center",children:["Set Unlimited Kilometers",l.jsx(c,{title:"Enable this to allow unlimited kilometers for this van. A price must be specified.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})})}),q&&l.jsx(r,{item:!0,xs:6,sm:6,children:l.jsx(o,{fullWidth:!0,label:"Unlimited Kilometers Price",name:"unlimitedKilometersPrice",value:v.unlimitedKilometersPrice,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:6,sm:4,children:l.jsx(h,{control:l.jsx(u,{checked:$,onChange:e=>{const a=e.target.checked;B(a),a&&G(!0)}}),label:l.jsxs("div",{className:"flex items-center",children:["Allow Package",l.jsx(c,{title:"Enable this to allow users to book packages for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})})}),l.jsx(r,{item:!0,xs:12,sm:4,children:l.jsx(h,{control:l.jsx(u,{checked:L,onChange:e=>M(e.target.checked)}),label:l.jsxs("div",{className:"flex items-center",children:["Set Restricted Booking Hours",l.jsx(c,{title:"Enable this to restrict specific booking hours for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]})})}),$&&l.jsx(k,{isOpen:_,onClose:()=>{G(!1)},onSave:e=>{X(e),y((a=>({...a,packagePrices:e,allowPackage:!0})))},initialPrices:Q}),L&&l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"h6",sx:{marginBottom:"10px"},className:"mb-4",children:"Weekly Restricted Booking Hours"}),Object.keys(v.restrictedBookingHours).map((e=>l.jsxs(r,{container:!0,spacing:2,className:"mb-3",children:[l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{select:!0,fullWidth:!0,label:`${e} Start Time`,value:v.restrictedBookingHours[e].start,onChange:a=>oe(e,"start",a.target.value),variant:"outlined",className:"bg-white rounded-lg",children:Array.from({length:24},((e,a)=>{const s=a.toString().padStart(2,"0")+":00";return l.jsx(x,{value:s,children:s},s)}))})}),l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{select:!0,fullWidth:!0,label:`${e} End Time`,value:v.restrictedBookingHours[e].end,onChange:a=>oe(e,"end",a.target.value),variant:"outlined",className:"bg-white rounded-lg",children:Array.from({length:24},((e,a)=>{const s=a.toString().padStart(2,"0")+":00";return l.jsx(x,{value:s,children:s},s)}))})})]},e)))]}),l.jsx(D,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Upload Van Images",l.jsx(c,{title:"Upload images of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),images:v.images,onDrop:e=>ae(e,"images")}),l.jsx(T,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Upload Damage Images",l.jsx(c,{title:"Upload images of the damage.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),contractImages:v.contractImages,onDrop:ae,onAdd:()=>{y((e=>({...e,contractImages:[...e.contractImages,{damageType:"",description:"",image:""}]})))},onRemove:e=>{const a=v.contractImages.filter(((a,s)=>s!==e));y({...v,contractImages:a})},onChange:(e,a,s)=>{const t=[...v.contractImages];t[e]={...t[e],[a]:s},y({...v,contractImages:t})}}),l.jsx(W,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Location",l.jsx(c,{title:"Select the location of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),location:v.location,onChange:le,isLoaded:f}),l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{select:!0,fullWidth:!0,label:l.jsxs("div",{className:"flex items-center",children:["Fuel Type",l.jsx(c,{title:"Select the fuel type of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),name:"fuelType",value:v.fuelType,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg",children:["Petrol","Diesel","Electric","Hybrid"].map((e=>l.jsx(x,{value:e,children:e},e)))})}),l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{select:!0,fullWidth:!0,label:l.jsxs("div",{className:"flex items-center",children:["Transmission Type",l.jsx(c,{title:"Select the transmission type of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),name:"transmissionType",value:v.transmissionType,onChange:se,variant:"outlined",required:!0,className:"bg-white rounded-lg",children:["Manual","Automatic"].map((e=>l.jsx(x,{value:e,children:e},e)))})}),l.jsx(A,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Optional Features",l.jsx(c,{title:"Select the optional features of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),optionalFeatures:v.optionalFeatures,onChange:e=>{y((a=>({...a,optionalFeatures:{...a.optionalFeatures,[e]:!a.optionalFeatures[e]}})))}}),l.jsx(H,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["External Dimensions (L × W × H)",l.jsx(c,{title:"Enter the external dimensions of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),dimensions:v.externalDimensions,onChange:le,dimensionType:"externalDimensions"}),l.jsx(H,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Internal Dimensions (L × W × H)",l.jsx(c,{title:"Enter the internal dimensions of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),dimensions:v.internalDimensions,onChange:le,dimensionType:"internalDimensions"}),l.jsx(I,{label:l.jsxs("div",{className:"flex items-center mb-5",children:["Weight (Empty × Max Load)",l.jsx(c,{title:"Enter the load capacity of the van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),weight:v.weight,onChange:le}),l.jsxs(r,{item:!0,xs:12,children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Traking Device"}),l.jsx(c,{title:" Set the tracking device details for this van.",children:l.jsx(d,{size:"small",className:"ml-1",children:l.jsx(m,{})})})]}),l.jsxs(r,{container:!0,spacing:2,children:[l.jsx(r,{item:!0,xs:12,children:l.jsxs(o,{select:!0,fullWidth:!0,label:"Tracking Device Type",value:v.trackingDevice.type,onChange:e=>re("type",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg",children:[l.jsx(x,{value:"NoDevice",children:"NoDevice"}),l.jsx(x,{value:"fleet2track",children:"Fleet2Track"}),l.jsx(x,{value:"other",children:"Other"})]})}),"other"===v.trackingDevice.type&&l.jsx(r,{item:!0,xs:12,children:l.jsx(o,{fullWidth:!0,label:"Custom Tracking Device Name",value:v.trackingDevice.customName,onChange:e=>re("customName",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})})]})]}),l.jsx(r,{item:!0,xs:12,children:l.jsxs(g,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,className:"flex items-center justify-center text-lg font-semibold shadow-md hover:shadow-lg transition-shadow",children:[l.jsx(j,{className:"mr-2"}),"Add Van"]})})]})})]})})},S=({label:e,field:a,value:s,onChange:t,multiline:i=!1,rows:n=1})=>l.jsx(r,{item:!0,xs:12,children:l.jsx(o,{fullWidth:!0,label:e,name:a,placeholder:`Enter ${e}`,value:s,onChange:e=>t(a,"it",e.target.value),variant:"outlined",required:!0,multiline:i,rows:n,className:"bg-white rounded-lg"})}),D=({label:e,images:a,onDrop:s})=>l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600 mb-2",children:e}),l.jsxs(r,{container:!0,spacing:2,children:[a.map(((e,a)=>l.jsx(r,{item:!0,xs:6,sm:4,md:3,className:"relative",children:l.jsx("img",{src:e,alt:`Van Image ${a+1}`,className:"w-full h-48 object-cover rounded-lg shadow-md"})},a))),l.jsx(r,{item:!0,xs:6,sm:4,md:3,children:l.jsx(z,{onDrop:s})})]})]}),T=({label:e,contractImages:a,onDrop:s,onAdd:t,onRemove:i,onChange:c})=>l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600 mb-2",children:e}),a.map(((e,a)=>l.jsxs(r,{container:!0,spacing:2,alignItems:"center",className:"mb-4",children:[l.jsx(r,{item:!0,xs:12,sm:3,children:l.jsx(o,{fullWidth:!0,label:"Damage Type",value:e.damageType,onChange:e=>c(a,"damageType",e.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:12,sm:5,children:l.jsx(o,{fullWidth:!0,label:"Description",value:e.description,onChange:e=>c(a,"description",e.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:6,sm:3,children:e.image?l.jsx("img",{src:e.image,alt:"Contract",className:"w-full h-48 object-cover rounded-lg shadow-md"}):l.jsx(z,{onDrop:e=>s(e,"contractImages",a)})}),l.jsx(r,{item:!0,xs:1,sm:1,children:l.jsx(d,{color:"secondary",onClick:()=>i(a),children:l.jsx(v,{})})})]},a))),l.jsx(g,{variant:"outlined",color:"primary",onClick:t,startIcon:l.jsx(y,{}),className:"mt-2",children:"Add damage image"})]}),W=({location:a,onChange:s,isLoaded:t,label:i})=>{const[c,d]=e.useState(null);return l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:i}),t?l.jsx(f,{onLoad:e=>{d(e)},onPlaceChanged:()=>{if(c){const e=c.getPlace(),a=e.formatted_address,t=e.geometry.location.lat(),l=e.geometry.location.lng();s("location","address",a),s("location","latitude",t),s("location","longitude",l)}},children:l.jsx(o,{fullWidth:!0,label:"Address",name:"location.address",value:a.address,onChange:e=>s("location","address",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg mb-3",style:{marginBottom:"1rem"}})}):l.jsx(o,{fullWidth:!0,label:"Address",name:"location.address",value:a.address,onChange:e=>s("location","address",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg mb-3"}),l.jsxs(r,{container:!0,spacing:2,children:[l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{fullWidth:!0,label:"Latitude",name:"location.latitude",type:"number",value:a.latitude,onChange:e=>s("location","latitude",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{fullWidth:!0,label:"Longitude",name:"location.longitude",type:"number",value:a.longitude,onChange:e=>s("location","longitude",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})})]})]})},A=({optionalFeatures:e,onChange:a,label:s})=>l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:s}),Object.keys(e).map((s=>l.jsx(h,{control:l.jsx(u,{checked:e[s],onChange:()=>a(s),color:"primary"}),label:s.charAt(0).toUpperCase()+s.slice(1).replace(/([A-Z])/g," $1")},s)))]}),H=({label:e,dimensions:a,onChange:s,dimensionType:t})=>l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:e}),l.jsx(r,{container:!0,spacing:1,children:["length","width","height"].map((e=>l.jsx(r,{item:!0,xs:4,children:l.jsx(o,{fullWidth:!0,label:e.charAt(0).toUpperCase()+e.slice(1),name:`${t}.${e}`,value:a[e],onChange:a=>s(t,e,a.target.value),variant:"outlined",className:"bg-white rounded-lg"})},e)))})]}),I=({weight:e,onChange:a,label:s})=>l.jsxs(r,{item:!0,xs:12,children:[l.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:s}),l.jsx(r,{container:!0,spacing:2,children:["empty","maxLoad"].map((s=>l.jsx(r,{item:!0,xs:6,children:l.jsx(o,{fullWidth:!0,label:"empty"===s?"Empty Weight":"Max Load",name:`weight.${s}`,value:e[s],onChange:e=>a("weight",s,e.target.value),variant:"outlined",className:"bg-white rounded-lg"})},s)))})]}),z=({onDrop:e})=>{const{getRootProps:a,getInputProps:s}=N({onDrop:e,accept:"image/*",multiple:!1});return l.jsxs(i,{...a(),className:"border-dashed border-2 border-gray-400 rounded-lg h-48 w-full flex items-center justify-center cursor-pointer hover:border-gray-500 transition-all shadow-sm hover:shadow-md",children:[l.jsx("input",{...s()}),l.jsx(y,{className:"text-gray-400 text-3xl"})]})};export{C as default};
