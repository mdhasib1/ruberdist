import{a as B,r,u as R,j as e,m as f,a9 as b,aU as V,aV as M,B as x,bJ as v,cs as W,bZ as $,b as y,f as j}from"./vendor-Cfy4xQX5.js";import{u as F}from"./index-BrCGVfUY.js";const S="https://www.rubertogo.com",z=()=>{const{lang:w}=B(),{login:O}=F(),[m,P]=r.useState(""),[o,d]=r.useState(["","","",""]),[p,T]=r.useState(1),[N,i]=r.useState(""),[A,h]=r.useState(!1),[l,c]=r.useState(!1),C=R(),u=r.useRef([]),E=a=>{P(a.target.value)},D=(a,t)=>{const{value:s}=a.target;if(s.length===1){const n=[...o];n[t]=s,d(n),t<o.length-1&&u.current[t+1].focus()}else if(s===""){const n=[...o];n[t]="",d(n),t>0&&u.current[t-1].focus()}},I=a=>{const t=a.clipboardData.getData("Text").slice(0,4);if(t.length===4){const s=t.split("");d(s),u.current[3].focus()}},L=async a=>{a.preventDefault(),i(""),c(!0);try{const t=await y.post(`${S}/api/login`,{email:m});j.success("OTP sent to your email."),T(2)}catch{i("User not found with the given email."),h(!0)}finally{c(!1)}},k=async a=>{a.preventDefault();const t=o.join("");i(""),c(!0);try{const s=await y.post(`${S}/api/verify-otp`,{email:m,otp:t}),{accessToken:n}=s.data;O(n),j.success("Login successful!"),C(`/${w}/admin/overview`)}catch{i("Invalid or expired OTP."),h(!0)}finally{c(!1)}},g=()=>{h(!1)};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),e.jsx(f,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:p===1?"Admin Sign In":"Verify OTP"}),p===1&&e.jsxs("form",{onSubmit:L,children:[e.jsx("div",{className:"mb-4",children:e.jsx(b,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:m,onChange:E,InputProps:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(M,{className:"text-gray-400"})})}})}),e.jsx(x,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Sending OTP...":"Send OTP"})]}),p===2&&e.jsxs("form",{onSubmit:k,children:[e.jsx(f,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),e.jsx(v,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",sx:{textAlign:"center",marginTop:"1rem"},children:o.map((a,t)=>e.jsx(v,{item:!0,children:e.jsx(b,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:a,onChange:s=>D(s,t),onPaste:t===0?I:void 0,inputRef:s=>u.current[t]=s,required:!0})},t))}),e.jsx(x,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Verifying...":"Verify OTP"})]}),e.jsx(W,{open:A,autoHideDuration:6e3,onClose:g,children:e.jsx($,{onClose:g,severity:"error",children:N})})]})})};export{z as default};
