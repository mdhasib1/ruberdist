import{r as t,u as p,a as f,cR as x,j as e,aw as c,cS as w,cT as j,x as M,cU as C}from"./vendor-B56vuqgA.js";import{u as b}from"./useVanStore-a-36WA35.js";const d="AIzaSyCJgOiSJeJlRdoFK_jTK-mNug5b22XPRn4";function A(){const{vans:a,loading:r,fetchVans:s}=b(),[o,u]=t.useState(!1),n=p(),{lang:i}=f(),g=t.useMemo(()=>{if(a.length>0){const l=a[Math.floor(Math.random()*a.length)];return{lat:l?.location?.latitude??46.0069,lng:l?.location?.longitude??8.9511}}return{lat:46.0069,lng:8.9511}},[a]);t.useEffect(()=>{new x({apiKey:d,version:"weekly",libraries:["places"]}).load().then(()=>u(!0)).catch(h=>console.error("Google Maps API failed to load:",h))},[]),t.useEffect(()=>{a.length===0&&s()},[s,a.length]);const m=t.useCallback(l=>n(`/${i}/vans`,{state:{selectedVan:l}}),[n,i]);return o?e.jsx("div",{className:"h-[60vh] max-w-full bg-white m-auto sm:p-10 relative",children:e.jsx(w,{apiKey:d,libraries:["places"],children:r?e.jsx(c,{variant:"rectangular",height:"100%"}):e.jsx(j,{defaultCenter:g,mapId:"c4d3f0df86a8b9",defaultZoom:16,options:{zoomControl:!0,scrollwheel:!0,gestureHandling:"auto",mapTypeControl:!1,fullscreenControl:!0,streetViewControl:!1,disableDoubleClickZoom:!1,mapTypeId:"roadmap"},children:e.jsx(k,{vans:a,onMarkerClick:m})})})}):e.jsx("div",{className:"h-[60vh] max-w-full bg-white m-auto sm:p-10 relative",children:e.jsx(c,{variant:"rectangular",height:"100%"})})}const k=M.memo(({vans:a,onMarkerClick:r})=>{if(!window.google||!window.google.maps)return console.warn("Google Maps API is not available."),null;const s=t.useMemo(()=>Array.isArray(a)?a.filter(o=>o?.location?.latitude&&o?.location?.longitude):[],[a]);return e.jsx(e.Fragment,{children:s.map(o=>e.jsx(C,{position:new google.maps.LatLng(o.location.latitude,o.location.longitude),onClick:()=>r(o),children:e.jsx("span",{className:"text-xl text-white rounded-full w-20 h-20 p-2 cursor-pointer transition-all duration-300 hover:scale-110",children:e.jsx("img",{src:o?.images?.[0]||"/placeholder.jpg",alt:o?.name?.en||"Van",className:"w-20 h-20 object-cover rounded-full shadow-md"})})},o._id))})});export{A as default};
