import{r as n,h as F,f as I,j as e,Q as z,U as S,k as O}from"./index-DLpikvjc.js";import{B as w}from"./Box-B-GTZaan.js";import{T as C}from"./Typography-Bytm3ycu.js";import{A as j}from"./Alert-DLLKlsyb.js";import{G as m}from"./Grid-Ckgvm1E9.js";import{T as c}from"./TextField-DxLbd0T7.js";import{B as N}from"./Button-Dd5SUgtW.js";import"./useTheme-BaCcI6wb.js";import"./index-CMMxByV_.js";import"./useSlot-C81N96pq.js";import"./ButtonBase-C_wHrl86.js";import"./createSvgIcon-DAAY2Ss0.js";import"./Close-B6mu1L3C.js";import"./IconButton-CQP4y5cZ.js";import"./Paper-DzT7rg5Q.js";import"./useTheme-BiC74sbM.js";import"./Select-YDvcYVIq.js";import"./Menu-BmUU4LJX.js";import"./Portal-C-Oqgn3D.js";import"./Grow-BubuCfXA.js";import"./List-CP_tTsPm.js";import"./Modal-CXdfSMMy.js";import"./useControlled-DAqY8FYl.js";import"./isMuiElement-Rh47zddv.js";const P="https://rubertogo.com",le=()=>{const[i,v]=n.useState({firstName:"",lastName:"",email:"",phone:"",address:"",timeZone:""}),[o,u]=n.useState(["","","",""]),[b,D]=n.useState(1),[d,h]=n.useState(""),[f,y]=n.useState(""),[l,g]=n.useState(!1),x=n.useRef([]);F();const{lang:E}=I();n.useEffect(()=>{v(r=>({...r,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}))},[]);const p=r=>{const{name:s,value:t}=r.target;v({...i,[s]:t})},R=(r,s)=>{const{value:t}=r.target;if(t.length===1){const a=[...o];a[s]=t,u(a),s<o.length-1&&t&&x.current[s+1].focus()}else if(t===""){const a=[...o];a[s]="",u(a)}},T=(r,s)=>{if(s.key==="Backspace")if(o[r]){const t=[...o];t[r]="",u(t)}else r>0&&x.current[r-1].focus()},W=r=>{const s=r.clipboardData.getData("Text").slice(0,4);if(s.length===4){const t=s.split("");u(t),x.current[3].focus()}},A=async r=>{var s;r.preventDefault(),h(""),y(""),g(!0);try{const t=await O.post(`${P}/api/register`,i);y(t.data.message),D(2)}catch(t){h(((s=t.response)==null?void 0:s.data.message)||"Registration failed")}finally{g(!1)}},B=async r=>{var t;r.preventDefault(),h(""),g(!0);const s=o.join("");try{const a=await O.post(`${P}/api/verify-otp`,{email:i.email,otp:s});console.log(a.data),y("Registration and OTP verification successful!"),u(["","","",""])}catch(a){h(((t=a.response)==null?void 0:t.data.message)||"OTP verification failed")}finally{g(!1)}};return e.jsx("div",{className:"max-w-full flex min-h-screen items-center justify-center",children:e.jsx(w,{className:"h-[300px] items-center max-w-md m-auto",children:e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[b===1&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Admin Registration"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),f&&e.jsx(j,{severity:"success",sx:{mb:2},children:f}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"First Name",name:"firstName",fullWidth:!0,variant:"outlined",value:i.firstName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"Last Name",name:"lastName",fullWidth:!0,variant:"outlined",value:i.lastName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Email",name:"email",type:"email",fullWidth:!0,variant:"outlined",value:i.email,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Phone",name:"phone",type:"tel",fullWidth:!0,variant:"outlined",value:i.phone,onChange:p})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Address",name:"address",fullWidth:!0,variant:"outlined",value:i.address,onChange:p})})]}),e.jsx(N,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(S,{size:24}),disabled:l,children:l?"Registering...":"Register"})]})]}),b===2&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Verify OTP"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),f&&e.jsx(j,{severity:"success",sx:{mb:2},children:f}),e.jsxs("form",{onSubmit:B,children:[e.jsx(w,{display:"flex",justifyContent:"center",alignItems:"center",gap:2,mt:2,children:o.map((r,s)=>e.jsx(c,{variant:"outlined",inputProps:{maxLength:1,style:{textAlign:"center",fontSize:"1.5rem",width:"3rem",height:"3rem"}},value:r,onChange:t=>R(t,s),onKeyDown:t=>T(s,t),onPaste:s===0?W:void 0,required:!0,inputRef:t=>x.current[s]=t},s))}),e.jsx(N,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(S,{size:24}),disabled:l,children:l?"Verifying...":"Verify OTP"})]})]})]})})})};export{le as default};
