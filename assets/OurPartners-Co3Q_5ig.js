import{r as e,ci as a,b as s,j as r,bZ as t}from"./vendor-Zgq9WbFI.js";const l="https://rubertogo.com",n=()=>{var n,o;const[i,d]=e.useState([]),[c,p]=e.useState(!1),[h,u]=e.useState(!1),[m,x]=e.useState(null),N=a("(max-width: 768px)");e.useEffect((()=>{v()}),[]);const v=async()=>{p(!0);try{const e=await s.get(`${l}/api/partner`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});d(e.data||[])}catch(e){console.error("Error fetching partner requests:",e)}finally{p(!1)}},g=async e=>{try{await s.put(`${l}/api/partner/approve/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),d((a=>a.map((a=>a._id===e?{...a,approvalStatus:"approved"}:a)))),alert("Partner approved successfully!")}catch(a){console.error("Error approving partner:",a),alert("Failed to approve partner.")}},j=async e=>{try{await s.put(`${l}/api/partner/reject/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}}),d((a=>a.map((a=>a._id===e?{...a,approvalStatus:"rejected"}:a)))),alert("Partner rejected successfully!")}catch(a){console.error("Error rejecting partner:",a),alert("Failed to reject partner.")}},b=e=>{x(e),u(!0)},w=()=>{x(null),u(!1)},f=[{field:"name",headerName:"Name",width:200},{field:"email",headerName:"Email",width:200},{field:"phone",headerName:"Phone",width:150},{field:"vat",headerName:"Registration #",width:150},{field:"approvalStatus",headerName:"Status",width:150,renderCell:e=>r.jsx("span",{className:"px-3 py-1 rounded-full "+("approved"===e.value?"bg-green-100 text-green-800":"rejected"===e.value?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.value})},{field:"actions",headerName:"Actions",width:250,renderCell:e=>r.jsxs("div",{className:"space-x-2",children:["approved"!==e.row.approvalStatus&&"rejected"!==e.row.approvalStatus&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>g(e.row.id),className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:"Approve"}),r.jsx("button",{onClick:()=>j(e.row.id),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",children:"Reject"})]}),r.jsx("button",{onClick:()=>b(e.row),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"View"})]})}],y=i.map((e=>{var a,s;return{id:e._id,name:(null==e?void 0:e.user)?`${e.user.firstName||"N/A"} ${e.user.lastName||"N/A"}`:"N/A",email:(null==(a=null==e?void 0:e.user)?void 0:a.email)||"N/A",phone:(null==(s=null==e?void 0:e.user)?void 0:s.phone)||"N/A",vat:e.vat||"N/A",approvalStatus:e.approvalStatus||"pending"}}));return r.jsxs("div",{className:"p-6 bg-gray-100 min-h-screen max-w-full",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Partner Requests"}),c?r.jsx("p",{className:"text-center",children:"Loading..."}):0===i.length?r.jsx("p",{className:"text-center",children:"No partner requests found."}):N?r.jsx("div",{className:"grid gap-4",children:i.map((e=>r.jsxs("div",{className:"bg-white shadow p-4 rounded-lg",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Name:"})," ",`${e.user.firstName} ${e.user.lastName}`]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Email:"})," ",e.user.email]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Phone:"})," ",e.user.phone]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Registration #:"})," ",e.vat]}),r.jsxs("p",{className:"text-green-500",children:[r.jsx("span",{className:"font-semibold",children:"Status #:"})," ",null==e?void 0:e.approvalStatus]}),r.jsxs("div",{className:"mt-4 space-x-2",children:["approved"!==e.approvalStatus&&"rejected"!==e.approvalStatus&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>g(e._id),className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:"Approve"}),r.jsx("button",{onClick:()=>j(e._id),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",children:"Reject"})]}),r.jsx("button",{onClick:()=>b(e),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"View"})]})]},e._id)))}):r.jsx("div",{className:"w-full h-[500px]",children:r.jsx(t,{rows:y,columns:f,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0})}),h&&m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-4xl w-full p-6 relative",children:[r.jsx("button",{onClick:w,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",children:"âœ–"}),r.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Partner Details - ",m.companyName]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Owner Name:"})," ",(null==m?void 0:m.user)?`${m.user.firstName||"N/A"} ${m.user.lastName||"N/A"}`:"N/A"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Email:"})," ",(null==(n=null==m?void 0:m.user)?void 0:n.email)||"N/A"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Phone:"})," ",(null==(o=null==m?void 0:m.user)?void 0:o.phone)||"N/A"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold",children:"Registration #:"})," ",(null==m?void 0:m.vat)||"N/A"]}),r.jsxs("p",{className:"text-green-500",children:[r.jsx("span",{className:"font-semibold",children:"Status #:"})," ",(null==m?void 0:m.approvalStatus)||"N/A"]}),r.jsx("button",{onClick:w,className:"bg-blue-500 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-600 mt-4",children:"Close"})]})})]})};export{n as default};
