import{r as l,j as e,k as r,aL as N,n as t,Q as w,x as S,a4 as B,cI as C,L as I,s as h,a9 as L,B as u,b as y,f as g}from"./vendor-DTHYb0ru.js";const F=()=>{const[j,p]=l.useState([]),[a,c]=l.useState(null),[i,o]=l.useState(""),[f,b]=l.useState(!0),[d,x]=l.useState(null),m=localStorage.getItem("accessToken");l.useEffect(()=>{(async()=>{try{const n=await y.get("http://localhost:3000/api/contact/messages",{headers:{Authorization:`Bearer ${m}`}});Array.isArray(n.data)?(p(n.data),c(n.data[0])):x("Invalid data format from server.")}catch{x("Failed to fetch messages. Please try again later.")}finally{b(!1)}})()},[]);const v=async()=>{if(a)try{await y.post(`http://localhost:3000/api/contact/messages/${a._id}/reply`,{reply:i},{headers:{Authorization:`Bearer ${m}`}}),c(s=>({...s,reply:i})),g.success("Reply sent successfully!"),o("")}catch{g.error("Failed to send reply. Please try again.")}};return f?e.jsx(r,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx(N,{})}):d?e.jsx(r,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx(t,{variant:"h6",color:"error",children:d})}):e.jsxs(r,{className:"min-h-screen bg-gray-100 p-4",sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2},children:[e.jsx(w,{}),e.jsxs(r,{className:"bg-white shadow-lg rounded-lg p-4",sx:{width:{xs:"100%",md:"25%"},maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:[e.jsx(t,{variant:"h6",className:"mb-4 text-gray-800",children:"Inbox"}),e.jsx(S,{children:j.map(s=>e.jsx(B,{disablePadding:!0,onClick:()=>c(s),selected:a?._id===s._id,children:e.jsx(C,{children:e.jsx(I,{primary:s.subject,secondary:`From: ${s.name}`})})},s._id))})]}),e.jsx(r,{className:"bg-white shadow-lg rounded-lg p-4 flex flex-col",sx:{flex:1,maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:a?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h5",className:"mb-2",children:a.subject}),e.jsxs(t,{variant:"subtitle1",className:"mb-4 text-gray-600",children:["From: ",a.name," (",a.email,")"]}),e.jsx(h,{className:"mb-4"}),e.jsx(t,{variant:"body1",className:"mb-4",children:a.message}),e.jsx(h,{className:"mb-4"}),a.reply&&e.jsxs(r,{className:"mb-4",children:[e.jsx(t,{variant:"subtitle2",className:"text-gray-800",children:"Your Reply:"}),e.jsx(t,{variant:"body1",children:a.reply})]}),e.jsx(L,{fullWidth:!0,multiline:!0,rows:4,placeholder:"Write your reply...",value:i,onChange:s=>o(s.target.value),className:"mb-4"}),e.jsxs(r,{className:"flex justify-end space-x-4",children:[e.jsx(u,{variant:"outlined",color:"secondary",onClick:()=>o(""),children:"Clear"}),e.jsx(u,{variant:"contained",color:"primary",onClick:v,disabled:!i.trim(),children:"Send Reply"})]})]}):e.jsx(t,{variant:"h6",className:"text-gray-500",children:"Select a message to view its details."})})]})};export{F as default};
