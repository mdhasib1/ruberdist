import{u as B,b as R,r as a,a as F,j as t,d as g,F as b}from"./index-D-tacDo0.js";import{O as M}from"./index-DmdATi-9.js";import{T as x}from"./Typography-DA9Er3Yb.js";import{T as v}from"./TextField-Ben9hf97.js";import{I as V}from"./InputAdornment-CGw_sbT-.js";import{B as y}from"./Button-DcaeVkm4.js";import{G as j}from"./Grid-BvrEEjj1.js";import{S as W}from"./Snackbar-CYtFZEGQ.js";import{A as $}from"./Alert-ChLDfq8X.js";import"./iconBase-CKp54I6L.js";import"./index-DqaVpj0-.js";import"./createSimplePaletteValueFilter-BA-5fWDN.js";import"./useTheme-BPaKzVUX.js";import"./useSlot-C4Jq41_r.js";import"./CircularProgress-C_nPCmSr.js";import"./Select-CdTeA48B.js";import"./Menu-D8FtULnJ.js";import"./Portal-BmHO-mBc.js";import"./Grow-BlXXg7GE.js";import"./useTheme-DTUOtr2d.js";import"./List-lkVPBD74.js";import"./Paper-D8__vy1H.js";import"./Modal-DeRbA6Cj.js";import"./useControlled-B5g-9vmA.js";import"./createSvgIcon-DSUh4BZ1.js";import"./isMuiElement-7oANgUe6.js";import"./ClickAwayListener-BlbJm6_R.js";import"./Close-8o8Uc7-g.js";import"./IconButton-CfFcDGl4.js";const S="https://rubertogo.com",bt=()=>{const{lang:O}=B(),{login:w}=R(),[p,T]=a.useState(""),[n,u]=a.useState(["","","",""]),[d,P]=a.useState(1),[N,i]=a.useState(""),[A,f]=a.useState(!1),[l,c]=a.useState(!1),C=F(),m=a.useRef([]),E=r=>{T(r.target.value)},I=(r,e)=>{const{value:s}=r.target;if(s.length===1){const o=[...n];o[e]=s,u(o),e<n.length-1&&m.current[e+1].focus()}else if(s===""){const o=[...n];o[e]="",u(o),e>0&&m.current[e-1].focus()}},D=r=>{const e=r.clipboardData.getData("Text").slice(0,4);if(e.length===4){const s=e.split("");u(s),m.current[3].focus()}},L=async r=>{r.preventDefault(),i(""),c(!0);try{const e=await g.post(`${S}/api/login`,{email:p});b.success("OTP sent to your email."),P(2)}catch{i("User not found with the given email."),f(!0)}finally{c(!1)}},k=async r=>{r.preventDefault();const e=n.join("");i(""),c(!0);try{const s=await g.post(`${S}/api/verify-otp`,{email:p,otp:e}),{accessToken:o}=s.data;w(o),b.success("Login successful!"),C(`/${O}/admin/overview`)}catch{i("Invalid or expired OTP."),f(!0)}finally{c(!1)}},h=()=>{f(!1)};return t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:t.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[t.jsx("div",{className:"flex justify-center mb-8",children:t.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),t.jsx(x,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:d===1?"Admin Sign In":"Verify OTP"}),d===1&&t.jsxs("form",{onSubmit:L,children:[t.jsx("div",{className:"mb-4",children:t.jsx(v,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:p,onChange:E,InputProps:{startAdornment:t.jsx(V,{position:"start",children:t.jsx(M,{className:"text-gray-400"})})}})}),t.jsx(y,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Sending OTP...":"Send OTP"})]}),d===2&&t.jsxs("form",{onSubmit:k,children:[t.jsx(x,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),t.jsx(j,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",sx:{textAlign:"center",marginTop:"1rem"},children:n.map((r,e)=>t.jsx(j,{item:!0,children:t.jsx(v,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:r,onChange:s=>I(s,e),onPaste:e===0?D:void 0,inputRef:s=>m.current[e]=s,required:!0})},e))}),t.jsx(y,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Verifying...":"Verify OTP"})]}),t.jsx(W,{open:A,autoHideDuration:6e3,onClose:h,children:t.jsx($,{onClose:h,severity:"error",children:N})})]})})};export{bt as default};
