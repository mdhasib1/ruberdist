import{r as i,u as F,j as t,s as P,c as $,d as T,n as D,m as E,H as b,U as M,as as V,k as w,V as k}from"./index-DLpikvjc.js";import{B as p}from"./Box-B-GTZaan.js";import{T as d}from"./Typography-Bytm3ycu.js";import{a as L,L as A}from"./List-CP_tTsPm.js";import{g as G,l as y,L as _}from"./ListItem-Cz_o3tFU.js";import{b as z,d as H,B as U}from"./ButtonBase-C_wHrl86.js";import{L as W}from"./ListItemText-BaK17cQI.js";import{D as R}from"./Divider-BZXxc7Ka.js";import{T as Y}from"./TextField-DxLbd0T7.js";import{B as S}from"./Button-Dd5SUgtW.js";import"./useTheme-BaCcI6wb.js";import"./index-CMMxByV_.js";import"./isMuiElement-Rh47zddv.js";import"./listItemTextClasses-c0_geO1e.js";import"./useSlot-C81N96pq.js";import"./dividerClasses-CWGPkxTW.js";import"./Select-YDvcYVIq.js";import"./Menu-BmUU4LJX.js";import"./Portal-C-Oqgn3D.js";import"./Grow-BubuCfXA.js";import"./useTheme-BiC74sbM.js";import"./Paper-DzT7rg5Q.js";import"./Modal-CXdfSMMy.js";import"./useControlled-DAqY8FYl.js";import"./createSvgIcon-DAAY2Ss0.js";const Q=(e,a)=>{const{ownerState:s}=e;return[a.root,s.dense&&a.dense,s.alignItems==="flex-start"&&a.alignItemsFlexStart,s.divider&&a.divider,!s.disableGutters&&a.gutters]},q=e=>{const{alignItems:a,classes:s,dense:n,disabled:o,disableGutters:l,divider:m,selected:f}=e,c=T({root:["root",n&&"dense",!l&&"gutters",m&&"divider",o&&"disabled",a==="flex-start"&&"alignItemsFlexStart",f&&"selected"]},G,s);return{...s,...c}},J=P(U,{shouldForwardProp:e=>D(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:Q})(E(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${y.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:b(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${y.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:b(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${y.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:b(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:b(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${y.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${y.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:a})=>a.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:a})=>!a.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:a})=>a.dense,style:{paddingTop:4,paddingBottom:4}}]}))),K=i.forwardRef(function(a,s){const n=F({props:a,name:"MuiListItemButton"}),{alignItems:o="center",autoFocus:l=!1,component:m="div",children:f,dense:u=!1,disableGutters:c=!1,divider:v=!1,focusVisibleClassName:h,selected:r=!1,className:x,...g}=n,I=i.useContext(L),B=i.useMemo(()=>({dense:u||I.dense||!1,alignItems:o,disableGutters:c}),[o,I.dense,u,c]),j=i.useRef(null);z(()=>{l&&j.current&&j.current.focus()},[l]);const N={...n,alignItems:o,dense:B.dense,disableGutters:c,divider:v,selected:r},C=q(N),O=H(j,s);return t.jsx(L.Provider,{value:B,children:t.jsx(J,{ref:O,href:g.href||g.to,component:(g.href||g.to)&&m==="div"?"button":m,focusVisibleClassName:$(C.focusVisible,h),ownerState:N,className:$(C.root,x),...g,classes:C,children:f})})}),Ie=()=>{const[e,a]=i.useState([]),[s,n]=i.useState(null),[o,l]=i.useState(""),[m,f]=i.useState(!0),[u,c]=i.useState(null),v=localStorage.getItem("accessToken");i.useEffect(()=>{(async()=>{try{const x=await w.get("http://localhost:3000/api/contact/messages",{headers:{Authorization:`Bearer ${v}`}});Array.isArray(x.data)?(a(x.data),n(x.data[0])):c("Invalid data format from server.")}catch{c("Failed to fetch messages. Please try again later.")}finally{f(!1)}})()},[]);const h=async()=>{if(s)try{await w.post(`http://localhost:3000/api/contact/messages/${s._id}/reply`,{reply:o},{headers:{Authorization:`Bearer ${v}`}}),n(r=>({...r,reply:o})),k.success("Reply sent successfully!"),l("")}catch{k.error("Failed to send reply. Please try again.")}};return m?t.jsx(p,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:t.jsx(M,{})}):u?t.jsx(p,{className:"min-h-screen flex items-center justify-center bg-gray-100",children:t.jsx(d,{variant:"h6",color:"error",children:u})}):t.jsxs(p,{className:"min-h-screen bg-gray-100 p-4",sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2},children:[t.jsx(V,{}),t.jsxs(p,{className:"bg-white shadow-lg rounded-lg p-4",sx:{width:{xs:"100%",md:"25%"},maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:[t.jsx(d,{variant:"h6",className:"mb-4 text-gray-800",children:"Inbox"}),t.jsx(A,{children:e.map(r=>t.jsx(_,{disablePadding:!0,onClick:()=>n(r),selected:(s==null?void 0:s._id)===r._id,children:t.jsx(K,{children:t.jsx(W,{primary:r.subject,secondary:`From: ${r.name}`})})},r._id))})]}),t.jsx(p,{className:"bg-white shadow-lg rounded-lg p-4 flex flex-col",sx:{flex:1,maxHeight:{xs:"auto",md:"100vh"},overflowY:"auto"},children:s?t.jsxs(t.Fragment,{children:[t.jsx(d,{variant:"h5",className:"mb-2",children:s.subject}),t.jsxs(d,{variant:"subtitle1",className:"mb-4 text-gray-600",children:["From: ",s.name," (",s.email,")"]}),t.jsx(R,{className:"mb-4"}),t.jsx(d,{variant:"body1",className:"mb-4",children:s.message}),t.jsx(R,{className:"mb-4"}),s.reply&&t.jsxs(p,{className:"mb-4",children:[t.jsx(d,{variant:"subtitle2",className:"text-gray-800",children:"Your Reply:"}),t.jsx(d,{variant:"body1",children:s.reply})]}),t.jsx(Y,{fullWidth:!0,multiline:!0,rows:4,placeholder:"Write your reply...",value:o,onChange:r=>l(r.target.value),className:"mb-4"}),t.jsxs(p,{className:"flex justify-end space-x-4",children:[t.jsx(S,{variant:"outlined",color:"secondary",onClick:()=>l(""),children:"Clear"}),t.jsx(S,{variant:"contained",color:"primary",onClick:h,disabled:!o.trim(),children:"Send Reply"})]})]}):t.jsx(d,{variant:"h6",className:"text-gray-500",children:"Select a message to view its details."})})]})};export{Ie as default};
