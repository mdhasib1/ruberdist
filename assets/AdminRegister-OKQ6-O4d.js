import{r as n,a as F,u as I,j as e,C as z,d as S}from"./index-D-tacDo0.js";import{B as O}from"./Box-C71l__--.js";import{T as C}from"./Typography-DA9Er3Yb.js";import{A as j}from"./Alert-ChLDfq8X.js";import{G as m}from"./Grid-BvrEEjj1.js";import{T as c}from"./TextField-Ben9hf97.js";import{B as w}from"./Button-DcaeVkm4.js";import{C as N}from"./CircularProgress-C_nPCmSr.js";import"./createSimplePaletteValueFilter-BA-5fWDN.js";import"./useTheme-BPaKzVUX.js";import"./index-DqaVpj0-.js";import"./useSlot-C4Jq41_r.js";import"./createSvgIcon-DSUh4BZ1.js";import"./Close-8o8Uc7-g.js";import"./IconButton-CfFcDGl4.js";import"./Paper-D8__vy1H.js";import"./useTheme-DTUOtr2d.js";import"./Select-CdTeA48B.js";import"./Menu-D8FtULnJ.js";import"./Portal-BmHO-mBc.js";import"./Grow-BlXXg7GE.js";import"./List-lkVPBD74.js";import"./Modal-DeRbA6Cj.js";import"./useControlled-B5g-9vmA.js";import"./isMuiElement-7oANgUe6.js";const P="https://rubertogo.com",me=()=>{const[i,v]=n.useState({firstName:"",lastName:"",email:"",phone:"",address:"",timeZone:""}),[o,u]=n.useState(["","","",""]),[b,D]=n.useState(1),[d,f]=n.useState(""),[h,y]=n.useState(""),[l,g]=n.useState(!1),x=n.useRef([]);F();const{lang:E}=I();n.useEffect(()=>{v(r=>({...r,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}))},[]);const p=r=>{const{name:s,value:t}=r.target;v({...i,[s]:t})},R=(r,s)=>{const{value:t}=r.target;if(t.length===1){const a=[...o];a[s]=t,u(a),s<o.length-1&&t&&x.current[s+1].focus()}else if(t===""){const a=[...o];a[s]="",u(a)}},T=(r,s)=>{if(s.key==="Backspace")if(o[r]){const t=[...o];t[r]="",u(t)}else r>0&&x.current[r-1].focus()},W=r=>{const s=r.clipboardData.getData("Text").slice(0,4);if(s.length===4){const t=s.split("");u(t),x.current[3].focus()}},A=async r=>{var s;r.preventDefault(),f(""),y(""),g(!0);try{const t=await S.post(`${P}/api/register`,i);y(t.data.message),D(2)}catch(t){f(((s=t.response)==null?void 0:s.data.message)||"Registration failed")}finally{g(!1)}},B=async r=>{var t;r.preventDefault(),f(""),g(!0);const s=o.join("");try{const a=await S.post(`${P}/api/verify-otp`,{email:i.email,otp:s});console.log(a.data),y("Registration and OTP verification successful!"),u(["","","",""])}catch(a){f(((t=a.response)==null?void 0:t.data.message)||"OTP verification failed")}finally{g(!1)}};return e.jsx("div",{className:"max-w-full flex min-h-screen items-center justify-center",children:e.jsx(O,{className:"h-[300px] items-center max-w-md m-auto",children:e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[b===1&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Admin Registration"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),h&&e.jsx(j,{severity:"success",sx:{mb:2},children:h}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"First Name",name:"firstName",fullWidth:!0,variant:"outlined",value:i.firstName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"Last Name",name:"lastName",fullWidth:!0,variant:"outlined",value:i.lastName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Email",name:"email",type:"email",fullWidth:!0,variant:"outlined",value:i.email,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Phone",name:"phone",type:"tel",fullWidth:!0,variant:"outlined",value:i.phone,onChange:p})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Address",name:"address",fullWidth:!0,variant:"outlined",value:i.address,onChange:p})})]}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(N,{size:24}),disabled:l,children:l?"Registering...":"Register"})]})]}),b===2&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Verify OTP"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),h&&e.jsx(j,{severity:"success",sx:{mb:2},children:h}),e.jsxs("form",{onSubmit:B,children:[e.jsx(O,{display:"flex",justifyContent:"center",alignItems:"center",gap:2,mt:2,children:o.map((r,s)=>e.jsx(c,{variant:"outlined",inputProps:{maxLength:1,style:{textAlign:"center",fontSize:"1.5rem",width:"3rem",height:"3rem"}},value:r,onChange:t=>R(t,s),onKeyDown:t=>T(s,t),onPaste:s===0?W:void 0,required:!0,inputRef:t=>x.current[s]=t},s))}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(N,{size:24}),disabled:l,children:l?"Verifying...":"Verify OTP"})]})]})]})})})};export{me as default};
