import{a as e,r as t,u as s,j as a,g as n,a2 as i,bi as r,bj as o,a4 as l,aE as c,cH as u,cj as d,b as m,aV as h}from"./vendor-Zgq9WbFI.js";import{u as g}from"./index-D29cp_SG.js";const f="https://rubertogo.com",p=()=>{const{lang:p}=e(),{login:x}=g(),[b,j]=t.useState(""),[v,y]=t.useState(["","","",""]),[S,w]=t.useState(1),[P,N]=t.useState(""),[T,O]=t.useState(!1),[C,D]=t.useState(!1),V=s(),E=t.useRef([]),I=e=>{const t=e.clipboardData.getData("Text").slice(0,4);if(4===t.length){const e=t.split("");y(e),E.current[3].focus()}},L=()=>{O(!1)};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:a.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),a.jsx(n,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:1===S?"Partner Sign In":"Verify OTP"}),1===S&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),N(""),D(!0);try{const e=await m.post(`${f}/api/login`,{email:b});console.log(e),h.success("OTP sent to your email."),w(2)}catch(t){console.log(t),N("User not found with the given email."),O(!0)}finally{D(!1)}},children:[a.jsx("div",{className:"mb-4",children:a.jsx(i,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:b,onChange:e=>{j(e.target.value)},InputProps:{startAdornment:a.jsx(r,{position:"start",children:a.jsx(o,{className:"text-gray-400"})})}})}),a.jsx(l,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:C,children:C?"Sending OTP...":"Send OTP"})]}),2===S&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=v.join("");N(""),D(!0);try{const e=await m.post(`${f}/api/verify-otp`,{email:b,otp:t}),{accessToken:s}=e.data;x(s),h.success("Login successful!"),V(`/${p}/partner/dashboard`)}catch(s){N("Invalid or expired OTP."),O(!0)}finally{D(!1)}},children:[a.jsx(n,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),a.jsx(c,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",children:v.map(((e,t)=>a.jsx(c,{item:!0,children:a.jsx(i,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:e,onChange:e=>((e,t)=>{const{value:s}=e.target;if(1===s.length){const e=[...v];e[t]=s,y(e),t<v.length-1&&E.current[t+1].focus()}else if(""===s){const e=[...v];e[t]="",y(e),t>0&&E.current[t-1].focus()}})(e,t),onPaste:0===t?I:void 0,inputRef:e=>E.current[t]=e,required:!0})},t)))}),a.jsx(l,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:C,children:C?"Verifying...":"Verify OTP"})]}),a.jsx(u,{open:T,autoHideDuration:6e3,onClose:L,children:a.jsx(d,{onClose:L,severity:"error",children:P})})]})})};export{p as default};
