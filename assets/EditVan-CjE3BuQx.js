import{r as e,bh as a,a as s,u as l,j as i,aQ as t,g as n,aE as r,a2 as o,af as c,I as d,bk as m,bq as h,br as u,k as x,a4 as g,b as j,aV as v,c3 as p,bY as b,bm as y,bg as f}from"./vendor-Zgq9WbFI.js";import{P as N}from"./PackageModal-BuemN_fU.js";const w="https://rubertogo.com",k=["places"],C=()=>{var p,b;const[y,f]=e.useState(null);console.log(y);const{isLoaded:C}=a({googleMapsApiKey:"AIzaSyCJgOiSJeJlRdoFK_jTK-mNug5b22XPRn4",libraries:k}),{lang:I}=s(),[T,H]=e.useState("en"),[L,$]=e.useState("en"),K=l(),F=s().id;console.log(F);const[B,M]=e.useState(!1),[O,q]=e.useState(!1),[U,R]=e.useState(!1),[V,_]=e.useState(!1),[J,G]=e.useState(!1),[Q,X]=e.useState(!1),[Y,Z]=e.useState(!1),[ee,ae]=e.useState([]),[se,le]=e.useState({}),ie=[{value:"en",label:"English"},{value:"fr",label:"French"},{value:"it",label:"Italian"},{value:"de",label:"German"}];e.useEffect((()=>{(async()=>{try{const e=await j.get(`${w}/api/vans/${F}`);f(e.data)}catch(e){console.error("Error fetching van data:",e),v.error("Failed to load van data.")}})()}),[F]);const te=e=>{f((a=>void 0!==a[e]?(le((s=>({...s,[e]:a[e]}))),{...a,[e]:void 0}):{...a,[e]:se[e]||""}))},ne=(e,a,s)=>{f((l=>({...l,dailyPricing:{...l.dailyPricing,[e]:{...l.dailyPricing[e],[a]:s}}})))},re=(e,a,s)=>{f((l=>({...l,restrictedBookingHours:{...l.restrictedBookingHours,[e]:{...l.restrictedBookingHours[e],[a]:s}}})))},oe=(e,a)=>{f((s=>({...s,trackingDevice:{...s.trackingDevice,[e]:a}})))},ce=e=>{const{name:a,value:s}=e.target;f({...y,[a]:s})},de=(e,a,s)=>{f((l=>{const i={...l[e],[a]:s};return"it"===a&&(i.en=s,i.fr=s,i.de=s),{...l,[e]:i}}))},me=(e,a,s)=>{f((l=>({...l,[e]:{...l[e],[a]:s}})))},he=async(e,a)=>{const s=await Promise.all(e.map((async e=>await(async e=>{const a=new FormData;a.append("file",e);try{return(await j.post(`${w}/api/upload`,a,{headers:{"Content-Type":"multipart/form-data"}})).data.imageURL}catch(s){return console.error("Error uploading file:",s),null}})(e))));"images"===a&&f((e=>({...e,images:[...e.images,...s]})))};return y?i.jsxs("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-r from-gray-100 to-gray-200 p-4",children:[i.jsxs(t,{className:"p-8 shadow-2xl rounded-lg container",children:[i.jsxs(n,{variant:"h4",style:{marginBottom:"1rem"},className:"p-3 text-white text-center bg-blue-600 font-bold rounded",children:["Edit Van - ",(null==(p=y.name)?void 0:p.en)||"Unnamed Van"]}),i.jsx("form",{onSubmit:async e=>{e.preventDefault();const a=localStorage.getItem("accessToken");try{200===(await j.put(`${w}/api/vans/${F}`,y,{headers:{Authorization:`Bearer ${a}`}})).status?(v.success("Van updated successfully!"),K(`/:${I}/admin/vans`)):v.error("Failed to update van.")}catch(s){console.error("Error updating van:",s),v.error("An error occurred while updating the van.")}},children:i.jsxs(r,{container:!0,spacing:3,children:[i.jsx(P,{label:"Van Name",field:"name",selectedLang:T,setSelectedLang:H,value:y.name[T],onChange:de,languageOptions:ie,style:{marginBottom:"1rem"}}),i.jsx(P,{label:"Description",field:"description",selectedLang:L,setSelectedLang:$,value:y.description[L],onChange:de,languageOptions:ie,multiline:!0,rows:3}),i.jsx(r,{item:!0,xs:12,children:i.jsx(o,{fullWidth:!0,label:"Plate Number",name:"plateNumber",value:y.plateNumber,onChange:ce,variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),i.jsxs(r,{item:!0,xs:12,children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-semibold text-gray-700",children:"Daily Pricing"}),i.jsx(c,{title:"Set daily pricing details for this van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),i.jsx(h,{control:i.jsx(u,{checked:B,onChange:e=>(e=>{if(M(e),e){const e=y.dailyPricing.Monday;Object.keys(y.dailyPricing).forEach((a=>{"Monday"!==a&&f((s=>({...s,dailyPricing:{...s.dailyPricing,[a]:{...e}}})))}))}})(e.target.checked)}),label:i.jsxs("div",{className:"flex items-center",children:["Apply Kilometers and Extra Per Km to All Days",i.jsx(c,{title:"Enable this to apply Monday's values to all other days.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})}),Object.keys(y.dailyPricing).map((e=>i.jsxs(r,{container:!0,spacing:2,className:"mb-4",children:[i.jsx(r,{item:!0,xs:12,sm:4,children:i.jsx(o,{fullWidth:!0,label:`${e} Price Per Hour`,type:"number",value:y.dailyPricing[e].pricePerHour,onChange:a=>ne(e,"pricePerHour",a.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:12,sm:4,children:i.jsx(o,{fullWidth:!0,label:`${e} Kilometers`,type:"number",value:y.dailyPricing[e].kilometers,onChange:a=>ne(e,"kilometers",a.target.value),variant:"outlined",className:"bg-white rounded-lg",disabled:B&&"Monday"!==e})}),i.jsx(r,{item:!0,xs:12,sm:4,children:i.jsx(o,{fullWidth:!0,label:`${e} Extra Per Km`,type:"number",value:y.dailyPricing[e].extraPerKm,onChange:a=>ne(e,"extraPerKm",a.target.value),variant:"outlined",className:"bg-white rounded-lg",disabled:B&&"Monday"!==e})})]},e)))]}),i.jsx(r,{item:!0,xs:6,sm:4,children:i.jsx(h,{control:i.jsx(u,{checked:void 0!==(null==y?void 0:y.preAuthorizationAmount),onChange:()=>te("preAuthorizationAmount")}),label:i.jsxs("div",{className:"flex items-center",children:["Set Pre Authorization Amount",i.jsx(c,{title:"Enable this to set a pre-authorization amount for this van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})})}),void 0!==(null==y?void 0:y.preAuthorizationAmount)&&i.jsx(r,{item:!0,xs:6,sm:6,children:i.jsx(o,{fullWidth:!0,label:"Pre Authorization Amount",name:"preAuthorizationAmount",type:"number",value:y.preAuthorizationAmount,onChange:e=>f((a=>({...a,preAuthorizationAmount:e.target.value}))),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:6,sm:4,children:i.jsx(h,{control:i.jsx(u,{checked:void 0!==(null==y?void 0:y.minimumHours),onChange:()=>te("minimumHours")}),label:i.jsxs("div",{className:"flex items-center",children:["Set Minimum Hours",i.jsx(c,{title:"Enable this to set a minimum booking duration.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})})}),void 0!==(null==y?void 0:y.minimumHours)&&i.jsx(r,{item:!0,xs:6,sm:6,children:i.jsx(o,{fullWidth:!0,label:"Minimum Hours",name:"minimumHours",type:"number",value:y.minimumHours,onChange:e=>f((a=>({...a,minimumHours:e.target.value}))),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:6,sm:4,children:i.jsx(h,{control:i.jsx(u,{checked:void 0!==(null==y?void 0:y.unlimitedKilometersPrice),onChange:()=>te("unlimitedKilometersPrice")}),label:i.jsxs("div",{className:"flex items-center",children:["Set Unlimited Kilometers",i.jsx(c,{title:"Enable this to allow unlimited kilometers with a price.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})})}),void 0!==(null==y?void 0:y.unlimitedKilometersPrice)&&i.jsx(r,{item:!0,xs:6,sm:6,children:i.jsx(o,{fullWidth:!0,label:"Unlimited Kilometers Price",name:"unlimitedKilometersPrice",type:"number",value:y.unlimitedKilometersPrice,onChange:e=>f((a=>({...a,unlimitedKilometersPrice:e.target.value}))),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:6,sm:4,children:i.jsx(h,{control:i.jsx(u,{checked:(null==y?void 0:y.allowPackages)??!1,onChange:()=>{(null==y?void 0:y.allowPackages)?f((e=>({...e,allowPackages:!1,packagePrices:void 0}))):(f((e=>({...e,allowPackages:!0}))),Z(!0))}}),label:i.jsxs("div",{className:"flex items-center",children:["Allow Package",i.jsx(c,{title:"Enable this to allow users to book packages for this van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})})}),(null==y?void 0:y.allowPackages)&&i.jsx(N,{isOpen:Y,onClose:()=>Z(!1),onSave:e=>{const a=Object.entries(e).map((([e,a])=>({packageId:e,price:parseFloat(a)})));f((e=>({...e,packagePrices:a}))),Z(!1)},initialPrices:(null==(b=null==y?void 0:y.packagePrices)?void 0:b.reduce(((e,a)=>(e[a.packageId._id]=a.price,e)),{}))||{}}),i.jsx(r,{item:!0,xs:12,sm:4,children:i.jsx(h,{control:i.jsx(u,{checked:Q,onChange:e=>X(e.target.checked)}),label:i.jsxs("div",{className:"flex items-center",children:["Set Restricted Booking Hours",i.jsx(c,{title:"Enable this to restrict specific booking hours for this van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]})})}),Q&&i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"h6",sx:{marginBottom:"10px"},className:"mb-4",children:"Weekly Restricted Booking Hours"}),Object.keys(y.restrictedBookingHours).map((e=>i.jsxs(r,{container:!0,spacing:2,className:"mb-3",children:[i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{select:!0,fullWidth:!0,label:`${e} Start Time`,value:y.restrictedBookingHours[e].start,onChange:a=>re(e,"start",a.target.value),variant:"outlined",className:"bg-white rounded-lg",children:Array.from({length:24},((e,a)=>{const s=a.toString().padStart(2,"0")+":00";return i.jsx(x,{value:s,children:s},s)}))})}),i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{select:!0,fullWidth:!0,label:`${e} End Time`,value:y.restrictedBookingHours[e].end,onChange:a=>re(e,"end",a.target.value),variant:"outlined",className:"bg-white rounded-lg",children:Array.from({length:24},((e,a)=>{const s=a.toString().padStart(2,"0")+":00";return i.jsx(x,{value:s,children:s},s)}))})})]},e)))]}),i.jsx(S,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Upload Van Images",i.jsx(c,{title:"Upload images of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),images:y.images,onDrop:e=>he(e,"images")}),i.jsx(A,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Upload Damage Images",i.jsx(c,{title:"Upload images of the damage.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),contractImages:y.contractImages,onDrop:he,onAdd:()=>{f((e=>({...e,contractImages:[...e.contractImages,{damageType:"",description:"",image:""}]})))},onRemove:e=>{f((a=>({...a,contractImages:a.contractImages.filter(((a,s)=>s!==e))})))},onChange:(e,a,s)=>{f((l=>({...l,contractImages:l.contractImages.map(((l,i)=>i===e?{...l,[a]:s}:l))})))}}),i.jsx(D,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Location",i.jsx(c,{title:"Select the location of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),location:y.location,onChange:me,isLoaded:C}),i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{select:!0,fullWidth:!0,label:i.jsxs("div",{className:"flex items-center",children:["Fuel Type",i.jsx(c,{title:"Select the fuel type of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),name:"fuelType",value:y.fuelType,onChange:ce,variant:"outlined",required:!0,className:"bg-white rounded-lg",children:["Petrol","Diesel","Electric","Hybrid"].map((e=>i.jsx(x,{value:e,children:e},e)))})}),i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{select:!0,fullWidth:!0,label:i.jsxs("div",{className:"flex items-center",children:["Transmission Type",i.jsx(c,{title:"Select the transmission type of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),name:"transmissionType",value:y.transmissionType,onChange:ce,variant:"outlined",required:!0,className:"bg-white rounded-lg",children:["Manual","Automatic"].map((e=>i.jsx(x,{value:e,children:e},e)))})}),i.jsx(W,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Optional Features",i.jsx(c,{title:"Select the optional features of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),optionalFeatures:y.optionalFeatures,onChange:e=>{f((a=>({...a,optionalFeatures:{...a.optionalFeatures,[e]:!a.optionalFeatures[e]}})))}}),i.jsx(z,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["External Dimensions (L × W × H)",i.jsx(c,{title:"Enter the external dimensions of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),dimensions:y.externalDimensions,onChange:me,dimensionType:"externalDimensions"}),i.jsx(z,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Internal Dimensions (L × W × H)",i.jsx(c,{title:"Enter the internal dimensions of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),dimensions:y.internalDimensions,onChange:me,dimensionType:"internalDimensions"}),i.jsx(E,{label:i.jsxs("div",{className:"flex items-center mb-5",children:["Weight (Empty × Max Load)",i.jsx(c,{title:"Enter the load capacity of the van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),weight:y.weight,onChange:me}),i.jsxs(r,{item:!0,xs:12,children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("span",{className:"font-semibold text-gray-700",children:"Traking Device"}),i.jsx(c,{title:" Set the tracking device details for this van.",children:i.jsx(d,{size:"small",className:"ml-1",children:i.jsx(m,{})})})]}),i.jsxs(r,{container:!0,spacing:2,children:[i.jsx(r,{item:!0,xs:12,children:i.jsxs(o,{select:!0,fullWidth:!0,label:"Tracking Device Type",value:y.trackingDevice.type,onChange:e=>oe("type",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg",children:[i.jsx(x,{value:"NoDevice",children:"NoDevice"}),i.jsx(x,{value:"fleet2track",children:"Fleet2Track"}),i.jsx(x,{value:"other",children:"Other"})]})}),"other"===y.trackingDevice.type&&i.jsx(r,{item:!0,xs:12,children:i.jsx(o,{fullWidth:!0,label:"Custom Tracking Device Name",value:y.trackingDevice.customName,onChange:e=>oe("customName",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})})]})]}),i.jsx(r,{item:!0,xs:12,children:i.jsx(g,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,className:"flex items-center justify-center text-lg font-semibold shadow-md hover:shadow-lg transition-shadow",children:"Update Van"})})]})})]}),J&&i.jsx(N,{isOpen:Y,onClose:()=>{Z(!1)},onSave:e=>{ae(e),f((a=>({...a,packagePrices:e,allowPackages:!0})))},initialPrices:ee})]}):i.jsx("p",{className:"text-center text-lg mt-4",children:"Loading van data..."})},P=({label:e,field:a,value:s,onChange:l,multiline:t=!1,rows:n=1})=>i.jsx(r,{item:!0,xs:12,children:i.jsx(o,{fullWidth:!0,label:e,name:a,placeholder:`Enter ${e}`,value:s,onChange:e=>l(a,"it",e.target.value),variant:"outlined",required:!0,multiline:t,rows:n,className:"bg-white rounded-lg"})}),S=({label:e,images:a,onDrop:s})=>i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600 mb-2",children:e}),i.jsxs(r,{container:!0,spacing:2,children:[a.map(((e,a)=>i.jsx(r,{item:!0,xs:6,sm:4,md:3,className:"relative",children:i.jsx("img",{src:e,alt:`Van Image ${a+1}`,className:"w-full h-64 object-cover rounded-lg shadow-md"})},a))),i.jsx(r,{item:!0,xs:6,sm:4,md:3,children:i.jsx(I,{onDrop:s})})]})]}),A=({contractImages:e,onDrop:a,onAdd:s,onRemove:l,onChange:t})=>i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600 mb-2",children:"Contract Images"}),e.map(((e,s)=>i.jsxs(r,{container:!0,spacing:2,alignItems:"center",className:"mb-4",children:[i.jsx(r,{item:!0,xs:12,sm:3,children:i.jsx(o,{fullWidth:!0,label:"Damage Type",value:e.damageType,onChange:e=>t(s,"damageType",e.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:12,sm:5,children:i.jsx(o,{fullWidth:!0,label:"Description",value:e.description,onChange:e=>t(s,"description",e.target.value),variant:"outlined",className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:6,sm:3,children:e.image?i.jsx("img",{src:e.image,alt:"Contract",className:"w-full h-24 object-cover rounded-lg shadow-md"}):i.jsx(I,{onDrop:e=>a(e,"contractImages",s)})}),i.jsx(r,{item:!0,xs:1,sm:1,children:i.jsx(d,{color:"secondary",onClick:()=>l(s),children:i.jsx(p,{})})})]},s))),i.jsx(g,{variant:"outlined",color:"primary",onClick:s,startIcon:i.jsx(b,{}),className:"mt-2",children:"Add Contract Image"})]}),D=({location:a,onChange:s,isLoaded:l})=>{const[t,c]=e.useState(null);return i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:"Location"}),l?i.jsx(y,{onLoad:e=>{c(e)},onPlaceChanged:()=>{if(t){const e=t.getPlace(),a=e.formatted_address,l=e.geometry.location.lat(),i=e.geometry.location.lng();s("location","address",a),s("location","latitude",l),s("location","longitude",i)}},children:i.jsx(o,{fullWidth:!0,label:"Address",name:"location.address",value:a.address,onChange:e=>s("location","address",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg mb-3",style:{marginBottom:"1rem"}})}):i.jsx(o,{fullWidth:!0,label:"Address",name:"location.address",value:a.address,onChange:e=>s("location","address",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg mb-3"}),i.jsxs(r,{container:!0,spacing:2,children:[i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{fullWidth:!0,label:"Latitude",name:"location.latitude",type:"number",value:a.latitude,onChange:e=>s("location","latitude",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})}),i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{fullWidth:!0,label:"Longitude",name:"location.longitude",type:"number",value:a.longitude,onChange:e=>s("location","longitude",e.target.value),variant:"outlined",required:!0,className:"bg-white rounded-lg"})})]})]})},W=({optionalFeatures:e,onChange:a})=>i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:"Optional Features"}),Object.keys(e).map((s=>i.jsx(h,{control:i.jsx(u,{checked:e[s],onChange:()=>a(s),color:"primary"}),label:s.charAt(0).toUpperCase()+s.slice(1).replace(/([A-Z])/g," $1")},s)))]}),z=({label:e,dimensions:a,onChange:s,dimensionType:l})=>i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:e}),i.jsx(r,{container:!0,spacing:1,children:["length","width","height"].map((e=>i.jsx(r,{item:!0,xs:4,children:i.jsx(o,{fullWidth:!0,label:e.charAt(0).toUpperCase()+e.slice(1),name:`${l}.${e}`,value:a[e],onChange:a=>s(l,e,a.target.value),variant:"outlined",className:"bg-white rounded-lg"})},e)))})]}),E=({weight:e,onChange:a})=>i.jsxs(r,{item:!0,xs:12,children:[i.jsx(n,{variant:"body1",className:"font-semibold text-gray-600",children:"Weight (Empty & Max Load)"}),i.jsx(r,{container:!0,spacing:2,children:["empty","maxLoad"].map((s=>i.jsx(r,{item:!0,xs:6,children:i.jsx(o,{fullWidth:!0,label:"empty"===s?"Empty Weight":"Max Load",name:`weight.${s}`,value:e[s],onChange:e=>a("weight",s,e.target.value),variant:"outlined",className:"bg-white rounded-lg"})},s)))})]}),I=({onDrop:e})=>{const{getRootProps:a,getInputProps:s}=f({onDrop:e,accept:"image/*",multiple:!1});return i.jsxs(t,{...a(),className:"border-dashed border-2 border-gray-400 rounded-lg h-48 w-full flex items-center justify-center cursor-pointer hover:border-gray-500 transition-all shadow-sm hover:shadow-md",children:[i.jsx("input",{...s()}),i.jsx(b,{className:"text-gray-400 text-3xl"})]})};export{C as default};
