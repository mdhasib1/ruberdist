import{f as u,r as i,h as g,k as c,j as o}from"./index-DLpikvjc.js";import{B as f}from"./Box-B-GTZaan.js";import{T as k}from"./Typography-Bytm3ycu.js";import{D as y}from"./Divider-BZXxc7Ka.js";import{L as j}from"./List-CP_tTsPm.js";import{L as B}from"./ListItem-Cz_o3tFU.js";import{L as T}from"./ListItemText-BaK17cQI.js";import{B as $}from"./Button-Dd5SUgtW.js";import"./useTheme-BaCcI6wb.js";import"./index-CMMxByV_.js";import"./dividerClasses-CWGPkxTW.js";import"./isMuiElement-Rh47zddv.js";import"./ButtonBase-C_wHrl86.js";import"./listItemTextClasses-c0_geO1e.js";import"./useSlot-C81N96pq.js";const m="https://rubertogo.com",R=()=>{const{lang:n}=u(),[p,a]=i.useState([]),d=g();i.useEffect(()=>{l()},[]);const l=async()=>{try{const r=localStorage.getItem("accessToken"),t=await c.get(`${m}/api/notifications`,{headers:{Authorization:`Bearer ${r}`},withCredentials:!0});a(t.data)}catch(r){console.error("Failed to fetch notifications",r)}},s=async r=>{try{const t=localStorage.getItem("accessToken");await c.put(`${m}/api/notifications/${r}/read`,{},{headers:{Authorization:`Bearer ${t}`},withCredentials:!0}),a(x=>x.map(e=>e._id===r?{...e,read:!0}:e))}catch(t){console.error("Failed to mark notification as read",t)}},h=r=>{s(r),d(`/${n}/notification/${r}`)};return o.jsxs(f,{sx:{padding:"20px",maxWidth:"800px",margin:"auto"},children:[o.jsx(k,{variant:"h4",sx:{mb:2},children:"Notifiche"}),o.jsx(y,{}),o.jsx(j,{children:p.map(r=>o.jsxs(B,{button:!0,onClick:()=>h(r._id),sx:{opacity:r.read?.5:1,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.05)"},padding:"16px",borderBottom:"1px solid #ddd"},children:[o.jsx(T,{primary:r.title,secondary:r.message,sx:{color:r.read?"#888":"#000"}}),!r.read&&o.jsx($,{variant:"outlined",color:"primary",onClick:t=>{t.stopPropagation(),s(r._id)},children:"Segna come letto"})]},r._id))})]})};export{R as default};
