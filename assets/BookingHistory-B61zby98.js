import{a as y,r as n,j as e,k as s,C as D,m as t,cn as u,b1 as T,b2 as v,aP as w,co as S,az as H,cp as P,D as C,b}from"./vendor-YnnEx5JS.js";const z="https://www.rubertogo.wedevguru.com",Y=()=>{const{userId:m,lang:o}=y(),[l,f]=n.useState([]),[r,N]=n.useState(null),[p,c]=n.useState(!1),[x,d]=n.useState(null);if(n.useEffect(()=>{(async()=>{c(!0);const h=localStorage.getItem("accessToken");if(!h){d("User is not authenticated. Please log in."),c(!1);return}try{const i=await b.get(`${z}/api/bookings/${m}`,{headers:{Authorization:`Bearer ${h}`}});f(i.data.bookings||[]),N(i.data.user||null),d(null)}catch(i){d(i.response?.data?.message||"Failed to fetch booking history.")}finally{c(!1)}})()},[m]),p)return e.jsx(s,{className:"flex justify-center items-center h-screen",children:e.jsx(D,{})});if(x)return e.jsx(s,{className:"flex justify-center items-center h-screen",children:e.jsx(t,{color:"error",variant:"h6",children:x})});const j=[{field:"vanName",headerName:"Van Name",width:200},{field:"startDate",headerName:"Start Date",width:150},{field:"endDate",headerName:"End Date",width:150},{field:"startTime",headerName:"Start Time",width:150},{field:"endTime",headerName:"End Time",width:150},{field:"totalPrice",headerName:"Total Price (CHF)",width:150},{field:"status",headerName:"Status",width:150}],g=l.map(a=>({id:a._id,vanName:a?.vanId?.name?.[o]||"Van Name",startDate:a.startDate,endDate:a.endDate,startTime:u.tz(a.startTime,"YYYY-MM-DDTHH:mm:ss",a.timeZone).format("HH:mm"),endTime:u.tz(a.endTime,"YYYY-MM-DDTHH:mm:ss",a.timeZone).format("HH:mm"),totalPrice:a.totalPrice,status:a.status.charAt(0).toUpperCase()+a.status.slice(1)}));return e.jsxs("div",{className:"container mx-auto p-6",children:[r&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(t,{variant:"h4",className:"text-center font-bold text-gray-700 mb-6",children:["Booking History ",r.firstName," ",r.lastName]}),e.jsx(t,{variant:"body2",sx:{fontSize:"1.2em",marginTop:"1rem"},children:r.email}),e.jsx(t,{variant:"body1",sx:{fontSize:"1.1em",marginTop:"0.3rem"},children:r.phone})]}),e.jsx(s,{sx:{display:{xs:"block",md:"none"}},children:l.length===0?e.jsx(t,{variant:"body1",className:"text-center text-gray-500",children:"No bookings found."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:l.map(a=>e.jsx(T,{className:"shadow-lg border border-gray-200 rounded-lg",children:e.jsxs(v,{children:[e.jsxs(s,{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{className:"text-blue-500"}),e.jsx(t,{variant:"h6",className:"font-bold",children:a?.vanId?.name?.[o]||"Van Name"})]}),e.jsxs(s,{className:"flex items-center gap-2 mb-1",children:[e.jsx(S,{className:"text-green-500"}),e.jsxs(t,{variant:"body2",className:"text-gray-600",children:[a.startDate," to ",a.endDate]})]}),e.jsxs(s,{className:"flex items-center gap-2 mb-1",children:[e.jsx(H,{className:"text-yellow-500"}),e.jsxs(t,{variant:"body2",className:"text-gray-600",children:[new Date(a.startTime).toLocaleTimeString()," -"," ",new Date(a.endTime).toLocaleTimeString()]})]}),e.jsxs(s,{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"text-green-500"}),e.jsxs(t,{variant:"body2",className:"text-gray-600",children:["Total Price: $",a.totalPrice]})]}),e.jsxs(t,{variant:"caption",className:`font-bold ${a.status==="completed"?"text-green-600":a.status==="pending"?"text-yellow-600":"text-red-600"}`,children:["Status:"," ",a.status.charAt(0).toUpperCase()+a.status.slice(1)]})]})},a._id))})}),e.jsx(s,{sx:{display:{xs:"none",md:"block"},height:500,mt:4},children:e.jsx(C,{rows:g,columns:j,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0,sx:{"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.main",color:"#000"},"& .MuiDataGrid-cell":{fontSize:"16px"}}})})]})};export{Y as default};
