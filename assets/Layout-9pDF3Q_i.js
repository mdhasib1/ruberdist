import{g as it,a as lt,r as x,u as ct,j as t,s as z,c as pt,b as C,d as dt,m as xt,e as ut,f as ht,h as ft,i as J,k as T,l as gt,R as I,L as b}from"./index-DLpikvjc.js";import{F as mt,a as bt,b as P,c as D,d as L,e as y,f as O,g as yt,h as N,i as jt,j as kt,k as vt,l as Ct,m as Bt,n as At}from"./index-DHQm9bna.js";import{I as wt}from"./index-_EW35tAF.js";import{l as St}from"./index-Rnf9BJUB.js";import{P as zt}from"./Paper-DzT7rg5Q.js";import{T as Mt,L as j}from"./Toolbar-4GwuCQeM.js";import{I as A}from"./IconButton-CQP4y5cZ.js";import{B as R}from"./Box-B-GTZaan.js";import{T as $}from"./Typography-Bytm3ycu.js";import{B as Ft}from"./Badge-VQgqQlIk.js";import{M as E}from"./Menu-BmUU4LJX.js";import{D as U}from"./Divider-BZXxc7Ka.js";import{M as k}from"./MenuItem-Dk6ToQkn.js";import{L as m}from"./ListItemText-BaK17cQI.js";import{G as Tt}from"./iconBase-VNWhYZQq.js";import{M as It,a as Pt}from"./index-CI_CW7u4.js";import{T as V}from"./index-CSmXdIie.js";import{D as W}from"./Drawer-44DBypFL.js";import{L as v}from"./List-CP_tTsPm.js";import{C as _}from"./Collapse-DFr_R2Yp.js";import{L as X}from"./ListItem-Cz_o3tFU.js";import"./useTheme-BiC74sbM.js";import"./useTheme-BaCcI6wb.js";import"./ButtonBase-C_wHrl86.js";import"./index-CMMxByV_.js";import"./Grow-BubuCfXA.js";import"./useSlot-C81N96pq.js";import"./Portal-C-Oqgn3D.js";import"./Modal-CXdfSMMy.js";import"./dividerClasses-CWGPkxTW.js";import"./listItemTextClasses-c0_geO1e.js";import"./isMuiElement-Rh47zddv.js";function Dt(o){return it("MuiAppBar",o)}lt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Lt=o=>{const{color:e,position:s,classes:i}=o,c={root:["root",`color${C(e)}`,`position${C(s)}`]};return dt(c,Dt,i)},G=(o,e)=>o?`${o==null?void 0:o.replace(")","")}, ${e})`:e,Ot=z(zt,{name:"MuiAppBar",slot:"Root",overridesResolver:(o,e)=>{const{ownerState:s}=o;return[e.root,e[`position${C(s.position)}`],e[`color${C(s.color)}`]]}})(xt(({theme:o})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(o.vars||o).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":o.vars?o.vars.palette.AppBar.defaultBg:o.palette.grey[100],"--AppBar-color":o.vars?o.vars.palette.text.primary:o.palette.getContrastText(o.palette.grey[100]),...o.applyStyles("dark",{"--AppBar-background":o.vars?o.vars.palette.AppBar.defaultBg:o.palette.grey[900],"--AppBar-color":o.vars?o.vars.palette.text.primary:o.palette.getContrastText(o.palette.grey[900])})}},...Object.entries(o.palette).filter(ut(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(o.vars??o).palette[e].main,"--AppBar-color":(o.vars??o).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...o.applyStyles("dark",{backgroundColor:o.vars?G(o.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:o.vars?G(o.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...o.applyStyles("dark",{backgroundImage:"none"})}}]}))),Nt=x.forwardRef(function(e,s){const i=ct({props:e,name:"MuiAppBar"}),{className:c,color:f="primary",enableColorOnDark:d=!1,position:u="fixed",...l}=i,a={...i,color:f,position:u,enableColorOnDark:d},n=Lt(a);return t.jsx(Ot,{square:!0,component:"header",ownerState:a,elevation:4,className:pt(n.root,c,u==="fixed"&&"mui-fixed"),ref:s,...l})}),Rt="/rubertogo-logo-white.svg",S="https://rubertogo.com",$t=localStorage.getItem("accessToken"),w=St(S,{withCredentials:!0,auth:{token:$t},reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3}),H=new Audio("/mixkit-bell-notification-933.wav");function Et(o){const s=o.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(s).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(i)}function Ut({onMenuClick:o}){const{lang:e}=ht(),[s,i]=x.useState(null),[c,f]=x.useState([]),[d,u]=x.useState(null),[l,a]=x.useState(0),n=ft(),h=localStorage.getItem("accessToken"),g=Et(h),{userRole:K,logout:Y}=J();x.useEffect(()=>(g&&g.id?w.emit("join",g.id):console.error("User ID not found in token."),w.on("notification",r=>{f(p=>[r,...p]),a(p=>p+1),tt()}),Z(),()=>{w.off("notification")}),[]);const Z=async()=>{try{const r=await T.get(`${S}/api/notifications`,{headers:{Authorization:`Bearer ${h}`},withCredentials:!0});f(r.data),a(r.data.filter(p=>!p.read).length)}catch(r){console.error("Failed to fetch notifications",r)}},tt=()=>{H.play().catch(r=>{console.error("Notification sound playback failed:",r),document.body.addEventListener("click",()=>H.play().catch(console.error),{once:!0})})},ot=r=>{i(r.currentTarget)},at=r=>{u(r.currentTarget)},M=()=>{i(null)},F=()=>{u(null)},et=()=>Y(),rt=async r=>{try{await T.put(`${S}/api/notifications/${r}/read`,{},{headers:{Authorization:`Bearer ${h}`},withCredentials:!0}),f(p=>p.map(B=>B._id===r?{...B,read:!0}:B)),a(p=>p-1)}catch(p){console.error("Failed to mark notification as read",p)}},nt=r=>{rt(r._id),F(),n(`/${e}/system/notification/${r._id}`)},st=()=>{M(),n(`/${e}/system/site-content`)};return t.jsx(Nt,{position:"fixed",sx:{backgroundColor:"#ff0707",zIndex:r=>r.zIndex.drawer+1},children:t.jsxs(Mt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(A,{color:"inherit",edge:"start",sx:{display:{xs:"block",sm:"none"},mr:2},onClick:o,children:t.jsx(mt,{size:20})}),t.jsxs(R,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[t.jsx("img",{src:Rt,alt:"Company Logo",style:{maxWidth:"190px",height:"auto"}}),t.jsx($,{variant:"h6",sx:{ml:2,display:{xs:"none",sm:"block"},fontWeight:"bold",color:"#fff"},children:K==="admin"?"Admin Dashboard":"Partner Dashboard"})]}),t.jsxs(R,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(A,{color:"inherit",onClick:at,children:t.jsx(Ft,{badgeContent:l,color:"error",children:t.jsx(wt,{size:24,className:"text-white"})})}),t.jsxs(E,{anchorEl:d,open:!!d,onClose:F,PaperProps:{sx:{bgcolor:"#021e49",color:"#fff",width:400}},children:[t.jsx($,{variant:"h6",sx:{padding:"10px 16px",color:"#fff"},children:"Notifications"}),t.jsx(U,{}),c.slice(0,5).map(r=>t.jsx(k,{onClick:()=>nt(r),sx:{opacity:r.read?.5:1,color:"#fff","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:t.jsx(m,{primary:r.title,secondary:r.message,sx:{"& .MuiTypography-root":{color:"#fff"}}})},r._id)),t.jsx(U,{}),t.jsx(k,{onClick:()=>n(`/${e}/system/notifications`),children:"View All Notifications"})]}),t.jsx(A,{color:"inherit",onClick:ot,children:t.jsx(bt,{size:24,className:"text-white"})}),t.jsxs(E,{anchorEl:s,open:!!s,onClose:M,PaperProps:{sx:{bgcolor:"#021e49",color:"#fff"}},sx:{mt:2},children:[t.jsx(k,{onClick:st,sx:{"&:hover":{backgroundColor:"#fff"}},children:"Settings"}),t.jsx(k,{onClick:et,sx:{"&:hover":{backgroundColor:"#fff"}},children:"Logout"})]})]})]})})}function Vt(o){return Tt({attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#42A5F5",d:"M39,45H9c0,0-3-0.1-3-8h36C42,44.9,39,45,39,45z"},child:[]},{tag:"rect",attr:{x:"8",y:"3",fill:"#90CAF9",width:"32",height:"34"},child:[]},{tag:"g",attr:{fill:"#1976D2"},child:[{tag:"rect",attr:{x:"18",y:"15",width:"16",height:"2"},child:[]},{tag:"rect",attr:{x:"18",y:"19",width:"16",height:"2"},child:[]},{tag:"rect",attr:{x:"18",y:"23",width:"16",height:"2"},child:[]},{tag:"rect",attr:{x:"18",y:"27",width:"16",height:"2"},child:[]},{tag:"rect",attr:{x:"18",y:"31",width:"16",height:"2"},child:[]}]},{tag:"g",attr:{fill:"#1976D2"},child:[{tag:"rect",attr:{x:"14",y:"15",width:"2",height:"2"},child:[]},{tag:"rect",attr:{x:"14",y:"19",width:"2",height:"2"},child:[]},{tag:"rect",attr:{x:"14",y:"23",width:"2",height:"2"},child:[]},{tag:"rect",attr:{x:"14",y:"27",width:"2",height:"2"},child:[]},{tag:"rect",attr:{x:"14",y:"31",width:"2",height:"2"},child:[]}]}]})(o)}const Wt={admin:[{text:"Overview",icon:t.jsx(L,{size:20}),path:"/:lang/admin/overview"},{text:"Booked Monitoring",icon:t.jsx(jt,{size:20}),path:"/:lang/admin/monitoring"},{text:"All Customers",icon:t.jsx(y,{size:20}),path:"/:lang/admin/users"},{text:"Cupons",icon:t.jsx(kt,{size:20}),path:"/:lang/admin/cupons"},{text:"Vans",icon:t.jsx(O,{size:20}),path:"/:lang/admin/vans",submenu:[{text:"Add Van",icon:t.jsx(y,{size:20}),path:"/:lang/admin/vans/add"}]},{text:"All Products",icon:t.jsx(vt,{size:20}),path:"/:lang/admin/all-product",submenu:[{text:"Add Product",icon:t.jsx(It,{size:20}),path:"/:lang/admin/add-product"}]},{text:"Packages",icon:t.jsx(Ct,{size:20}),path:"/:lang/admin/packages"},{text:"Reviews",icon:t.jsx(Pt,{size:20}),path:"/:lang/admin/reviews"},{text:"Booking Settings",icon:t.jsx(V,{size:20}),path:"/:lang/admin/booking/settings"},{text:"Earning Settings",icon:t.jsx(N,{size:20}),path:"/:lang/admin/earning-settings"},{text:"Withdrawals",icon:t.jsx(Bt,{size:20}),path:"/:lang/admin/withdrawals"},{text:"Our Partners",icon:t.jsx(y,{size:20}),path:"/:lang/admin/our-partners"},{text:"FAQ Management",icon:t.jsx(At,{size:20}),path:"/:lang/admin/faqs"},{text:"Rules Settings",icon:t.jsx(Vt,{size:20}),path:"/:lang/admin/contract"}],partner:[{text:"Overview",icon:t.jsx(L,{size:20}),path:"/:lang/partner/dashboard"},{text:"My Vans",icon:t.jsx(O,{size:20}),path:"/:lang/partner/vans",submenu:[{text:"Add Van",icon:t.jsx(y,{size:20}),path:"/:lang/partner/vans/add-van"}]},{text:"All Bookings",icon:t.jsx(V,{size:20}),path:"/:lang/partner/bookings"},{text:" Withdrawals",icon:t.jsx(N,{size:20}),path:"/:lang/partner/withdrawals",submenu:[{text:"Bank Details",icon:t.jsx(yt,{size:20}),path:"/:lang/partner/bank-details"}]}]},Q=z(X)(({active:o})=>({backgroundColor:o?"#021e49":"transparent",color:o?"#ffffff":"#fff",borderLeft:o?"4px solid #ffffff":"4px solid transparent","&:hover":{backgroundColor:"#021e49",color:"#ffffff"}})),q=z(X)(({active:o})=>({backgroundColor:o?"#123564":"transparent",color:o?"#ffffff":"#bbb",paddingLeft:"32px",borderLeft:o?"4px solid #ffffff":"4px solid transparent","&:hover":{backgroundColor:"#123564",color:"#ffffff"}})),_t=({open:o,onClose:e})=>{const s=gt(),[i,c]=x.useState(null),{userRole:f}=J(),d=Wt[f]||[],u=a=>{c(n=>n===a?null:a)},l=a=>{const n=s.pathname.split("/")[1],h=a.replace(":lang",n);return s.pathname.startsWith(h)};return x.useEffect(()=>{const a=d.find(n=>{var h;return(h=n.submenu)==null?void 0:h.some(g=>l(g.path))});a&&c(a.text)},[s.pathname,d]),t.jsxs("div",{children:[t.jsx(W,{variant:"permanent",sx:{width:250,flexShrink:0,display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{width:250,boxSizing:"border-box",backgroundColor:"#ff0707"}},children:t.jsx(v,{sx:{pt:10},children:d.map(a=>t.jsxs(I.Fragment,{children:[t.jsxs(Q,{component:b,to:a.path.replace(":lang",s.pathname.split("/")[1]),active:l(a.path)?1:0,onClick:()=>a.submenu&&u(a.text),button:!0,children:[t.jsx(j,{sx:{color:(l(a.path),"#fff")},children:a.icon}),t.jsx(m,{primary:a.text}),a.submenu&&(i===a.text?t.jsx(P,{}):t.jsx(D,{}))]}),a.submenu&&t.jsx(_,{in:i===a.text,timeout:"auto",unmountOnExit:!0,children:t.jsx(v,{component:"div",disablePadding:!0,children:a.submenu.map(n=>t.jsxs(q,{component:b,to:n.path.replace(":lang",s.pathname.split("/")[1]),active:l(n.path)?1:0,children:[t.jsx(j,{sx:{color:l(n.path)?"#fff":"#bbb"},children:n.icon}),t.jsx(m,{primary:n.text})]},n.text))})})]},a.text))})}),t.jsx(W,{variant:"temporary",open:o,onClose:e,sx:{"& .MuiDrawer-paper":{width:250,boxSizing:"border-box",backgroundColor:"#021e49"},display:{xs:"block",sm:"none"}},ModalProps:{keepMounted:!0},children:t.jsx(v,{sx:{pt:8},children:d.map(a=>t.jsxs(I.Fragment,{children:[t.jsxs(Q,{component:b,to:a.path.replace(":lang",s.pathname.split("/")[1]),active:l(a.path)?1:0,onClick:()=>a.submenu&&u(a.text),button:!0,children:[t.jsx(j,{sx:{color:l(a.path)?"#fff":"#ccc"},children:a.icon}),t.jsx(m,{primary:a.text}),a.submenu&&(i===a.text?t.jsx(P,{}):t.jsx(D,{}))]}),a.submenu&&t.jsx(_,{in:i===a.text,timeout:"auto",unmountOnExit:!0,children:t.jsx(v,{component:"div",disablePadding:!0,children:a.submenu.map(n=>t.jsxs(q,{component:b,to:n.path.replace(":lang",s.pathname.split("/")[1]),active:l(n.path)?1:0,children:[t.jsx(j,{sx:{color:l(n.path)?"#fff":"#bbb"},children:n.icon}),t.jsx(m,{primary:n.text})]},n.text))})})]},a.text))})})]})};function Bo({children:o}){const[e,s]=x.useState(!1),i=()=>{s(!e)},c=()=>{s(!1)};return t.jsxs("div",{style:{display:"flex",minHeight:"100vh",overflowX:"hidden"},children:[t.jsx(Ut,{onMenuClick:i}),t.jsx(_t,{open:e,onClose:c}),t.jsx("main",{style:{flexGrow:1,padding:"0px",marginTop:64},children:o})]})}export{Bo as default};
