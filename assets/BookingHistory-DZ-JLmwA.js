import{f as T,r as l,j as e,U as v,k as D}from"./index-DLpikvjc.js";import{t as S,a2 as w,A as C,a3 as P}from"./index-DHQm9bna.js";import{B as i}from"./Box-B-GTZaan.js";import{T as a}from"./Typography-Bytm3ycu.js";import{C as B}from"./Card-BFFjdakV.js";import{C as A}from"./CardContent-CH1CvUAA.js";import{D as E}from"./DataGrid-0EYBgjNF.js";import"./iconBase-VNWhYZQq.js";import"./useTheme-BaCcI6wb.js";import"./index-CMMxByV_.js";import"./Paper-DzT7rg5Q.js";import"./useTheme-BiC74sbM.js";import"./index-BCUionA9.js";import"./ButtonBase-C_wHrl86.js";import"./Portal-C-Oqgn3D.js";import"./Select-YDvcYVIq.js";import"./Menu-BmUU4LJX.js";import"./Grow-BubuCfXA.js";import"./useSlot-C81N96pq.js";import"./List-CP_tTsPm.js";import"./Modal-CXdfSMMy.js";import"./useControlled-DAqY8FYl.js";import"./createSvgIcon-DAAY2Ss0.js";import"./Close-B6mu1L3C.js";import"./Badge-VQgqQlIk.js";import"./Tooltip-Cxmz8oas.js";import"./Chip-CF_ffCUn.js";import"./IconButton-CQP4y5cZ.js";import"./ClickAwayListener-ChyV3r07.js";import"./MenuItem-Dk6ToQkn.js";import"./listItemTextClasses-c0_geO1e.js";import"./dividerClasses-CWGPkxTW.js";import"./Toolbar-4GwuCQeM.js";import"./ListItemText-BaK17cQI.js";import"./TextField-DxLbd0T7.js";import"./isMuiElement-Rh47zddv.js";import"./InputAdornment-Dr7QdbWB.js";import"./Button-Dd5SUgtW.js";import"./Divider-BZXxc7Ka.js";import"./FormControlLabel-BZ90GYya.js";import"./TableCell-Bsl3T8tX.js";import"./Skeleton-CuRxEDba.js";const F="https://rubertogo.com",ge=()=>{const{userId:p,lang:x}=T(),[n,u]=l.useState([]),[m,N]=l.useState(null),[j,c]=l.useState(!1),[h,d]=l.useState(null);if(l.useEffect(()=>{(async()=>{var r,f;c(!0);const s=localStorage.getItem("accessToken");if(!s){d("User is not authenticated. Please log in."),c(!1);return}try{const o=await D.get(`${F}/api/bookings/${p}`,{headers:{Authorization:`Bearer ${s}`}});u(o.data.bookings||[]),N(o.data.user||null),d(null)}catch(o){d(((f=(r=o.response)==null?void 0:r.data)==null?void 0:f.message)||"Failed to fetch booking history.")}finally{c(!1)}})()},[p]),j)return e.jsx(i,{className:"flex justify-center items-center h-screen",children:e.jsx(v,{})});if(h)return e.jsx(i,{className:"flex justify-center items-center h-screen",children:e.jsx(a,{color:"error",variant:"h6",children:h})});const y=[{field:"vanName",headerName:"Van Name",width:200},{field:"startDate",headerName:"Start Date",width:150},{field:"endDate",headerName:"End Date",width:150},{field:"startTime",headerName:"Start Time",width:150},{field:"endTime",headerName:"End Time",width:150},{field:"totalPrice",headerName:"Total Price (CHF)",width:150},{field:"status",headerName:"Status",width:150}],g=n.map(t=>{var s,r;return{id:t._id,vanName:((r=(s=t==null?void 0:t.vanId)==null?void 0:s.name)==null?void 0:r[x])||"Van Name",startDate:t.startDate,endDate:t.endDate,startTime:new Date(t.startTime).toLocaleTimeString(),endTime:new Date(t.endTime).toLocaleTimeString(),totalPrice:t.totalPrice,status:t.status.charAt(0).toUpperCase()+t.status.slice(1)}});return e.jsxs("div",{className:"container mx-auto p-6",children:[m&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(a,{variant:"h4",className:"text-center font-bold text-gray-700 mb-6",children:["Booking History ",m.firstName," ",m.lastName]}),e.jsx(a,{variant:"body2",sx:{fontSize:"1.2em",marginTop:"1rem"},children:m.email}),e.jsx(a,{variant:"body1",sx:{fontSize:"1.1em",marginTop:"0.3rem"},children:m.phone})]}),e.jsx(i,{sx:{display:{xs:"block",md:"none"}},children:n.length===0?e.jsx(a,{variant:"body1",className:"text-center text-gray-500",children:"No bookings found."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:n.map(t=>{var s,r;return e.jsx(B,{className:"shadow-lg border border-gray-200 rounded-lg",children:e.jsxs(A,{children:[e.jsxs(i,{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{className:"text-blue-500"}),e.jsx(a,{variant:"h6",className:"font-bold",children:((r=(s=t==null?void 0:t.vanId)==null?void 0:s.name)==null?void 0:r[x])||"Van Name"})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-1",children:[e.jsx(w,{className:"text-green-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:[t.startDate," to ",t.endDate]})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-1",children:[e.jsx(C,{className:"text-yellow-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:[new Date(t.startTime).toLocaleTimeString()," -"," ",new Date(t.endTime).toLocaleTimeString()]})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"text-green-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:["Total Price: $",t.totalPrice]})]}),e.jsxs(a,{variant:"caption",className:`font-bold ${t.status==="completed"?"text-green-600":t.status==="pending"?"text-yellow-600":"text-red-600"}`,children:["Status:"," ",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})]})},t._id)})})}),e.jsx(i,{sx:{display:{xs:"none",md:"block"},height:500,mt:4},children:e.jsx(E,{rows:g,columns:y,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0,sx:{"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.main",color:"#000"},"& .MuiDataGrid-cell":{fontSize:"16px"}}})})]})};export{ge as default};
