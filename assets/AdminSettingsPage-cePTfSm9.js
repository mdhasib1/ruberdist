import{r,j as e}from"./index-DrMvIKwq.js";import{A as E}from"./index-Bc-nvAfN.js";import"./iconBase-BBLIWj70.js";const u="https://rubertogo.com",A=()=>{const[g,f]=r.useState([]),[l,k]=r.useState(""),[o,b]=r.useState({freeHours:10,minimumPaidHours:3,freePeriodStart:"21:00",blockedDateHours:[],bookingEnabled:!1}),[i,p]=r.useState(""),[d,h]=r.useState([]),[j,c]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const a=await(await fetch(`${u}/api/vans`)).json();f(a)}catch(t){console.error("Error fetching vans:",t)}})()},[]),r.useEffect(()=>{l&&(async()=>{try{const a=await(await fetch(`${u}/api/booking-settings/${l}`)).json();b({freeHours:a.freeHours||10,minimumPaidHours:a.minimumPaidHours||3,freePeriodStart:a.freePeriodStart||"21:00",blockedDateHours:Array.isArray(a.blockedDateHours)?a.blockedDateHours:[],bookingEnabled:a.bookingEnabled||!1}),p(""),h([])}catch(t){console.error("Error fetching booking settings:",t)}})()},[l]);const S=s=>{k(s.target.value)},v=s=>{p(s);const t=o.blockedDateHours.find(a=>new Date(a.date).toISOString().split("T")[0]===s);h(t?t.hours:[])},N=async s=>{const t=d.includes(s)?d.filter(n=>n!==s):[...d,s];h(t);const a=o.blockedDateHours.filter(n=>new Date(n.date).toISOString().split("T")[0]!==i);t.length>0&&a.push({date:i,hours:t}),b(n=>({...n,blockedDateHours:a}));try{await fetch(`${u}/api/booking-settings/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({blockedDateHours:a})}),c(!0),setTimeout(()=>c(!1),3e3)}catch(n){console.error("Error updating blocked hours:",n)}},m=s=>{const{name:t,value:a,type:n,checked:H}=s.target;b(w=>({...w,[t]:n==="checkbox"?H:a})),c(!1)},y=async()=>{try{await fetch(`${u}/api/booking-settings/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(o)}),c(!0),setTimeout(()=>c(!1),3e3)}catch(s){console.error("Error saving settings:",s)}},x=Array.from({length:24},(s,t)=>`${t<10?"0":""}${t}:00`);return e.jsx("div",{className:"p-6 bg-gray-100 min-h-screen",children:e.jsxs("div",{className:"max-w-full mx-auto bg-white shadow-lg p-6 rounded-lg",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Admin Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Select Van"}),e.jsxs("select",{value:l,onChange:S,className:"border p-2 w-full rounded-md",children:[e.jsx("option",{value:"",children:"Select a van"}),Array.isArray(g)&&g.map(s=>e.jsx("option",{value:s._id,children:s.name.en},s._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Booking Enabled"}),e.jsx("input",{type:"checkbox",name:"bookingEnabled",checked:o.bookingEnabled,onChange:m,className:"mr-2"}),e.jsx("span",{children:o.bookingEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Free Period Start"}),e.jsx("select",{name:"freePeriodStart",value:o.freePeriodStart,onChange:m,className:"border p-2 w-full rounded-md",children:x.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Free Hours"}),e.jsx("input",{type:"number",name:"freeHours",value:o.freeHours||"",onChange:m,className:"border p-2 w-full rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Minimum Paid Hours"}),e.jsx("input",{type:"number",name:"minimumPaidHours",value:o.minimumPaidHours||"",onChange:m,className:"border p-2 w-full rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Blocked Date"}),e.jsx("input",{type:"date",value:i,onChange:s=>v(s.target.value),className:"border p-2 w-full rounded-md",disabled:!l})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Blocked Hours"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",value:s,checked:d.includes(s),onChange:()=>N(s),className:"mr-2",disabled:!i}),s]},s))})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:y,className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-md hover:bg-blue-700 transition duration-300",children:"Save Settings"})}),j&&e.jsxs("div",{className:"mt-4 text-green-600 flex items-center",children:[e.jsx(E,{className:"mr-2"}),"Settings saved successfully!"]})]})})};export{A as default};
