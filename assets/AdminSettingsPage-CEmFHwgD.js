import{r as e,j as s,bD as a}from"./vendor-Zgq9WbFI.js";const t="https://rubertogo.com",r=()=>{const[r,l]=e.useState([]),[o,n]=e.useState(""),[i,c]=e.useState({freeHours:10,minimumPaidHours:3,freePeriodStart:"21:00",blockedDateHours:[],bookingEnabled:!1}),[d,m]=e.useState(""),[u,b]=e.useState([]),[h,g]=e.useState(!1);e.useEffect((()=>{(async()=>{try{const e=await fetch(`${t}/api/vans`),s=await e.json();l(s)}catch(e){console.error("Error fetching vans:",e)}})()}),[]),e.useEffect((()=>{if(o){(async()=>{try{const e=await fetch(`${t}/api/booking-settings/${o}`),s=await e.json();c({freeHours:s.freeHours||10,minimumPaidHours:s.minimumPaidHours||3,freePeriodStart:s.freePeriodStart||"21:00",blockedDateHours:Array.isArray(s.blockedDateHours)?s.blockedDateHours:[],bookingEnabled:s.bookingEnabled||!1}),m(""),b([])}catch(e){console.error("Error fetching booking settings:",e)}})()}}),[o]);const x=e=>{const{name:s,value:a,type:t,checked:r}=e.target;c((e=>({...e,[s]:"checkbox"===t?r:a}))),g(!1)},p=Array.from({length:24},((e,s)=>`${s<10?"0":""}${s}:00`));return s.jsx("div",{className:"p-6 bg-gray-100 min-h-screen",children:s.jsxs("div",{className:"max-w-full mx-auto bg-white shadow-lg p-6 rounded-lg",children:[s.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Admin Settings"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Select Van"}),s.jsxs("select",{value:o,onChange:e=>{n(e.target.value)},className:"border p-2 w-full rounded-md",children:[s.jsx("option",{value:"",children:"Select a van"}),Array.isArray(r)&&r.map((e=>s.jsx("option",{value:e._id,children:e.name.en},e._id)))]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Booking Enabled"}),s.jsx("input",{type:"checkbox",name:"bookingEnabled",checked:i.bookingEnabled,onChange:x,className:"mr-2"}),s.jsx("span",{children:i.bookingEnabled?"Enabled":"Disabled"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Free Period Start"}),s.jsx("select",{name:"freePeriodStart",value:i.freePeriodStart,onChange:x,className:"border p-2 w-full rounded-md",children:p.map((e=>s.jsx("option",{value:e,children:e},e)))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Free Hours"}),s.jsx("input",{type:"number",name:"freeHours",value:i.freeHours||"",onChange:x,className:"border p-2 w-full rounded-md"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Minimum Paid Hours"}),s.jsx("input",{type:"number",name:"minimumPaidHours",value:i.minimumPaidHours||"",onChange:x,className:"border p-2 w-full rounded-md"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Blocked Date"}),s.jsx("input",{type:"date",value:d,onChange:e=>(e=>{m(e);const s=i.blockedDateHours.find((s=>new Date(s.date).toISOString().split("T")[0]===e));b(s?s.hours:[])})(e.target.value),className:"border p-2 w-full rounded-md",disabled:!o})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-lg mb-2",children:"Blocked Hours"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:p.map((e=>s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",value:e,checked:u.includes(e),onChange:()=>(async e=>{const s=u.includes(e)?u.filter((s=>s!==e)):[...u,e];b(s);const a=i.blockedDateHours.filter((e=>new Date(e.date).toISOString().split("T")[0]!==d));s.length>0&&a.push({date:d,hours:s}),c((e=>({...e,blockedDateHours:a})));try{await fetch(`${t}/api/booking-settings/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({blockedDateHours:a})}),g(!0),setTimeout((()=>g(!1)),3e3)}catch(r){console.error("Error updating blocked hours:",r)}})(e),className:"mr-2",disabled:!d}),e]},e)))})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:async()=>{try{await fetch(`${t}/api/booking-settings/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(i)}),g(!0),setTimeout((()=>g(!1)),3e3)}catch(e){console.error("Error saving settings:",e)}},className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-md hover:bg-blue-700 transition duration-300",children:"Save Settings"})}),h&&s.jsxs("div",{className:"mt-4 text-green-600 flex items-center",children:[s.jsx(a,{className:"mr-2"}),"Settings saved successfully!"]})]})})};export{r as default};
