import{a as e,r as t,u as n,l as a,b as s,j as o,A as i,T as r,I as l,F as c,f as d,g as x,h as p,i as h,M as f,D as u,k as m,L as g,n as j,c as b,o as k,p as v,q as y,s as C,t as w,v as z,w as S,x as A,C as P,y as M,z as I,E,G as $,H as B,J as D,K as L,O,P as T,S as F,U as N,V,W,X as R,Y as _,Z as G}from"./vendor-Zgq9WbFI.js";import{u as U}from"./index-D29cp_SG.js";const q="https://rubertogo.com",H=localStorage.getItem("accessToken"),J=a(q,{withCredentials:!0,auth:{token:H},reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3}),X=new Audio("/mixkit-bell-notification-933.wav");function K({onMenuClick:a}){const{lang:b}=e(),[k,v]=t.useState(null),[y,C]=t.useState([]),[w,z]=t.useState(null),[S,A]=t.useState(0),P=n(),M=localStorage.getItem("accessToken"),I=function(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(n)}(M),{userRole:E,logout:$}=U();t.useEffect((()=>(I&&I.id?J.emit("join",I.id):console.error("User ID not found in token."),J.on("notification",(e=>{C((t=>[e,...t])),A((e=>e+1)),D()})),B(),()=>{J.off("notification")})),[]);const B=async()=>{try{const e=await s.get(`${q}/api/notifications`,{headers:{Authorization:`Bearer ${M}`},withCredentials:!0});C(e.data),A(e.data.filter((e=>!e.read)).length)}catch(e){console.error("Failed to fetch notifications",e)}},D=()=>{X.play().catch((e=>{console.error("Notification sound playback failed:",e),document.body.addEventListener("click",(()=>X.play().catch(console.error)),{once:!0})}))},L=()=>{v(null)},O=()=>{z(null)},T=e=>{(async e=>{try{await s.put(`${q}/api/notifications/${e}/read`,{},{headers:{Authorization:`Bearer ${M}`},withCredentials:!0}),C((t=>t.map((t=>t._id===e?{...t,read:!0}:t)))),A((e=>e-1))}catch(t){console.error("Failed to mark notification as read",t)}})(e._id),O(),P(`/${b}/system/notification/${e._id}`)};return o.jsx(i,{position:"fixed",sx:{backgroundColor:"#ff0707",zIndex:e=>e.zIndex.drawer+1},children:o.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(l,{color:"inherit",edge:"start",sx:{display:{xs:"block",sm:"none"},mr:2},onClick:a,children:o.jsx(c,{size:20})}),o.jsxs(d,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[o.jsx("img",{src:"/rubertogo-logo-white.svg",alt:"Company Logo",style:{maxWidth:"190px",height:"auto"}}),o.jsx(x,{variant:"h6",sx:{ml:2,display:{xs:"none",sm:"block"},fontWeight:"bold",color:"#fff"},children:"admin"===E?"Admin Dashboard":"Partner Dashboard"})]}),o.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[o.jsx(l,{color:"inherit",onClick:e=>{z(e.currentTarget)},children:o.jsx(p,{badgeContent:S,color:"error",children:o.jsx(h,{size:24,className:"text-white"})})}),o.jsxs(f,{anchorEl:w,open:Boolean(w),onClose:O,PaperProps:{sx:{bgcolor:"#021e49",color:"#fff",width:400}},children:[o.jsx(x,{variant:"h6",sx:{padding:"10px 16px",color:"#fff"},children:"Notifications"}),o.jsx(u,{}),y.slice(0,5).map((e=>o.jsx(m,{onClick:()=>T(e),sx:{opacity:e.read?.5:1,color:"#fff","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:o.jsx(g,{primary:e.title,secondary:e.message,sx:{"& .MuiTypography-root":{color:"#fff"}}})},e._id))),o.jsx(u,{}),o.jsx(m,{onClick:()=>P(`/${b}/system/notifications`),children:"View All Notifications"})]}),o.jsx(l,{color:"inherit",onClick:e=>{v(e.currentTarget)},children:o.jsx(j,{size:24,className:"text-white"})}),o.jsxs(f,{anchorEl:k,open:Boolean(k),onClose:L,PaperProps:{sx:{bgcolor:"#021e49",color:"#fff"}},sx:{mt:2},children:[o.jsx(m,{onClick:()=>{L(),P(`/${b}/system/site-content`)},sx:{"&:hover":{backgroundColor:"#fff"}},children:"Settings"}),o.jsx(m,{onClick:()=>$(),sx:{"&:hover":{backgroundColor:"#fff"}},children:"Logout"})]})]})]})})}const Q={admin:[{text:"Overview",icon:o.jsx(M,{size:20}),path:"/:lang/admin/overview"},{text:"Booked Monitoring",icon:o.jsx(L,{size:20}),path:"/:lang/admin/monitoring"},{text:"All Customers",icon:o.jsx(I,{size:20}),path:"/:lang/admin/users"},{text:"Cupons",icon:o.jsx(O,{size:20}),path:"/:lang/admin/cupons"},{text:"Vans",icon:o.jsx(E,{size:20}),path:"/:lang/admin/vans",submenu:[{text:"Add Van",icon:o.jsx(I,{size:20}),path:"/:lang/admin/vans/add"}]},{text:"All Products",icon:o.jsx(F,{size:20}),path:"/:lang/admin/all-product",submenu:[{text:"Add Product",icon:o.jsx(T,{size:20}),path:"/:lang/admin/add-product"}]},{text:"Packages",icon:o.jsx(N,{size:20}),path:"/:lang/admin/packages"},{text:"Reviews",icon:o.jsx(V,{size:20}),path:"/:lang/admin/reviews"},{text:"Booking Settings",icon:o.jsx($,{size:20}),path:"/:lang/admin/booking/settings"},{text:"Earning Settings",icon:o.jsx(D,{size:20}),path:"/:lang/admin/earning-settings"},{text:"Withdrawals",icon:o.jsx(W,{size:20}),path:"/:lang/admin/withdrawals"},{text:"Our Partners",icon:o.jsx(I,{size:20}),path:"/:lang/admin/our-partners"},{text:"FAQ Management",icon:o.jsx(R,{size:20}),path:"/:lang/admin/faqs"},{text:"Rules Settings",icon:o.jsx(_,{size:20}),path:"/:lang/admin/contract"}],partner:[{text:"Overview",icon:o.jsx(M,{size:20}),path:"/:lang/partner/dashboard"},{text:"My Vans",icon:o.jsx(E,{size:20}),path:"/:lang/partner/vans",submenu:[{text:"Add Van",icon:o.jsx(I,{size:20}),path:"/:lang/partner/vans/add-van"}]},{text:"All Bookings",icon:o.jsx($,{size:20}),path:"/:lang/partner/bookings"},{text:" Withdrawals",icon:o.jsx(D,{size:20}),path:"/:lang/partner/withdrawals",submenu:[{text:"Bank Details",icon:o.jsx(B,{size:20}),path:"/:lang/partner/bank-details"}]}]},Y=C(G)((({active:e})=>({backgroundColor:e?"#021e49":"transparent",color:e?"#ffffff":"#fff",borderLeft:e?"4px solid #ffffff":"4px solid transparent","&:hover":{backgroundColor:"#021e49",color:"#ffffff"}}))),Z=C(G)((({active:e})=>({backgroundColor:e?"#123564":"transparent",color:e?"#ffffff":"#bbb",paddingLeft:"32px",borderLeft:e?"4px solid #ffffff":"4px solid transparent","&:hover":{backgroundColor:"#123564",color:"#ffffff"}}))),ee=({open:e,onClose:n})=>{const a=b(),[s,i]=t.useState(null),{userRole:r}=U(),l=Q[r]||[],c=e=>{i((t=>t===e?null:e))},d=e=>{const t=a.pathname.split("/")[1],n=e.replace(":lang",t);return a.pathname.startsWith(n)};return t.useEffect((()=>{const e=l.find((e=>{var t;return null==(t=e.submenu)?void 0:t.some((e=>d(e.path)))}));e&&i(e.text)}),[a.pathname,l]),o.jsxs("div",{children:[o.jsx(k,{variant:"permanent",sx:{width:250,flexShrink:0,display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{width:250,boxSizing:"border-box",backgroundColor:"#ff0707"}},children:o.jsx(v,{sx:{pt:10},children:l.map((e=>o.jsxs(y.Fragment,{children:[o.jsxs(Y,{component:w,to:e.path.replace(":lang",a.pathname.split("/")[1]),active:d(e.path)?1:0,onClick:()=>e.submenu&&c(e.text),button:!0,children:[o.jsx(z,{sx:{color:(d(e.path),"#fff")},children:e.icon}),o.jsx(g,{primary:e.text}),e.submenu&&(s===e.text?o.jsx(S,{}):o.jsx(A,{}))]}),e.submenu&&o.jsx(P,{in:s===e.text,timeout:"auto",unmountOnExit:!0,children:o.jsx(v,{component:"div",disablePadding:!0,children:e.submenu.map((e=>o.jsxs(Z,{component:w,to:e.path.replace(":lang",a.pathname.split("/")[1]),active:d(e.path)?1:0,children:[o.jsx(z,{sx:{color:d(e.path)?"#fff":"#bbb"},children:e.icon}),o.jsx(g,{primary:e.text})]},e.text)))})})]},e.text)))})}),o.jsx(k,{variant:"temporary",open:e,onClose:n,sx:{"& .MuiDrawer-paper":{width:250,boxSizing:"border-box",backgroundColor:"#021e49"},display:{xs:"block",sm:"none"}},ModalProps:{keepMounted:!0},children:o.jsx(v,{sx:{pt:8},children:l.map((e=>o.jsxs(y.Fragment,{children:[o.jsxs(Y,{component:w,to:e.path.replace(":lang",a.pathname.split("/")[1]),active:d(e.path)?1:0,onClick:()=>e.submenu&&c(e.text),button:!0,children:[o.jsx(z,{sx:{color:d(e.path)?"#fff":"#ccc"},children:e.icon}),o.jsx(g,{primary:e.text}),e.submenu&&(s===e.text?o.jsx(S,{}):o.jsx(A,{}))]}),e.submenu&&o.jsx(P,{in:s===e.text,timeout:"auto",unmountOnExit:!0,children:o.jsx(v,{component:"div",disablePadding:!0,children:e.submenu.map((e=>o.jsxs(Z,{component:w,to:e.path.replace(":lang",a.pathname.split("/")[1]),active:d(e.path)?1:0,children:[o.jsx(z,{sx:{color:d(e.path)?"#fff":"#bbb"},children:e.icon}),o.jsx(g,{primary:e.text})]},e.text)))})})]},e.text)))})})]})};function te({children:e}){const[n,a]=t.useState(!1);return o.jsxs("div",{style:{display:"flex",minHeight:"100vh",overflowX:"hidden"},children:[o.jsx(K,{onMenuClick:()=>{a(!n)}}),o.jsx(ee,{open:n,onClose:()=>{a(!1)}}),o.jsx("main",{style:{flexGrow:1,padding:"0px",marginTop:64},children:e})]})}export{te as default};
