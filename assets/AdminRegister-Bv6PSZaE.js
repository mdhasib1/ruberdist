import{r as n,a as F,u as I,j as e,d as S}from"./index-B_XR-bXS.js";import{B as O}from"./Box-CfZ4J_TA.js";import{h as z}from"./proxy-ghLGn7f2.js";import{T as C}from"./Typography-CuI5uYqX.js";import{A as j}from"./Alert-Cfa11-q5.js";import{G as m}from"./Grid-EGPPBo8K.js";import{T as c}from"./TextField-8lldrJnn.js";import{B as w}from"./Button-gI_ekC-0.js";import{C as N}from"./CircularProgress-CnUP9nIX.js";import"./createSimplePaletteValueFilter-BqFbd0Em.js";import"./useTheme-CokdzniT.js";import"./index-xHaaV7qh.js";import"./useSlot-CiWiNTR6.js";import"./createSvgIcon-c53c8Spr.js";import"./Close-DVHmFJ28.js";import"./IconButton-CRfIEONe.js";import"./Paper-Dn5NJgTn.js";import"./useTheme-B7QzK74H.js";import"./Select-CzenUNWX.js";import"./Menu-B2ZH_G3y.js";import"./Portal-DeAW2irb.js";import"./Grow-Diug3Yir.js";import"./List-DlYRtUZN.js";import"./Modal-Cde_47yd.js";import"./useControlled-C95e4nO2.js";import"./isMuiElement-BsuoJcZr.js";const P="https://rubertogo.com",ce=()=>{const[i,v]=n.useState({firstName:"",lastName:"",email:"",phone:"",address:"",timeZone:""}),[o,u]=n.useState(["","","",""]),[b,D]=n.useState(1),[d,f]=n.useState(""),[h,y]=n.useState(""),[l,g]=n.useState(!1),x=n.useRef([]);F();const{lang:E}=I();n.useEffect(()=>{v(s=>({...s,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}))},[]);const p=s=>{const{name:r,value:t}=s.target;v({...i,[r]:t})},R=(s,r)=>{const{value:t}=s.target;if(t.length===1){const a=[...o];a[r]=t,u(a),r<o.length-1&&t&&x.current[r+1].focus()}else if(t===""){const a=[...o];a[r]="",u(a)}},T=(s,r)=>{if(r.key==="Backspace")if(o[s]){const t=[...o];t[s]="",u(t)}else s>0&&x.current[s-1].focus()},W=s=>{const r=s.clipboardData.getData("Text").slice(0,4);if(r.length===4){const t=r.split("");u(t),x.current[3].focus()}},A=async s=>{var r;s.preventDefault(),f(""),y(""),g(!0);try{const t=await S.post(`${P}/api/register`,i);y(t.data.message),D(2)}catch(t){f(((r=t.response)==null?void 0:r.data.message)||"Registration failed")}finally{g(!1)}},B=async s=>{var t;s.preventDefault(),f(""),g(!0);const r=o.join("");try{const a=await S.post(`${P}/api/verify-otp`,{email:i.email,otp:r});console.log(a.data),y("Registration and OTP verification successful!"),u(["","","",""])}catch(a){f(((t=a.response)==null?void 0:t.data.message)||"OTP verification failed")}finally{g(!1)}};return e.jsx("div",{className:"max-w-full flex min-h-screen items-center justify-center",children:e.jsx(O,{className:"h-[300px] items-center max-w-md m-auto",children:e.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[b===1&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Admin Registration"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),h&&e.jsx(j,{severity:"success",sx:{mb:2},children:h}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"First Name",name:"firstName",fullWidth:!0,variant:"outlined",value:i.firstName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(c,{label:"Last Name",name:"lastName",fullWidth:!0,variant:"outlined",value:i.lastName,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Email",name:"email",type:"email",fullWidth:!0,variant:"outlined",value:i.email,onChange:p,required:!0})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Phone",name:"phone",type:"tel",fullWidth:!0,variant:"outlined",value:i.phone,onChange:p})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(c,{label:"Address",name:"address",fullWidth:!0,variant:"outlined",value:i.address,onChange:p})})]}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(N,{size:24}),disabled:l,children:l?"Registering...":"Register"})]})]}),b===2&&e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:"Verify OTP"}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),h&&e.jsx(j,{severity:"success",sx:{mb:2},children:h}),e.jsxs("form",{onSubmit:B,children:[e.jsx(O,{display:"flex",justifyContent:"center",alignItems:"center",gap:2,mt:2,children:o.map((s,r)=>e.jsx(c,{variant:"outlined",inputProps:{maxLength:1,style:{textAlign:"center",fontSize:"1.5rem",width:"3rem",height:"3rem"}},value:s,onChange:t=>R(t,r),onKeyDown:t=>T(r,t),onPaste:r===0?W:void 0,required:!0,inputRef:t=>x.current[r]=t},r))}),e.jsx(w,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.5,fontSize:"1rem",fontWeight:"bold"},startIcon:l&&e.jsx(N,{size:24}),disabled:l,children:l?"Verifying...":"Verify OTP"})]})]})]})})})};export{ce as default};
