import{u as T,r as o,j as e,d as v}from"./index-DrMvIKwq.js";import{t as D,a2 as S,A as w,a3 as C}from"./index-y5yuKkc0.js";import{B as i}from"./Box-tqBBETVs.js";import{C as P}from"./CircularProgress-B5agUqRt.js";import{T as a}from"./Typography-BAti9wpa.js";import{C as B}from"./Card-locYS_tZ.js";import{C as A}from"./CardContent-CLprEiUl.js";import{D as E}from"./DataGrid-odPpneuv.js";import"./iconBase-BBLIWj70.js";import"./createSimplePaletteValueFilter-zjTMkHT-.js";import"./useTheme-CepysXf6.js";import"./index-pDPmJGlT.js";import"./Paper-C4BDKHkT.js";import"./useTheme-C3_UZ2QD.js";import"./index-COvJ5x3S.js";import"./Portal-BMjECl0g.js";import"./Select-DJdQC6kX.js";import"./Menu-ComLaOXz.js";import"./Grow-B1pBNw31.js";import"./useSlot-BWhg9WXJ.js";import"./List-BLDT_Zsz.js";import"./Modal-CfkloFEy.js";import"./useControlled-Bio4-BJG.js";import"./createSvgIcon-CgYohZ5P.js";import"./Close-CZtWXSiP.js";import"./Badge-Dv4pCkXf.js";import"./Tooltip-BJxLh1tU.js";import"./Chip-BGAMkzyn.js";import"./IconButton-BGQYt6kH.js";import"./ClickAwayListener-CKDzE_Pj.js";import"./MenuItem-8srXigvG.js";import"./listItemTextClasses--ZWm_3O6.js";import"./dividerClasses-CP17GPn_.js";import"./Toolbar-IXigYXsH.js";import"./ListItemText-CPFOLNaz.js";import"./TextField-DvirranI.js";import"./isMuiElement-LlRumiQy.js";import"./InputAdornment-qRqOoZAt.js";import"./Button-xUQB_oWD.js";import"./Divider-DKVgf2v9.js";import"./FormControlLabel-B2fud-Wt.js";import"./TableCell-Cv6TnrlD.js";import"./Skeleton-BNpbg8au.js";const F="https://rubertogo.com",Te=()=>{const{userId:p,lang:x}=T(),[n,u]=o.useState([]),[m,N]=o.useState(null),[j,c]=o.useState(!1),[h,d]=o.useState(null);if(o.useEffect(()=>{(async()=>{var s,f;c(!0);const r=localStorage.getItem("accessToken");if(!r){d("User is not authenticated. Please log in."),c(!1);return}try{const l=await v.get(`${F}/api/bookings/${p}`,{headers:{Authorization:`Bearer ${r}`}});u(l.data.bookings||[]),N(l.data.user||null),d(null)}catch(l){d(((f=(s=l.response)==null?void 0:s.data)==null?void 0:f.message)||"Failed to fetch booking history.")}finally{c(!1)}})()},[p]),j)return e.jsx(i,{className:"flex justify-center items-center h-screen",children:e.jsx(P,{})});if(h)return e.jsx(i,{className:"flex justify-center items-center h-screen",children:e.jsx(a,{color:"error",variant:"h6",children:h})});const y=[{field:"vanName",headerName:"Van Name",width:200},{field:"startDate",headerName:"Start Date",width:150},{field:"endDate",headerName:"End Date",width:150},{field:"startTime",headerName:"Start Time",width:150},{field:"endTime",headerName:"End Time",width:150},{field:"totalPrice",headerName:"Total Price (CHF)",width:150},{field:"status",headerName:"Status",width:150}],g=n.map(t=>{var r,s;return{id:t._id,vanName:((s=(r=t==null?void 0:t.vanId)==null?void 0:r.name)==null?void 0:s[x])||"Van Name",startDate:t.startDate,endDate:t.endDate,startTime:new Date(t.startTime).toLocaleTimeString(),endTime:new Date(t.endTime).toLocaleTimeString(),totalPrice:t.totalPrice,status:t.status.charAt(0).toUpperCase()+t.status.slice(1)}});return e.jsxs("div",{className:"container mx-auto p-6",children:[m&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(a,{variant:"h4",className:"text-center font-bold text-gray-700 mb-6",children:["Booking History ",m.firstName," ",m.lastName]}),e.jsx(a,{variant:"body2",sx:{fontSize:"1.2em",marginTop:"1rem"},children:m.email}),e.jsx(a,{variant:"body1",sx:{fontSize:"1.1em",marginTop:"0.3rem"},children:m.phone})]}),e.jsx(i,{sx:{display:{xs:"block",md:"none"}},children:n.length===0?e.jsx(a,{variant:"body1",className:"text-center text-gray-500",children:"No bookings found."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:n.map(t=>{var r,s;return e.jsx(B,{className:"shadow-lg border border-gray-200 rounded-lg",children:e.jsxs(A,{children:[e.jsxs(i,{className:"flex items-center gap-2 mb-2",children:[e.jsx(D,{className:"text-blue-500"}),e.jsx(a,{variant:"h6",className:"font-bold",children:((s=(r=t==null?void 0:t.vanId)==null?void 0:r.name)==null?void 0:s[x])||"Van Name"})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-1",children:[e.jsx(S,{className:"text-green-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:[t.startDate," to ",t.endDate]})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-1",children:[e.jsx(w,{className:"text-yellow-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:[new Date(t.startTime).toLocaleTimeString()," -"," ",new Date(t.endTime).toLocaleTimeString()]})]}),e.jsxs(i,{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"text-green-500"}),e.jsxs(a,{variant:"body2",className:"text-gray-600",children:["Total Price: $",t.totalPrice]})]}),e.jsxs(a,{variant:"caption",className:`font-bold ${t.status==="completed"?"text-green-600":t.status==="pending"?"text-yellow-600":"text-red-600"}`,children:["Status:"," ",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})]})},t._id)})})}),e.jsx(i,{sx:{display:{xs:"none",md:"block"},height:500,mt:4},children:e.jsx(E,{rows:g,columns:y,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0,sx:{"& .MuiDataGrid-columnHeaders":{bgcolor:"primary.main",color:"#000"},"& .MuiDataGrid-cell":{fontSize:"16px"}}})})]})};export{Te as default};
