import{a as R,r,u as W,j as t,g as f,a2 as b,bi as B,bj as M,a4 as x,aE as j,cH as V,cj as $,b as y,aW as v}from"./vendor-CRYhOL6r.js";import{u as F}from"./index-BpozoEX2.js";const S="https://rubertogo.com",z=()=>{const{lang:O}=R(),{login:P}=F(),[d,w]=r.useState(""),[o,p]=r.useState(["","","",""]),[m,N]=r.useState(1),[T,i]=r.useState(""),[C,h]=r.useState(!1),[l,c]=r.useState(!1),E=W(),u=r.useRef([]),A=a=>{w(a.target.value)},D=(a,e)=>{const{value:s}=a.target;if(s.length===1){const n=[...o];n[e]=s,p(n),e<o.length-1&&u.current[e+1].focus()}else if(s===""){const n=[...o];n[e]="",p(n),e>0&&u.current[e-1].focus()}},I=a=>{const e=a.clipboardData.getData("Text").slice(0,4);if(e.length===4){const s=e.split("");p(s),u.current[3].focus()}},L=async a=>{a.preventDefault(),i(""),c(!0);try{const e=await y.post(`${S}/api/login`,{email:d});console.log(e),v.success("OTP sent to your email."),N(2)}catch(e){console.log(e),i("User not found with the given email."),h(!0)}finally{c(!1)}},k=async a=>{a.preventDefault();const e=o.join("");i(""),c(!0);try{const s=await y.post(`${S}/api/verify-otp`,{email:d,otp:e}),{accessToken:n}=s.data;P(n),v.success("Login successful!"),E(`/${O}/partner/dashboard`)}catch{i("Invalid or expired OTP."),h(!0)}finally{c(!1)}},g=()=>{h(!1)};return t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#ff0707]",children:t.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-xl w-full",children:[t.jsx("div",{className:"flex justify-center mb-8",children:t.jsx("img",{src:"/rubertogo-logo.svg",alt:"Logo",className:"w-48"})}),t.jsx(f,{variant:"h4",align:"center",color:"primary",gutterBottom:!0,children:m===1?"Partner Sign In":"Verify OTP"}),m===1&&t.jsxs("form",{onSubmit:L,children:[t.jsx("div",{className:"mb-4",children:t.jsx(b,{fullWidth:!0,variant:"outlined",label:"Email",type:"email",value:d,onChange:A,InputProps:{startAdornment:t.jsx(B,{position:"start",children:t.jsx(M,{className:"text-gray-400"})})}})}),t.jsx(x,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Sending OTP...":"Send OTP"})]}),m===2&&t.jsxs("form",{onSubmit:k,children:[t.jsx(f,{align:"center",className:"mb-4",children:"Enter the 4-digit OTP sent to your email."}),t.jsx(j,{container:!0,spacing:1,justifyContent:"center",className:"mb-4",children:o.map((a,e)=>t.jsx(j,{item:!0,children:t.jsx(b,{variant:"outlined",inputProps:{maxLength:1,inputMode:"numeric",style:{textAlign:"center",fontSize:"1.5rem",width:"2rem",height:"2rem"}},value:a,onChange:s=>D(s,e),onPaste:e===0?I:void 0,inputRef:s=>u.current[e]=s,required:!0})},e))}),t.jsx(x,{fullWidth:!0,variant:"contained",color:"primary",className:"bg-blue-500 hover:bg-blue-600 text-white",type:"submit",disabled:l,children:l?"Verifying...":"Verify OTP"})]}),t.jsx(V,{open:C,autoHideDuration:6e3,onClose:g,children:t.jsx($,{onClose:g,severity:"error",children:T})})]})})};export{z as default};
