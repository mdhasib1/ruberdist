import{r,j as e,bX as E}from"./vendor-YnnEx5JS.js";import{u as P}from"./useVanStore-BjFIZNcu.js";const g="https://rubertogo.wedevguru.com",$=()=>{const{vans:p,loading:f,fetchVans:k}=P(),[o,j]=r.useState(""),[l,u]=r.useState({freeHours:10,minimumPaidHours:3,freePeriodStart:"21:00",blockedDateHours:[],bookingEnabled:!1}),[i,h]=r.useState(""),[d,b]=r.useState([]),[S,c]=r.useState(!1);r.useEffect(()=>{k()},[]),r.useEffect(()=>{o&&(async()=>{try{const a=await(await fetch(`${g}/api/booking-settings/${o}`)).json();u({freeHours:a.freeHours||10,minimumPaidHours:a.minimumPaidHours||3,freePeriodStart:a.freePeriodStart||"21:00",blockedDateHours:Array.isArray(a.blockedDateHours)?a.blockedDateHours:[],bookingEnabled:a.bookingEnabled||!1}),h(""),b([])}catch(t){console.error("Error fetching booking settings:",t)}})()},[o]);const v=s=>{j(s.target.value)},N=s=>{h(s);const t=l.blockedDateHours.find(a=>new Date(a.date).toISOString().split("T")[0]===s);b(t?t.hours:[])},H=async s=>{const t=d.includes(s)?d.filter(n=>n!==s):[...d,s];b(t);const a=l.blockedDateHours.filter(n=>new Date(n.date).toISOString().split("T")[0]!==i);t.length>0&&a.push({date:i,hours:t}),u(n=>({...n,blockedDateHours:a}));try{await fetch(`${g}/api/booking-settings/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({blockedDateHours:a})}),c(!0),setTimeout(()=>c(!1),3e3)}catch(n){console.error("Error updating blocked hours:",n)}},m=s=>{const{name:t,value:a,type:n,checked:w}=s.target;u(D=>({...D,[t]:n==="checkbox"?w:a})),c(!1)},y=async()=>{try{await fetch(`${g}/api/booking-settings/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(l)}),c(!0),setTimeout(()=>c(!1),3e3)}catch(s){console.error("Error saving settings:",s)}},x=Array.from({length:24},(s,t)=>`${t<10?"0":""}${t}:00`);return e.jsx("div",{className:"p-6 bg-gray-100 min-h-screen",children:e.jsxs("div",{className:"max-w-full mx-auto bg-white shadow-lg p-6 rounded-lg",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Admin Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Select Van"}),e.jsxs("select",{value:o,onChange:v,className:"border p-2 w-full rounded-md",children:[e.jsx("option",{value:"",children:"Select a van"}),f?e.jsx("option",{children:"Loading..."}):p.map(s=>e.jsx("option",{value:s._id,children:s.name.en},s._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Booking Enabled"}),e.jsx("input",{type:"checkbox",name:"bookingEnabled",checked:l.bookingEnabled,onChange:m,className:"mr-2"}),e.jsx("span",{children:l.bookingEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Free Period Start"}),e.jsx("select",{name:"freePeriodStart",value:l.freePeriodStart,onChange:m,className:"border p-2 w-full rounded-md",children:x.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Free Hours"}),e.jsx("input",{type:"number",name:"freeHours",value:l.freeHours||"",onChange:m,className:"border p-2 w-full rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Minimum Paid Hours"}),e.jsx("input",{type:"number",name:"minimumPaidHours",value:l.minimumPaidHours||"",onChange:m,className:"border p-2 w-full rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Blocked Date"}),e.jsx("input",{type:"date",value:i,onChange:s=>N(s.target.value),className:"border p-2 w-full rounded-md",disabled:!o})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg mb-2",children:"Blocked Hours"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",value:s,checked:d.includes(s),onChange:()=>H(s),className:"mr-2",disabled:!i}),s]},s))})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:y,className:"bg-blue-600 text-white px-4 py-2 rounded-md shadow-md hover:bg-blue-700 transition duration-300",children:"Save Settings"})}),S&&e.jsxs("div",{className:"mt-4 text-green-600 flex items-center",children:[e.jsx(E,{className:"mr-2"}),"Settings saved successfully!"]})]})})};export{$ as default};
